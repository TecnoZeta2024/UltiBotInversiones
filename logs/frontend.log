2025-06-24 10:54:44,599 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 10:54:44,600 - ultibot_backend - INFO - [MainThread] - main.py:82 - Iniciando UltiBot Backend (lifespan)...
2025-06-24 10:54:44,600 - ultibot_backend - INFO - [MainThread] - main.py:87 - DependencyContainer adjuntado a app.state: True
2025-06-24 10:54:44,600 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-24 10:54:44,601 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///./ultibot_local.db
2025-06-24 10:54:44,637 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-24 10:54:45,027 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 10:54:45,029 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:30 - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 10:54:45,030 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:36 - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 10:54:45,031 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 10:54:45,043 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:144 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-24 10:54:45,044 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001EE1D597510>
2025-06-24 10:54:45,045 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-24 10:54:45,045 - ultibot_backend - INFO - [MainThread] - main.py:91 - Contenedor de dependencias inicializado en lifespan.
2025-06-24 10:54:45,045 - ultibot_backend - INFO - [MainThread] - main.py:97 - Aplicación iniciada correctamente (lifespan).
2025-06-24 10:54:45,049 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /api/v1/portfolio/snapshot/da377bb3-349a-45fc-b024-784f5880c352
2025-06-24 10:54:45,056 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:85 - No configuration found for da377bb3-349a-45fc-b024-784f5880c352. Using default values.
2025-06-24 10:54:45,056 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:87 - Paper trading portfolio initialized for da377bb3-349a-45fc-b024-784f5880c352 with capital: 10000.0
2025-06-24 10:54:45,057 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /api/v1/portfolio/snapshot/da377bb3-349a-45fc-b024-784f5880c352 - Status: 200
2025-06-24 10:54:45,058 - qasync._windows._EventWorker - DEBUG - Got events from poll: [(<_OverlappedFuture pending cb=[_ProactorReadPipeTransport._loop_reading()]>, <function IocpProactor.recv_into.<locals>.finish_recv at 0x00000205D7C17D80>, 126, 0, <_overlapped.Overlapped object at 0x00000205D72F7270>)]
2025-06-24 10:54:45,058 - qasync._QEventLoop - DEBUG - Invoking event callback <function IocpProactor.recv_into.<locals>.finish_recv at 0x00000205D7C17D80>
2025-06-24 10:54:45,059 - httpcore.http11 - DEBUG - receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Tue, 24 Jun 2025 14:54:45 GMT'), (b'server', b'uvicorn'), (b'content-length', b'375'), (b'content-type', b'application/json')])
2025-06-24 10:54:45,059 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8000/api/v1/portfolio/snapshot/da377bb3-349a-45fc-b024-784f5880c352?trading_mode=paper "HTTP/1.1 200 OK"
2025-06-24 10:54:45,059 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8000/api/v1/portfolio/snapshot/da377bb3-349a-45fc-b024-784f5880c352?trading_mode=paper "HTTP/1.1 200 OK"
2025-06-24 10:54:45,060 - httpcore.http11 - DEBUG - receive_response_body.started request=<Request [b'GET']>
2025-06-24 10:54:45,060 - httpcore.http11 - DEBUG - receive_response_body.complete
2025-06-24 10:54:45,060 - httpcore.http11 - DEBUG - response_closed.started
2025-06-24 10:54:45,060 - httpcore.http11 - DEBUG - response_closed.complete
2025-06-24 10:54:45,061 - ultibot_ui.services.api_client - INFO - HTTP Request: GET http://127.0.0.1:8000/api/v1/portfolio/snapshot/da377bb3-349a-45fc-b024-784f5880c352 "HTTP/HTTP/1.1 200 OK"
2025-06-24 10:54:45,061 - ultibot_ui.services.api_client - DEBUG - Response content (processed): {'paper_trading': {'available_balance_usdt': '10000.0', 'total_assets_value_usd': '0.0', 'total_portfolio_value_usd': '10000.0', 'assets': [], 'error_message': None}, 'real_trading': {'available_balance_usdt': '0.0', 'total_assets_value_usd': '0.0', 'total_portfolio_value_usd': '0.0', 'assets': [], 'error_message': 'Real trading data not requested'}, 'last_updated': '2025-06-24T14:54:45.056048'}
2025-06-24 10:54:45,061 - ultibot_ui.views.portfolio_view - INFO - PortfolioView: Portfolio snapshot data received.
2025-06-24 10:54:45,064 - httpcore.connection - DEBUG - close.started
2025-06-24 10:54:45,065 - httpcore.connection - DEBUG - close.complete
2025-06-24 10:54:45,065 - ultibot_ui.services.api_client - INFO - APIClient httpx client closed.
2025-06-24 10:54:46,023 - ultibot_ui.workers - DEBUG - ApiWorker initialized with api_client: <ultibot_ui.services.api_client.UltiBotAPIClient object at 0x00000205D74242D0>, coroutine_factory: set
2025-06-24 10:54:56,007 - ultibot_ui.widgets.portfolio_widget - INFO - Actualizando datos del portafolio para modo: paper
2025-06-24 10:54:56,007 - ultibot_ui.workers - DEBUG - ApiWorker initialized with api_client: <ultibot_ui.services.api_client.UltiBotAPIClient object at 0x00000205D74242D0>, coroutine_factory: set
2025-06-24 10:54:56,008 - ultibot_ui.workers - DEBUG - ApiWorker: run method started.
2025-06-24 10:54:56,009 - asyncio - DEBUG - Using selector: SelectSelector
2025-06-24 10:54:56,010 - ultibot_ui.workers - DEBUG - ApiWorker: Creating coroutine from factory.
2025-06-24 10:54:56,010 - ultibot_ui.workers - DEBUG - ApiWorker: Coroutine created: <coroutine object PortfolioWidget._start_update_worker.<locals>.fetch_data_coroutine at 0x00000205D7441A40>. Running in event loop.
2025-06-24 10:54:56,010 - ultibot_ui.widgets.portfolio_widget - DEBUG - PortfolioWidget: Iniciando fetch_data_coroutine para modo paper.
2025-06-24 10:54:56,011 - ultibot_ui.services.api_client - INFO - Obteniendo snapshot del portafolio para da377bb3-349a-45fc-b024-784f5880c352, modo: paper
2025-06-24 10:54:56,012 - ultibot_ui.services.api_client - INFO - Obteniendo trades, modo: paper, filtros: {'trading_mode': 'paper', 'limit': 100, 'offset': 0, 'status': 'open'}
2025-06-24 10:54:56,013 - ultibot_ui.workers - DEBUG - ApiWorker: Coroutine finished. Result: {'portfolio_snapshot': RuntimeError('HTTP client is not initialized or has been closed.'), 'open_trades': RuntimeError('HTTP client is not initialized or has been closed.'), 'trading_mode': 'paper'}
2025-06-24 10:54:56,014 - ultibot_ui.workers - DEBUG - ApiWorker: result_ready signal emitted.
2025-06-24 10:54:56,014 - ultibot_ui.workers - DEBUG - ApiWorker: Task finished, emitting 'finished' signal.
2025-06-24 10:54:56,014 - ultibot_ui.widgets.portfolio_widget - INFO - DATOS COMPLETOS RECIBIDOS EN HANDLER: {'portfolio_snapshot': RuntimeError('HTTP client is not initialized or has been closed.'), 'open_trades': RuntimeError('HTTP client is not initialized or has been closed.'), 'trading_mode': 'paper'}
2025-06-24 10:54:56,014 - ultibot_ui.workers - DEBUG - ApiWorker: run method finished.
2025-06-24 14:55:13,969 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:55:13,971 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:55:13,973 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:55:44,028 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:55:44,030 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:55:44,031 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:56:14,062 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:56:14,064 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:56:14,065 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:56:44,092 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:56:44,094 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:56:44,096 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:57:14,124 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:57:14,126 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:57:14,128 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:57:44,156 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:57:44,158 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:57:44,159 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:58:14,186 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:58:14,188 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:58:14,189 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:58:44,214 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:58:44,217 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:58:44,218 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:59:14,243 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:59:14,247 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:59:14,250 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 14:59:44,275 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 14:59:44,277 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 14:59:44,278 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:00:14,303 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:00:14,305 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:00:14,306 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:00:44,328 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:00:44,329 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:00:44,330 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:01:14,353 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:01:14,355 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:01:14,356 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:01:44,382 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:01:44,384 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:01:44,385 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:02:14,412 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:02:14,413 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:02:14,414 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:02:44,437 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:02:44,439 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:02:44,440 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:03:14,463 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:03:14,464 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:03:14,466 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:03:44,490 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:03:44,491 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:03:44,493 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:04:14,508 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:04:14,510 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:04:14,512 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 11:04:43,020 - ultibot_backend - INFO - [MainThread] - main.py:100 - Apagando UltiBot Backend (lifespan)...
2025-06-24 11:04:43,021 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:200 - Shutting down dependency container...
2025-06-24 11:04:43,021 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:205 - Dependency container shut down.
2025-06-24 11:04:43,021 - ultibot_backend - INFO - [MainThread] - main.py:103 - Recursos liberados y aplicación apagada (lifespan).
2025-06-24 15:04:44,537 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:04:44,540 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:04:44,541 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 11:04:47,204 - ultibot_backend - INFO - [MainThread] - main.py:111 - Creando nueva instancia de FastAPI...
2025-06-24 11:04:47,204 - ultibot_backend - INFO - [MainThread] - main.py:154 - Registrando routers de la API...
2025-06-24 11:04:47,227 - ultibot_backend - INFO - [MainThread] - main.py:165 - Todos los routers han sido registrados.
2025-06-24 11:04:47,227 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 11:04:47,228 - ultibot_backend - INFO - [MainThread] - main.py:82 - Iniciando UltiBot Backend (lifespan)...
2025-06-24 11:04:47,229 - ultibot_backend - INFO - [MainThread] - main.py:87 - DependencyContainer adjuntado a app.state: True
2025-06-24 11:04:47,229 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-24 11:04:47,230 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///./ultibot_local.db
2025-06-24 11:04:47,267 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-24 11:04:47,661 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 11:04:47,661 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:30 - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 11:04:47,669 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:36 - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 11:04:47,669 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 11:04:47,681 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:144 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-24 11:04:47,681 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001F0AB9EF690>
2025-06-24 11:04:47,681 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-24 11:04:47,681 - ultibot_backend - INFO - [MainThread] - main.py:91 - Contenedor de dependencias inicializado en lifespan.
2025-06-24 11:04:47,681 - ultibot_backend - INFO - [MainThread] - main.py:97 - Aplicación iniciada correctamente (lifespan).
2025-06-24 11:04:51,804 - ultibot_backend - INFO - [MainThread] - main.py:111 - Creando nueva instancia de FastAPI...
2025-06-24 11:04:51,804 - ultibot_backend - INFO - [MainThread] - main.py:154 - Registrando routers de la API...
2025-06-24 11:04:51,827 - ultibot_backend - INFO - [MainThread] - main.py:165 - Todos los routers han sido registrados.
2025-06-24 11:04:51,828 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 11:04:51,829 - ultibot_backend - INFO - [MainThread] - main.py:82 - Iniciando UltiBot Backend (lifespan)...
2025-06-24 11:04:51,829 - ultibot_backend - INFO - [MainThread] - main.py:87 - DependencyContainer adjuntado a app.state: True
2025-06-24 11:04:51,830 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-24 11:04:51,830 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///./ultibot_local.db
2025-06-24 11:04:51,869 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-24 11:04:52,262 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 11:04:52,262 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:30 - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 11:04:52,262 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:36 - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 11:04:52,268 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 11:04:52,284 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:144 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-24 11:04:52,284 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000217B4A6EE10>
2025-06-24 11:04:52,285 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-24 11:04:52,287 - ultibot_backend - INFO - [MainThread] - main.py:91 - Contenedor de dependencias inicializado en lifespan.
2025-06-24 11:04:52,288 - ultibot_backend - INFO - [MainThread] - main.py:97 - Aplicación iniciada correctamente (lifespan).
2025-06-24 15:05:14,565 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:05:14,567 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:05:14,568 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:05:44,590 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:05:44,592 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:05:44,594 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:06:14,620 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:06:14,621 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:06:14,623 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:06:44,653 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:06:44,656 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:06:44,659 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:07:14,685 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:07:14,687 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:07:14,689 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:07:44,712 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:07:44,713 - ultibot_backend - DEBUG - [AnyIO worker thread] - main.py:170 - Health check solicitado.
2025-06-24 15:07:44,715 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 200
2025-06-24 15:07:59,804 - ultibot_backend - INFO - [MainThread] - main.py:100 - Apagando UltiBot Backend (lifespan)...
2025-06-24 15:07:59,807 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:200 - Shutting down dependency container...
2025-06-24 15:07:59,810 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:205 - Dependency container shut down.
2025-06-24 15:07:59,812 - ultibot_backend - INFO - [MainThread] - main.py:103 - Recursos liberados y aplicación apagada (lifespan).
2025-06-24 15:08:04,905 - ultibot_backend - INFO - [MainThread] - main.py:111 - Creando nueva instancia de FastAPI...
2025-06-24 15:08:04,908 - ultibot_backend - INFO - [MainThread] - main.py:154 - Registrando routers de la API...
2025-06-24 15:08:04,934 - ultibot_backend - INFO - [MainThread] - main.py:165 - Todos los routers han sido registrados.
2025-06-24 15:08:04,935 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 15:08:04,941 - ultibot_backend - INFO - [MainThread] - main.py:82 - Iniciando UltiBot Backend (lifespan)...
2025-06-24 15:08:04,945 - ultibot_backend - INFO - [MainThread] - main.py:87 - DependencyContainer adjuntado a app.state: True
2025-06-24 15:08:04,947 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-24 15:08:05,187 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-24 15:08:05,200 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:05,202 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:30 - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:05,204 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:36 - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:05,205 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:05,234 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:144 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-24 15:08:05,235 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x7fbc29971310>
2025-06-24 15:08:05,237 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-24 15:08:05,239 - ultibot_backend - INFO - [MainThread] - main.py:91 - Contenedor de dependencias inicializado en lifespan.
2025-06-24 15:08:05,240 - ultibot_backend - INFO - [MainThread] - main.py:97 - Aplicación iniciada correctamente (lifespan).
2025-06-24 15:08:05,831 - ultibot_backend - INFO - [MainThread] - main.py:111 - Creando nueva instancia de FastAPI...
2025-06-24 15:08:05,832 - ultibot_backend - INFO - [MainThread] - main.py:154 - Registrando routers de la API...
2025-06-24 15:08:05,859 - ultibot_backend - INFO - [MainThread] - main.py:165 - Todos los routers han sido registrados.
2025-06-24 15:08:05,861 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 15:08:06,179 - ultibot_backend - INFO - [MainThread] - main.py:111 - Creando nueva instancia de FastAPI...
2025-06-24 15:08:06,181 - ultibot_backend - INFO - [MainThread] - main.py:154 - Registrando routers de la API...
2025-06-24 15:08:06,207 - ultibot_backend - INFO - [MainThread] - main.py:165 - Todos los routers han sido registrados.
2025-06-24 15:08:06,210 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 15:08:06,641 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:08:06,643 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:08:06,644 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:08:06,645 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 15:08:08,778 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:08,779 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:08,781 - tests.conftest - INFO - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:////tmp/tmpmtrq5zar/test_db.sqlite
2025-06-24 15:08:08,801 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa6043d80>
2025-06-24 15:08:08,804 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa6043d80> completed
2025-06-24 15:08:08,806 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622bb50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:08,806 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622bb50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:08,807 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622bb50>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:08,808 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622bb50>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:08,809 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,809 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,810 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acb40>, 'PRAGMA read_uncommitted', [])
2025-06-24 15:08:08,811 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acb40>, 'PRAGMA read_uncommitted', []) completed
2025-06-24 15:08:08,812 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acb40>)
2025-06-24 15:08:08,813 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acb40>) completed
2025-06-24 15:08:08,814 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acb40>)
2025-06-24 15:08:08,814 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acb40>) completed
2025-06-24 15:08:08,815 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,816 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,817 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,817 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,818 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa602d2c0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-24 15:08:08,820 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa602d2c0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-24 15:08:08,821 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa602d2c0>)
2025-06-24 15:08:08,822 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa602d2c0>) completed
2025-06-24 15:08:08,823 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa602d2c0>)
2025-06-24 15:08:08,824 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa602d2c0>) completed
2025-06-24 15:08:08,825 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,825 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,826 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa602cec0>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-24 15:08:08,827 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa602cec0>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-24 15:08:08,827 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa602cec0>)
2025-06-24 15:08:08,828 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa602cec0>) completed
2025-06-24 15:08:08,829 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa602cec0>)
2025-06-24 15:08:08,829 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa602cec0>) completed
2025-06-24 15:08:08,830 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,831 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,831 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa602cc40>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-24 15:08:08,832 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa602cc40>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-24 15:08:08,832 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa602cc40>)
2025-06-24 15:08:08,833 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa602cc40>) completed
2025-06-24 15:08:08,834 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa602cc40>)
2025-06-24 15:08:08,835 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa602cc40>) completed
2025-06-24 15:08:08,836 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,837 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,837 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acdc0>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-24 15:08:08,838 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acdc0>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-24 15:08:08,839 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acdc0>)
2025-06-24 15:08:08,840 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acdc0>) completed
2025-06-24 15:08:08,841 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acdc0>)
2025-06-24 15:08:08,842 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acdc0>) completed
2025-06-24 15:08:08,843 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,843 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,844 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ad3c0>, 'PRAGMA main.table_info("trades")', ())
2025-06-24 15:08:08,845 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ad3c0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-24 15:08:08,845 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ad3c0>)
2025-06-24 15:08:08,846 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ad3c0>) completed
2025-06-24 15:08:08,846 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ad3c0>)
2025-06-24 15:08:08,847 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ad3c0>) completed
2025-06-24 15:08:08,848 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,848 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,849 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ad640>, 'PRAGMA temp.table_info("trades")', ())
2025-06-24 15:08:08,849 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ad640>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-24 15:08:08,850 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ad640>)
2025-06-24 15:08:08,851 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ad640>) completed
2025-06-24 15:08:08,852 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ad640>)
2025-06-24 15:08:08,853 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ad640>) completed
2025-06-24 15:08:08,853 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,854 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,855 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acfc0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-24 15:08:08,856 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acfc0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-24 15:08:08,856 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acfc0>)
2025-06-24 15:08:08,857 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acfc0>) completed
2025-06-24 15:08:08,858 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acfc0>)
2025-06-24 15:08:08,858 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acfc0>) completed
2025-06-24 15:08:08,859 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,859 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,860 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acf40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-24 15:08:08,861 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acf40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-24 15:08:08,862 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acf40>)
2025-06-24 15:08:08,862 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acf40>) completed
2025-06-24 15:08:08,863 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acf40>)
2025-06-24 15:08:08,863 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acf40>) completed
2025-06-24 15:08:08,864 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,865 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,865 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60accc0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-24 15:08:08,866 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60accc0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-24 15:08:08,867 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60accc0>)
2025-06-24 15:08:08,868 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60accc0>) completed
2025-06-24 15:08:08,869 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60accc0>)
2025-06-24 15:08:08,870 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60accc0>) completed
2025-06-24 15:08:08,871 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,871 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,872 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acac0>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-24 15:08:08,873 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acac0>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-24 15:08:08,873 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acac0>)
2025-06-24 15:08:08,874 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60acac0>) completed
2025-06-24 15:08:08,874 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acac0>)
2025-06-24 15:08:08,875 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acac0>) completed
2025-06-24 15:08:08,876 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,876 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,877 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac840>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-24 15:08:08,878 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac840>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-24 15:08:08,878 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac840>)
2025-06-24 15:08:08,879 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac840>) completed
2025-06-24 15:08:08,879 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac840>)
2025-06-24 15:08:08,880 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac840>) completed
2025-06-24 15:08:08,881 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,881 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,882 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac740>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-24 15:08:08,883 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac740>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-24 15:08:08,884 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac740>)
2025-06-24 15:08:08,884 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac740>) completed
2025-06-24 15:08:08,885 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac740>)
2025-06-24 15:08:08,886 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac740>) completed
2025-06-24 15:08:08,887 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,887 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,888 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac1c0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-24 15:08:08,889 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac1c0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-24 15:08:08,890 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac1c0>)
2025-06-24 15:08:08,890 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac1c0>) completed
2025-06-24 15:08:08,891 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac1c0>)
2025-06-24 15:08:08,891 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac1c0>) completed
2025-06-24 15:08:08,892 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,893 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,893 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac140>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-24 15:08:08,894 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac140>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-24 15:08:08,895 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac140>)
2025-06-24 15:08:08,895 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60ac140>) completed
2025-06-24 15:08:08,896 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac140>)
2025-06-24 15:08:08,896 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac140>) completed
2025-06-24 15:08:08,898 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,898 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,899 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60adc40>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-24 15:08:08,906 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60adc40>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-24 15:08:08,907 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60adc40>)
2025-06-24 15:08:08,908 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60adc40>) completed
2025-06-24 15:08:08,909 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,910 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,911 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60adbc0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-24 15:08:08,915 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60adbc0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-24 15:08:08,915 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60adbc0>)
2025-06-24 15:08:08,916 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60adbc0>) completed
2025-06-24 15:08:08,917 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,918 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,919 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac0c0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-24 15:08:08,923 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac0c0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-24 15:08:08,924 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac0c0>)
2025-06-24 15:08:08,925 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac0c0>) completed
2025-06-24 15:08:08,926 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,926 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,927 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60afe40>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-24 15:08:08,931 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60afe40>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-24 15:08:08,932 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60afe40>)
2025-06-24 15:08:08,932 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60afe40>) completed
2025-06-24 15:08:08,933 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,934 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,935 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60af140>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-24 15:08:08,940 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60af140>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-24 15:08:08,941 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60af140>)
2025-06-24 15:08:08,942 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60af140>) completed
2025-06-24 15:08:08,943 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,943 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,944 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac640>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-24 15:08:08,948 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60ac640>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-24 15:08:08,948 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac640>)
2025-06-24 15:08:08,949 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60ac640>) completed
2025-06-24 15:08:08,950 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,951 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,952 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acec0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-24 15:08:08,956 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60acec0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-24 15:08:08,957 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acec0>)
2025-06-24 15:08:08,958 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60acec0>) completed
2025-06-24 15:08:08,959 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,959 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,960 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60adb40>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-24 15:08:08,964 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60adb40>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-24 15:08:08,965 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60adb40>)
2025-06-24 15:08:08,965 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60adb40>) completed
2025-06-24 15:08:08,966 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,967 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,968 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60add40>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-24 15:08:08,969 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa60add40>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-24 15:08:08,970 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60add40>)
2025-06-24 15:08:08,970 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa60add40>) completed
2025-06-24 15:08:08,971 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60add40>)
2025-06-24 15:08:08,972 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa60add40>) completed
2025-06-24 15:08:08,972 - tests.conftest - INFO - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-24 15:08:08,973 - aiosqlite - DEBUG - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,974 - aiosqlite - DEBUG - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,975 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,975 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,976 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa622bb50>)
2025-06-24 15:08:08,977 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa622bb50>) completed
2025-06-24 15:08:08,978 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:08,979 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60a9c60>
2025-06-24 15:08:08,980 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60a9c60> completed
2025-06-24 15:08:08,980 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa60758a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:08,981 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa60758a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:08,982 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa60758a0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:08,982 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa60758a0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:08,983 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:08,984 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:09,122 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:09,171 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /test-config
2025-06-24 15:08:09,173 - ultibot_backend - INFO - Middleware: Solicitud procesada: GET /test-config - Status: 200
2025-06-24 15:08:09,175 - httpx - INFO - HTTP Request: GET http://test/test-config "HTTP/1.1 200 OK"
2025-06-24 15:08:09,175 - httpx - INFO - HTTP Request: GET http://test/test-config "HTTP/1.1 200 OK"
2025-06-24 15:08:09,178 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /test-config
2025-06-24 15:08:09,179 - ultibot_backend - INFO - Middleware: Solicitud procesada: GET /test-config - Status: 200
2025-06-24 15:08:09,180 - httpx - INFO - HTTP Request: GET http://test/test-config "HTTP/1.1 200 OK"
2025-06-24 15:08:09,180 - httpx - INFO - HTTP Request: GET http://test/test-config "HTTP/1.1 200 OK"
2025-06-24 15:08:09,183 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa60758a0>)
2025-06-24 15:08:09,184 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa60758a0>) completed
2025-06-24 15:08:09,185 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa60758a0>)
2025-06-24 15:08:09,186 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa60758a0>) completed
2025-06-24 15:08:09,186 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa60758a0>)
2025-06-24 15:08:09,187 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa60758a0>) completed
2025-06-24 15:08:09,190 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:09,191 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5c98ea0>
2025-06-24 15:08:09,192 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5c98ea0> completed
2025-06-24 15:08:09,192 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622b790>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:09,193 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622b790>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:09,193 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622b790>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:09,194 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa622b790>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:09,195 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:09,196 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:09,218 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:09,221 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-24 15:08:09,224 - ultibot_backend - INFO - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 200
2025-06-24 15:08:09,225 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies "HTTP/1.1 200 OK"
2025-06-24 15:08:09,225 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies "HTTP/1.1 200 OK"
2025-06-24 15:08:09,228 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622b790>)
2025-06-24 15:08:09,228 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622b790>) completed
2025-06-24 15:08:09,229 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622b790>)
2025-06-24 15:08:09,230 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa622b790>) completed
2025-06-24 15:08:09,230 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa622b790>)
2025-06-24 15:08:09,231 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa622b790>) completed
2025-06-24 15:08:09,232 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:09,234 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5c993a0>
2025-06-24 15:08:09,234 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5c993a0> completed
2025-06-24 15:08:09,236 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6074c70>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:09,237 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6074c70>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:09,239 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6074c70>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:09,240 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6074c70>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:09,241 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:09,242 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:09,272 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:09,276 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-24 15:08:09,278 - ultibot_backend - INFO - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 200
2025-06-24 15:08:09,279 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies?mode=paper "HTTP/1.1 200 OK"
2025-06-24 15:08:09,279 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies?mode=paper "HTTP/1.1 200 OK"
2025-06-24 15:08:09,282 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6074c70>)
2025-06-24 15:08:09,282 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6074c70>) completed
2025-06-24 15:08:09,283 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6074c70>)
2025-06-24 15:08:09,284 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6074c70>) completed
2025-06-24 15:08:09,285 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6074c70>)
2025-06-24 15:08:09,286 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6074c70>) completed
2025-06-24 15:08:09,288 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:09,290 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5c99300>
2025-06-24 15:08:09,291 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5c99300> completed
2025-06-24 15:08:09,292 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6075b70>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:09,292 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6075b70>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:09,293 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6075b70>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:09,294 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6075b70>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:09,295 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:09,296 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:09,321 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:09,324 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-24 15:08:09,327 - ultibot_backend - INFO - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 200
2025-06-24 15:08:09,328 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies?mode=real "HTTP/1.1 200 OK"
2025-06-24 15:08:09,328 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies?mode=real "HTTP/1.1 200 OK"
2025-06-24 15:08:09,331 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6075b70>)
2025-06-24 15:08:09,332 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6075b70>) completed
2025-06-24 15:08:09,333 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6075b70>)
2025-06-24 15:08:09,333 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6075b70>) completed
2025-06-24 15:08:09,334 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6075b70>)
2025-06-24 15:08:09,335 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6075b70>) completed
2025-06-24 15:08:09,337 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:09,339 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5b64b80>
2025-06-24 15:08:09,340 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5b64b80> completed
2025-06-24 15:08:09,340 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077c40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:09,341 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077c40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:09,342 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077c40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:09,343 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077c40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:09,344 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:09,345 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:09,366 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:09,370 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-24 15:08:09,373 - ultibot_backend - INFO - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 200
2025-06-24 15:08:09,374 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies "HTTP/1.1 200 OK"
2025-06-24 15:08:09,374 - httpx - INFO - HTTP Request: GET http://test/api/v1/performance/strategies "HTTP/1.1 200 OK"
2025-06-24 15:08:09,376 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077c40>)
2025-06-24 15:08:09,377 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077c40>) completed
2025-06-24 15:08:09,378 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077c40>)
2025-06-24 15:08:09,378 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077c40>) completed
2025-06-24 15:08:09,379 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6077c40>)
2025-06-24 15:08:09,379 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6077c40>) completed
2025-06-24 15:08:09,381 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:09,382 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5b65800>
2025-06-24 15:08:09,383 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5b65800> completed
2025-06-24 15:08:09,384 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077a60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:09,385 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077a60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:09,386 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077a60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:09,387 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa6077a60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:09,388 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:09,389 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:09,411 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:09,413 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-24 15:08:09,414 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:09,415 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:09,416 - ultibot_backend.dependencies - INFO - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:////tmp/tmpmtrq5zar/test_db.sqlite
2025-06-24 15:08:09,417 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5eb2fc0>
2025-06-24 15:08:09,419 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5eb2fc0> completed
2025-06-24 15:08:09,420 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d05030>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa5eb28e0>, deterministic=True)
2025-06-24 15:08:09,422 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d05030>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa5eb28e0>, deterministic=True) completed
2025-06-24 15:08:09,423 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d05030>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:09,423 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d05030>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:09,424 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,425 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,426 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5ecc8c0>, 'PRAGMA read_uncommitted', [])
2025-06-24 15:08:09,427 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5ecc8c0>, 'PRAGMA read_uncommitted', []) completed
2025-06-24 15:08:09,427 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5ecc8c0>)
2025-06-24 15:08:09,428 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5ecc8c0>) completed
2025-06-24 15:08:09,429 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5ecc8c0>)
2025-06-24 15:08:09,430 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5ecc8c0>) completed
2025-06-24 15:08:09,430 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,431 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,432 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,433 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,433 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccac0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-24 15:08:09,434 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccac0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-24 15:08:09,435 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccac0>)
2025-06-24 15:08:09,436 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccac0>) completed
2025-06-24 15:08:09,437 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccac0>)
2025-06-24 15:08:09,438 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccac0>) completed
2025-06-24 15:08:09,439 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,439 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,440 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5ecc9c0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-24 15:08:09,441 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5ecc9c0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-24 15:08:09,442 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5ecc9c0>)
2025-06-24 15:08:09,442 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5ecc9c0>) completed
2025-06-24 15:08:09,443 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5ecc9c0>)
2025-06-24 15:08:09,443 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5ecc9c0>) completed
2025-06-24 15:08:09,444 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,445 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,445 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccbc0>, 'PRAGMA main.table_info("trades")', ())
2025-06-24 15:08:09,446 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccbc0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-24 15:08:09,446 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccbc0>)
2025-06-24 15:08:09,447 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccbc0>) completed
2025-06-24 15:08:09,447 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccbc0>)
2025-06-24 15:08:09,448 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccbc0>) completed
2025-06-24 15:08:09,449 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,449 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,450 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5ecccc0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-24 15:08:09,450 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5ecccc0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-24 15:08:09,451 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5ecccc0>)
2025-06-24 15:08:09,452 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5ecccc0>) completed
2025-06-24 15:08:09,453 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5ecccc0>)
2025-06-24 15:08:09,454 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5ecccc0>) completed
2025-06-24 15:08:09,455 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,455 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,456 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccdc0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-24 15:08:09,457 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccdc0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-24 15:08:09,457 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccdc0>)
2025-06-24 15:08:09,458 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccdc0>) completed
2025-06-24 15:08:09,459 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccdc0>)
2025-06-24 15:08:09,459 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccdc0>) completed
2025-06-24 15:08:09,460 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,461 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,461 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccec0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-24 15:08:09,462 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccec0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-24 15:08:09,463 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccec0>)
2025-06-24 15:08:09,463 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccec0>) completed
2025-06-24 15:08:09,464 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccec0>)
2025-06-24 15:08:09,465 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccec0>) completed
2025-06-24 15:08:09,465 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,466 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,466 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccfc0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-24 15:08:09,467 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5eccfc0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-24 15:08:09,468 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccfc0>)
2025-06-24 15:08:09,469 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5eccfc0>) completed
2025-06-24 15:08:09,470 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccfc0>)
2025-06-24 15:08:09,471 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5eccfc0>) completed
2025-06-24 15:08:09,472 - aiosqlite - DEBUG - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,472 - aiosqlite - DEBUG - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,473 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d05030>)
2025-06-24 15:08:09,474 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d05030>) completed
2025-06-24 15:08:09,475 - ultibot_backend.dependencies - INFO - Database tables created and session factory initialized successfully
2025-06-24 15:08:09,482 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:09,483 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:09,484 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:09,485 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:09,833 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077a60>)
2025-06-24 15:08:09,834 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077a60>) completed
2025-06-24 15:08:09,836 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077a60>)
2025-06-24 15:08:09,837 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa6077a60>) completed
2025-06-24 15:08:09,838 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6077a60>)
2025-06-24 15:08:09,839 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa6077a60>) completed
2025-06-24 15:08:09,841 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:09,842 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5c999e0>
2025-06-24 15:08:09,843 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5c999e0> completed
2025-06-24 15:08:09,843 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d074c0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:09,844 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d074c0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:09,845 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d074c0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:09,845 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d074c0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:09,846 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:09,847 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:09,868 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:09,871 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-24 15:08:09,872 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:09,873 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:09,882 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:09,883 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:09,884 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:09,885 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:10,178 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d074c0>)
2025-06-24 15:08:10,179 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d074c0>) completed
2025-06-24 15:08:10,181 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d074c0>)
2025-06-24 15:08:10,182 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d074c0>) completed
2025-06-24 15:08:10,184 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5d074c0>)
2025-06-24 15:08:10,185 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5d074c0>) completed
2025-06-24 15:08:10,187 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:10,188 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5c9a340>
2025-06-24 15:08:10,189 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5c9a340> completed
2025-06-24 15:08:10,190 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d076a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:10,191 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d076a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:10,191 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d076a0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:10,192 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5d076a0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:10,193 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:10,194 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:10,215 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:10,218 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-24 15:08:10,219 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:10,220 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:10,228 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:10,229 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:10,229 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:10,230 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:10,387 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d076a0>)
2025-06-24 15:08:10,388 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d076a0>) completed
2025-06-24 15:08:10,389 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d076a0>)
2025-06-24 15:08:10,390 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5d076a0>) completed
2025-06-24 15:08:10,390 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5d076a0>)
2025-06-24 15:08:10,391 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5d076a0>) completed
2025-06-24 15:08:10,393 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:10,394 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5eb0220>
2025-06-24 15:08:10,395 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5eb0220> completed
2025-06-24 15:08:10,396 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:10,397 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:10,397 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:10,398 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:10,399 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:10,400 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:10,429 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:10,432 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-24 15:08:10,433 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:10,434 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:10,443 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:10,445 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:10,445 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:10,446 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:10,738 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:10,738 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:10,740 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:10,740 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:10,741 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:10,742 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:10,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:10,744 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60a9ee0>
2025-06-24 15:08:10,745 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60a9ee0> completed
2025-06-24 15:08:10,746 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:10,746 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:10,747 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:10,747 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:10,748 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:10,749 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:10,770 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:10,772 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-24 15:08:10,773 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:10,775 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:10,784 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:10,785 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:10,786 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:10,787 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:11,074 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:11,075 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:11,076 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:11,076 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:11,077 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:11,077 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:11,079 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,080 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5be0540>
2025-06-24 15:08:11,080 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5be0540> completed
2025-06-24 15:08:11,081 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:11,081 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:11,082 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:11,082 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:11,083 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:11,084 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:11,106 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:11,108 - ultibot_backend - INFO - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-24 15:08:11,110 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:11,110 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:11,117 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:11,118 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:11,120 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:11,120 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:11,404 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>)
2025-06-24 15:08:11,405 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>) completed
2025-06-24 15:08:11,406 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>)
2025-06-24 15:08:11,407 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>) completed
2025-06-24 15:08:11,407 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f2e0>)
2025-06-24 15:08:11,408 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f2e0>) completed
2025-06-24 15:08:11,409 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,411 - httpx - INFO - HTTP Request: GET http://test/test-serialization "HTTP/1.1 200 OK"
2025-06-24 15:08:11,411 - httpx - INFO - HTTP Request: GET http://test/test-serialization "HTTP/1.1 200 OK"
2025-06-24 15:08:11,413 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,426 - ultibot_backend.services.trading_engine_service - INFO - Executing trade directly from confirmed opportunity bb6354a4-6b21-403b-89ca-595705a19630
2025-06-24 15:08:11,428 - ultibot_backend.services.trading_engine_service - INFO - User configuration saved after initializing last_daily_reset for user abb1c029-eb1d-45d5-95ba-ca1f7c78121c.
2025-06-24 15:08:11,429 - ultibot_backend.services.trading_engine_service - DEBUG - Validación de Capital: Límite Diario USD: 5000.00, Arriesgado Actual USD: 0.0, Riesgo Potencial Trade USD: 200.000
2025-06-24 15:08:11,430 - ultibot_backend.services.trading_engine_service - WARNING - Using strategy 'test_strategy' as context for confirmed opportunity bb6354a4-6b21-403b-89ca-595705a19630
2025-06-24 15:08:11,431 - ultibot_backend.services.trading_engine_service - INFO - Created trade 33234d95-4d07-4732-83f9-e582f71da507 from decision 51ab28a7-9852-4e61-be3f-ee2b0a5722e9
2025-06-24 15:08:11,432 - ultibot_backend.services.trading_engine_service - INFO - Successfully executed trade 33234d95-4d07-4732-83f9-e582f71da507 from confirmed opportunity.
2025-06-24 15:08:11,433 - ultibot_backend.services.trading_engine_service - DEBUG - Trade side: buy, OCO side calculated: sell
2025-06-24 15:08:11,433 - ultibot_backend.services.trading_engine_service - INFO - Successfully created OCO order for trade 33234d95-4d07-4732-83f9-e582f71da507. OCO List ID: oco_list_123
2025-06-24 15:08:11,436 - ultibot_backend.services.trading_engine_service - DEBUG - Capital arriesgado actualizado para usuario abb1c029-eb1d-45d5-95ba-ca1f7c78121c: 200.0000000000000000000000000 (anterior: 0.0, valor trade: 200.0000000000000000000000000)
2025-06-24 15:08:11,437 - ultibot_backend.services.trading_engine_service - INFO - Updated daily_capital_risked_usd for user abb1c029-eb1d-45d5-95ba-ca1f7c78121c to 200.0000000000000000000000000.
2025-06-24 15:08:11,438 - ultibot_backend.services.trading_engine_service - INFO - Updated opportunity bb6354a4-6b21-403b-89ca-595705a19630 status to converted_to_trade_real: Trade 33234d95-4d07-4732-83f9-e582f71da507 executed based on user confirmation.
2025-06-24 15:08:11,439 - ultibot_backend.services.trading_engine_service - INFO - Persisted status update for opportunity bb6354a4-6b21-403b-89ca-595705a19630
2025-06-24 15:08:11,440 - test_real_trading_flow - DEBUG - OCO call args side: sell
2025-06-24 15:08:11,440 - test_real_trading_flow - DEBUG - OCO call args: call(user_id=UUID('abb1c029-eb1d-45d5-95ba-ca1f7c78121c'), symbol='BTCUSDT', side='sell', quantity=Decimal('0.003333333333333333333333333333'), price=Decimal('61800.000'), stop_price=Decimal('59100.0000'), limit_price=Decimal('61800.000'), trading_mode='real', api_key='key', api_secret='secret')
2025-06-24 15:08:11,442 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,450 - ultibot_backend.services.trading_engine_service - INFO - Executing trade directly from confirmed opportunity 7acc1cf0-3b28-4c0e-8cb9-6469dd05b5d2
2025-06-24 15:08:11,451 - ultibot_backend.services.trading_engine_service - DEBUG - Validación de Capital: Límite Diario USD: 5000.00, Arriesgado Actual USD: 4800.0, Riesgo Potencial Trade USD: 300.000
2025-06-24 15:08:11,452 - ultibot_backend.services.trading_engine_service - ERROR - Límite de riesgo de capital diario excedido. Límite: 5000.00, Arriesgado: 4800.0, Nuevo Trade: 300.000
2025-06-24 15:08:11,453 - ultibot_backend.services.trading_engine_service - INFO - Updated opportunity 7acc1cf0-3b28-4c0e-8cb9-6469dd05b5d2 status to error_in_processing: Límite de riesgo de capital diario excedido. Límite: 5000.00, Arriesgado: 4800.0, Nuevo Trade: 300.000
2025-06-24 15:08:11,454 - ultibot_backend.services.trading_engine_service - INFO - Persisted status update for opportunity 7acc1cf0-3b28-4c0e-8cb9-6469dd05b5d2
2025-06-24 15:08:11,457 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,459 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,471 - ultibot_backend.services.trading_engine_service - INFO - Executing trade directly from confirmed opportunity 22f3fc4c-81de-4d50-a07f-eddcad12d124
2025-06-24 15:08:11,472 - ultibot_backend.services.trading_engine_service - INFO - Daily capital reset triggered for user 3fbea32b-93f6-4680-aff9-c10045807b85. Resetting daily_capital_risked_usd.
2025-06-24 15:08:11,473 - ultibot_backend.services.trading_engine_service - INFO - User configuration saved after daily capital reset for user 3fbea32b-93f6-4680-aff9-c10045807b85.
2025-06-24 15:08:11,474 - ultibot_backend.services.trading_engine_service - DEBUG - Validación de Capital: Límite Diario USD: 2500.00, Arriesgado Actual USD: 0.0, Riesgo Potencial Trade USD: 100.000
2025-06-24 15:08:11,476 - ultibot_backend.services.trading_engine_service - WARNING - Using strategy 'test_strategy' as context for confirmed opportunity 22f3fc4c-81de-4d50-a07f-eddcad12d124
2025-06-24 15:08:11,477 - ultibot_backend.services.trading_engine_service - INFO - Created trade 84bc0d2f-ada1-465d-89ea-3e05b907e1a1 from decision c247391a-0dc3-427a-bca4-5c4698d4c81a
2025-06-24 15:08:11,477 - ultibot_backend.services.trading_engine_service - INFO - Successfully executed trade 84bc0d2f-ada1-465d-89ea-3e05b907e1a1 from confirmed opportunity.
2025-06-24 15:08:11,479 - ultibot_backend.services.trading_engine_service - DEBUG - Trade side: buy, OCO side calculated: sell
2025-06-24 15:08:11,480 - ultibot_backend.services.trading_engine_service - INFO - Successfully created OCO order for trade 84bc0d2f-ada1-465d-89ea-3e05b907e1a1. OCO List ID: oco_reset_test
2025-06-24 15:08:11,482 - ultibot_backend.services.trading_engine_service - DEBUG - Capital arriesgado actualizado para usuario 3fbea32b-93f6-4680-aff9-c10045807b85: 100.000 (anterior: 0.0, valor trade: 100.000)
2025-06-24 15:08:11,483 - ultibot_backend.services.trading_engine_service - INFO - Updated daily_capital_risked_usd for user 3fbea32b-93f6-4680-aff9-c10045807b85 to 100.000.
2025-06-24 15:08:11,485 - ultibot_backend.services.trading_engine_service - INFO - Updated opportunity 22f3fc4c-81de-4d50-a07f-eddcad12d124 status to converted_to_trade_real: Trade 84bc0d2f-ada1-465d-89ea-3e05b907e1a1 executed based on user confirmation.
2025-06-24 15:08:11,486 - ultibot_backend.services.trading_engine_service - INFO - Persisted status update for opportunity 22f3fc4c-81de-4d50-a07f-eddcad12d124
2025-06-24 15:08:11,489 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,490 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60f2020>
2025-06-24 15:08:11,491 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60f2020> completed
2025-06-24 15:08:11,493 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7df30>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:11,494 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7df30>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:11,495 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7df30>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:11,496 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7df30>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:11,499 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7df30>)
2025-06-24 15:08:11,499 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7df30>) completed
2025-06-24 15:08:11,500 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcaa40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"2f210272-df09-4948-8098-7d435a7cc8a4","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.497360Z","submittedAt":"2025-06-24T15:08:11.497360Z","fillTimestamp":"2025-06-24T15:08:11.497360Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.497360Z","opened_at":"2025-06-24T15:08:11.497360Z","updated_at":"2025-06-24T15:08:11.497360Z","closed_at":"2025-06-24T15:08:11.497360Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 497360, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 497360, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 497360, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:11,502 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcaa40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"2f210272-df09-4948-8098-7d435a7cc8a4","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.497360Z","submittedAt":"2025-06-24T15:08:11.497360Z","fillTimestamp":"2025-06-24T15:08:11.497360Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.497360Z","opened_at":"2025-06-24T15:08:11.497360Z","updated_at":"2025-06-24T15:08:11.497360Z","closed_at":"2025-06-24T15:08:11.497360Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 497360, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 497360, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 497360, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:11,503 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcaa40>)
2025-06-24 15:08:11,503 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcaa40>) completed
2025-06-24 15:08:11,504 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7df30>)
2025-06-24 15:08:11,505 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7df30>) completed
2025-06-24 15:08:11,506 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4f94340>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"f10d885e-20b9-4fb5-9be9-7a07e918bf02","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.498379Z","submittedAt":"2025-06-24T15:08:11.498379Z","fillTimestamp":"2025-06-24T15:08:11.498379Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.498379Z","opened_at":"2025-06-24T15:08:11.498379Z","updated_at":"2025-06-24T15:08:11.498379Z","closed_at":"2025-06-24T15:08:11.498379Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 498379, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498379, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498379, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:11,507 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4f94340>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"f10d885e-20b9-4fb5-9be9-7a07e918bf02","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.498379Z","submittedAt":"2025-06-24T15:08:11.498379Z","fillTimestamp":"2025-06-24T15:08:11.498379Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.498379Z","opened_at":"2025-06-24T15:08:11.498379Z","updated_at":"2025-06-24T15:08:11.498379Z","closed_at":"2025-06-24T15:08:11.498379Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 498379, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498379, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498379, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:11,508 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4f94340>)
2025-06-24 15:08:11,508 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4f94340>) completed
2025-06-24 15:08:11,509 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7df30>)
2025-06-24 15:08:11,510 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7df30>) completed
2025-06-24 15:08:11,511 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4f97040>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"ae6f871e-64ce-4f1a-81f4-d5ff09836a76","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.498462Z","submittedAt":"2025-06-24T15:08:11.498462Z","fillTimestamp":"2025-06-24T15:08:11.498462Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.498462Z","opened_at":"2025-06-24T15:08:11.498462Z","updated_at":"2025-06-24T15:08:11.498462Z","closed_at":"2025-06-24T15:08:11.498462Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 498462, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498462, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498462, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:11,512 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4f97040>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"ae6f871e-64ce-4f1a-81f4-d5ff09836a76","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.498462Z","submittedAt":"2025-06-24T15:08:11.498462Z","fillTimestamp":"2025-06-24T15:08:11.498462Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.498462Z","opened_at":"2025-06-24T15:08:11.498462Z","updated_at":"2025-06-24T15:08:11.498462Z","closed_at":"2025-06-24T15:08:11.498462Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 498462, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498462, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 498462, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:11,512 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4f97040>)
2025-06-24 15:08:11,513 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4f97040>) completed
2025-06-24 15:08:11,514 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:11,515 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:11,536 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:11,539 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-24 15:08:11,540 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:11,541 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:11,549 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:11,550 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:11,551 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:11,552 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:11,680 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:08:11,682 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:08:11,684 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:08:11,685 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 15:08:11,848 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7df30>)
2025-06-24 15:08:11,850 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7df30>) completed
2025-06-24 15:08:11,851 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7df30>)
2025-06-24 15:08:11,852 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7df30>) completed
2025-06-24 15:08:11,853 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7df30>)
2025-06-24 15:08:11,854 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7df30>) completed
2025-06-24 15:08:11,856 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:11,857 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60f2020>
2025-06-24 15:08:11,858 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60f2020> completed
2025-06-24 15:08:11,858 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f3d0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:11,859 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f3d0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:11,860 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f3d0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:11,860 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f3d0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:11,862 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f3d0>)
2025-06-24 15:08:11,862 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f3d0>) completed
2025-06-24 15:08:11,863 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcbe40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"30fa233a-fc59-48b4-bf2e-baeed7ec0f56","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.861543Z","submittedAt":"2025-06-24T15:08:11.861543Z","fillTimestamp":"2025-06-24T15:08:11.861543Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.861543Z","opened_at":"2025-06-24T15:08:11.861543Z","updated_at":"2025-06-24T15:08:11.861543Z","closed_at":"2025-06-24T15:08:11.861543Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 861543, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861543, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861543, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:11,864 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcbe40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"30fa233a-fc59-48b4-bf2e-baeed7ec0f56","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.861543Z","submittedAt":"2025-06-24T15:08:11.861543Z","fillTimestamp":"2025-06-24T15:08:11.861543Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.861543Z","opened_at":"2025-06-24T15:08:11.861543Z","updated_at":"2025-06-24T15:08:11.861543Z","closed_at":"2025-06-24T15:08:11.861543Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 861543, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861543, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861543, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:11,865 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcbe40>)
2025-06-24 15:08:11,865 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcbe40>) completed
2025-06-24 15:08:11,866 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f3d0>)
2025-06-24 15:08:11,867 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f3d0>) completed
2025-06-24 15:08:11,867 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcad40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"f52f6955-3bb7-4ac3-9b13-4e858d4e7302","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.861706Z","submittedAt":"2025-06-24T15:08:11.861706Z","fillTimestamp":"2025-06-24T15:08:11.861706Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.861706Z","opened_at":"2025-06-24T15:08:11.861706Z","updated_at":"2025-06-24T15:08:11.861706Z","closed_at":"2025-06-24T15:08:11.861706Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 861706, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861706, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861706, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:11,868 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcad40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"f52f6955-3bb7-4ac3-9b13-4e858d4e7302","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.861706Z","submittedAt":"2025-06-24T15:08:11.861706Z","fillTimestamp":"2025-06-24T15:08:11.861706Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.861706Z","opened_at":"2025-06-24T15:08:11.861706Z","updated_at":"2025-06-24T15:08:11.861706Z","closed_at":"2025-06-24T15:08:11.861706Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 861706, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861706, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861706, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:11,869 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcad40>)
2025-06-24 15:08:11,869 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcad40>) completed
2025-06-24 15:08:11,870 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f3d0>)
2025-06-24 15:08:11,871 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f3d0>) completed
2025-06-24 15:08:11,872 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcba40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"475b433a-f27e-4e2e-926a-02842cd92021","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.861739Z","submittedAt":"2025-06-24T15:08:11.861739Z","fillTimestamp":"2025-06-24T15:08:11.861739Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.861739Z","opened_at":"2025-06-24T15:08:11.861739Z","updated_at":"2025-06-24T15:08:11.861739Z","closed_at":"2025-06-24T15:08:11.861739Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 861739, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861739, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861739, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:11,872 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5bcba40>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"475b433a-f27e-4e2e-926a-02842cd92021","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:11.861739Z","submittedAt":"2025-06-24T15:08:11.861739Z","fillTimestamp":"2025-06-24T15:08:11.861739Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:11.861739Z","opened_at":"2025-06-24T15:08:11.861739Z","updated_at":"2025-06-24T15:08:11.861739Z","closed_at":"2025-06-24T15:08:11.861739Z"}', datetime.datetime(2025, 6, 24, 15, 8, 11, 861739, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861739, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 11, 861739, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:11,873 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcba40>)
2025-06-24 15:08:11,874 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5bcba40>) completed
2025-06-24 15:08:11,875 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:11,876 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:11,897 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:11,900 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-24 15:08:11,901 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:11,902 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:11,910 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:11,911 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:11,912 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:11,912 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:12,070 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f3d0>)
2025-06-24 15:08:12,072 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f3d0>) completed
2025-06-24 15:08:12,073 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f3d0>)
2025-06-24 15:08:12,074 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f3d0>) completed
2025-06-24 15:08:12,075 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f3d0>)
2025-06-24 15:08:12,076 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f3d0>) completed
2025-06-24 15:08:12,078 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,079 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60f2980>
2025-06-24 15:08:12,079 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60f2980> completed
2025-06-24 15:08:12,080 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a890>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:12,080 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a890>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:12,081 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a890>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:12,081 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a890>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:12,083 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a890>)
2025-06-24 15:08:12,083 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a890>) completed
2025-06-24 15:08:12,084 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cc0fc0>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"5a1fc6a8-5500-4188-97a7-25d011440938","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.082601Z","submittedAt":"2025-06-24T15:08:12.082601Z","fillTimestamp":"2025-06-24T15:08:12.082601Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.082601Z","opened_at":"2025-06-24T15:08:12.082601Z","updated_at":"2025-06-24T15:08:12.082601Z","closed_at":"2025-06-24T15:08:12.082601Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 82601, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82601, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82601, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:12,085 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cc0fc0>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"5a1fc6a8-5500-4188-97a7-25d011440938","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.082601Z","submittedAt":"2025-06-24T15:08:12.082601Z","fillTimestamp":"2025-06-24T15:08:12.082601Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.082601Z","opened_at":"2025-06-24T15:08:12.082601Z","updated_at":"2025-06-24T15:08:12.082601Z","closed_at":"2025-06-24T15:08:12.082601Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 82601, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82601, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82601, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:12,086 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cc0fc0>)
2025-06-24 15:08:12,087 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cc0fc0>) completed
2025-06-24 15:08:12,088 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a890>)
2025-06-24 15:08:12,088 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a890>) completed
2025-06-24 15:08:12,089 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cc27c0>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"0be25ef1-84dd-4921-87a5-0036e41c8d2d","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.082752Z","submittedAt":"2025-06-24T15:08:12.082752Z","fillTimestamp":"2025-06-24T15:08:12.082752Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.082752Z","opened_at":"2025-06-24T15:08:12.082752Z","updated_at":"2025-06-24T15:08:12.082752Z","closed_at":"2025-06-24T15:08:12.082752Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 82752, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82752, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82752, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:12,089 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cc27c0>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"0be25ef1-84dd-4921-87a5-0036e41c8d2d","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.082752Z","submittedAt":"2025-06-24T15:08:12.082752Z","fillTimestamp":"2025-06-24T15:08:12.082752Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.082752Z","opened_at":"2025-06-24T15:08:12.082752Z","updated_at":"2025-06-24T15:08:12.082752Z","closed_at":"2025-06-24T15:08:12.082752Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 82752, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82752, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82752, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:12,090 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cc27c0>)
2025-06-24 15:08:12,090 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cc27c0>) completed
2025-06-24 15:08:12,091 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a890>)
2025-06-24 15:08:12,092 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a890>) completed
2025-06-24 15:08:12,092 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cc2740>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"eb70ff98-a949-4fdf-bb2f-7464a157f732","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.082787Z","submittedAt":"2025-06-24T15:08:12.082787Z","fillTimestamp":"2025-06-24T15:08:12.082787Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.082787Z","opened_at":"2025-06-24T15:08:12.082787Z","updated_at":"2025-06-24T15:08:12.082787Z","closed_at":"2025-06-24T15:08:12.082787Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 82787, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82787, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82787, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:12,093 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cc2740>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"eb70ff98-a949-4fdf-bb2f-7464a157f732","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.082787Z","submittedAt":"2025-06-24T15:08:12.082787Z","fillTimestamp":"2025-06-24T15:08:12.082787Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.082787Z","opened_at":"2025-06-24T15:08:12.082787Z","updated_at":"2025-06-24T15:08:12.082787Z","closed_at":"2025-06-24T15:08:12.082787Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 82787, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82787, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 82787, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:12,093 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cc2740>)
2025-06-24 15:08:12,094 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cc2740>) completed
2025-06-24 15:08:12,095 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:12,096 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:12,118 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:12,121 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/portfolio/paper/performance_summary
2025-06-24 15:08:12,122 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:12,123 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:12,130 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:12,131 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:12,131 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:12,132 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:12,413 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a890>)
2025-06-24 15:08:12,414 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a890>) completed
2025-06-24 15:08:12,415 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a890>)
2025-06-24 15:08:12,416 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a890>) completed
2025-06-24 15:08:12,416 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa526a890>)
2025-06-24 15:08:12,417 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa526a890>) completed
2025-06-24 15:08:12,419 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,420 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5eb2520>
2025-06-24 15:08:12,421 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5eb2520> completed
2025-06-24 15:08:12,422 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:12,423 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:12,423 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:12,424 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:12,426 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:12,426 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:12,427 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf6940>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"ecf5ebdb-ac49-442a-a297-7ec72d011730","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.425413Z","submittedAt":"2025-06-24T15:08:12.425413Z","fillTimestamp":"2025-06-24T15:08:12.425413Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.425413Z","opened_at":"2025-06-24T15:08:12.425413Z","updated_at":"2025-06-24T15:08:12.425413Z","closed_at":"2025-06-24T15:08:12.425413Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 425413, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425413, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425413, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:12,427 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf6940>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', '{"id":"test-trade-1","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"BTCUSDT","side":"buy","entryOrder":{"orderId_internal":"ecf5ebdb-ac49-442a-a297-7ec72d011730","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.425413Z","submittedAt":"2025-06-24T15:08:12.425413Z","fillTimestamp":"2025-06-24T15:08:12.425413Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"150.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.425413Z","opened_at":"2025-06-24T15:08:12.425413Z","updated_at":"2025-06-24T15:08:12.425413Z","closed_at":"2025-06-24T15:08:12.425413Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 425413, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425413, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425413, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:12,428 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf6940>)
2025-06-24 15:08:12,429 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf6940>) completed
2025-06-24 15:08:12,429 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:12,430 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:12,430 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf6840>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"1f406605-4d9c-4404-ac30-4d77ff2fd9ba","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.425578Z","submittedAt":"2025-06-24T15:08:12.425578Z","fillTimestamp":"2025-06-24T15:08:12.425578Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.425578Z","opened_at":"2025-06-24T15:08:12.425578Z","updated_at":"2025-06-24T15:08:12.425578Z","closed_at":"2025-06-24T15:08:12.425578Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 425578, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425578, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425578, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:12,431 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf6840>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', '{"id":"test-trade-2","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ETHUSDT","side":"sell","entryOrder":{"orderId_internal":"1f406605-4d9c-4404-ac30-4d77ff2fd9ba","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.425578Z","submittedAt":"2025-06-24T15:08:12.425578Z","fillTimestamp":"2025-06-24T15:08:12.425578Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"-75.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.425578Z","opened_at":"2025-06-24T15:08:12.425578Z","updated_at":"2025-06-24T15:08:12.425578Z","closed_at":"2025-06-24T15:08:12.425578Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 425578, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425578, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425578, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:12,431 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf6840>)
2025-06-24 15:08:12,432 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf6840>) completed
2025-06-24 15:08:12,432 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:12,433 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:12,433 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf53c0>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"f7881981-78e0-4013-8471-075c8012b9ac","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.425615Z","submittedAt":"2025-06-24T15:08:12.425615Z","fillTimestamp":"2025-06-24T15:08:12.425615Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.425615Z","opened_at":"2025-06-24T15:08:12.425615Z","updated_at":"2025-06-24T15:08:12.425615Z","closed_at":"2025-06-24T15:08:12.425615Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 425615, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425615, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425615, tzinfo=datetime.timezone.utc)))
2025-06-24 15:08:12,434 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf53c0>, '\n                INSERT INTO trades (id, user_id, symbol, mode, position_status, data, created_at, updated_at, closed_at)\n                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)\n', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', '{"id":"test-trade-3","user_id":"00000000-0000-0000-0000-000000000001","mode":"paper","symbol":"ADAUSDT","side":"buy","entryOrder":{"orderId_internal":"f7881981-78e0-4013-8471-075c8012b9ac","orderId_exchange":null,"clientOrderId_exchange":null,"orderCategory":"entry","type":"market","status":"filled","requestedPrice":null,"requestedQuantity":"1.0","executedQuantity":"1.0","executedPrice":"50000.0","cumulativeQuoteQty":"50000.0","commissions":[],"commission":"0.0","commissionAsset":null,"timestamp":"2025-06-24T15:08:12.425615Z","submittedAt":"2025-06-24T15:08:12.425615Z","fillTimestamp":"2025-06-24T15:08:12.425615Z","rawResponse":{},"ocoOrderListId":null},"exitOrders":[],"positionStatus":"closed","strategyId":null,"opportunityId":null,"aiAnalysisConfidence":null,"pnl_usd":"25.0","pnl_percentage":"0.01","closingReason":null,"ocoOrderListId":null,"takeProfitPrice":null,"trailingStopActivationPrice":null,"trailingStopCallbackRate":null,"currentStopPrice_tsl":null,"riskRewardAdjustments":[],"created_at":"2025-06-24T15:08:12.425615Z","opened_at":"2025-06-24T15:08:12.425615Z","updated_at":"2025-06-24T15:08:12.425615Z","closed_at":"2025-06-24T15:08:12.425615Z"}', datetime.datetime(2025, 6, 24, 15, 8, 12, 425615, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425615, tzinfo=datetime.timezone.utc), datetime.datetime(2025, 6, 24, 15, 8, 12, 425615, tzinfo=datetime.timezone.utc))) completed
2025-06-24 15:08:12,435 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf53c0>)
2025-06-24 15:08:12,436 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf53c0>) completed
2025-06-24 15:08:12,437 - ultibot_backend - INFO - Creando nueva instancia de FastAPI...
2025-06-24 15:08:12,438 - ultibot_backend - INFO - Registrando routers de la API...
2025-06-24 15:08:12,460 - ultibot_backend - INFO - Todos los routers han sido registrados.
2025-06-24 15:08:12,462 - ultibot_backend - INFO - Middleware: Solicitud entrante: GET /api/v1/portfolio/paper/performance_summary
2025-06-24 15:08:12,463 - ultibot_backend.dependencies - WARNING - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-24 15:08:12,463 - ultibot_backend.dependencies - INFO - Initializing dependency container...
2025-06-24 15:08:12,471 - ultibot_backend.services.order_execution_service - INFO - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 15:08:12,472 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:12,473 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:12,473 - ultibot_backend.services.unified_order_execution_service - INFO - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 15:08:12,772 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:12,774 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:12,776 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:12,778 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:12,779 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:12,780 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:12,783 - ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://test-backend:8000
2025-06-24 15:08:12,784 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,785 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,788 - ultibot_ui.services.api_client - INFO - Obteniendo snapshot del portafolio para 093e2df8-55b8-4487-bc67-eabd41d24214, modo: paper
2025-06-24 15:08:12,790 - ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://test-backend:8000
2025-06-24 15:08:12,791 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,792 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,794 - ultibot_ui.services.api_client - INFO - Ejecutando orden de mercado en modo paper para el símbolo BTCUSDT.
2025-06-24 15:08:12,796 - ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://test-backend:8000
2025-06-24 15:08:12,797 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,798 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,799 - ultibot_ui.services.api_client - INFO - Ejecutando orden de mercado en modo real para el símbolo BTCUSDT.
2025-06-24 15:08:12,801 - ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://test-backend:8000
2025-06-24 15:08:12,801 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,802 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,804 - ultibot_ui.services.api_client - ERROR - Intento de orden real sin credenciales.
2025-06-24 15:08:12,805 - ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://test-backend:8000
2025-06-24 15:08:12,806 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,807 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,809 - ultibot_ui.services.api_client - INFO - Obteniendo trades abiertos para fbbe1adc-f64f-4bbd-bbdf-757a1eb441db en modo paper.
2025-06-24 15:08:12,810 - ultibot_ui.services.api_client - INFO - Obteniendo trades abiertos para fbbe1adc-f64f-4bbd-bbdf-757a1eb441db en modo real.
2025-06-24 15:08:12,811 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,814 - ultibot_ui.services.trading_mode_state - INFO - TradingModeStateManager initialized with mode: paper
2025-06-24 15:08:12,815 - ultibot_ui.services.trading_mode_state - INFO - Created global trading mode state manager
2025-06-24 15:08:12,816 - ultibot_ui.services.trading_mode_state - INFO - Trading mode changed from paper to real
2025-06-24 15:08:12,818 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,818 - ultibot_ui.services.trading_mode_state - INFO - TradingModeStateManager initialized with mode: paper
2025-06-24 15:08:12,819 - ultibot_ui.services.trading_mode_state - INFO - Created global trading mode state manager
2025-06-24 15:08:12,821 - ultibot_ui.services.trading_mode_state - INFO - Trading mode changed from paper to real
2025-06-24 15:08:12,821 - ultibot_ui.services.trading_mode_state - INFO - Trading mode changed from real to paper
2025-06-24 15:08:12,823 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,824 - ultibot_ui.services.trading_mode_state - INFO - TradingModeStateManager initialized with mode: paper
2025-06-24 15:08:12,825 - ultibot_ui.services.trading_mode_state - INFO - Created global trading mode state manager
2025-06-24 15:08:12,825 - ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://test-backend:8000
2025-06-24 15:08:12,826 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,828 - ultibot_ui.services.api_client - INFO - Obteniendo snapshot del portafolio para ddff89a8-83e3-486d-8a22-37a42460003a, modo: paper
2025-06-24 15:08:12,828 - ultibot_ui.services.api_client - INFO - Ejecutando orden de mercado en modo paper para el símbolo BTCUSDT.
2025-06-24 15:08:12,830 - ultibot_ui.services.trading_mode_state - INFO - Reset global trading mode state manager
2025-06-24 15:08:12,830 - ultibot_ui.services.trading_mode_state - INFO - TradingModeStateManager initialized with mode: paper
2025-06-24 15:08:12,831 - ultibot_ui.services.trading_mode_state - INFO - Created global trading mode state manager
2025-06-24 15:08:12,832 - ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://test-backend:8000
2025-06-24 15:08:12,833 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,834 - ultibot_ui.services.trading_mode_state - INFO - Trading mode changed from paper to real
2025-06-24 15:08:12,838 - ultibot_ui.services.api_client - INFO - Obteniendo snapshot del portafolio para 36534e32-3adc-46af-916a-2f38ada09d2a, modo: real
2025-06-24 15:08:12,839 - ultibot_ui.services.api_client - INFO - Ejecutando orden de mercado en modo real para el símbolo BTCUSDT.
2025-06-24 15:08:12,845 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,848 - ultibot_backend.services.trading_engine_service - INFO - Processing opportunity 08bd4428-9443-4066-bbd7-a672a88e20a1 for symbol BTCUSDT
2025-06-24 15:08:12,849 - ultibot_backend.services.config_service - INFO - Configuración de usuario cargada exitosamente para el user_id: a0907601-b33d-4b95-890d-a158aade0a13
2025-06-24 15:08:12,849 - ultibot_backend.services.trading_engine_service - INFO - Strategy 0f3fdc4c-2a1c-4511-8dea-ac5885a4a25f can operate autonomously. Proceeding with autonomous logic.
2025-06-24 15:08:12,857 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,861 - ultibot_backend.services.trading_engine_service - INFO - Processing opportunity a2549938-f6b0-4860-b6ae-fb1735175dc9 for symbol BTCUSDT
2025-06-24 15:08:12,863 - ultibot_backend.services.trading_engine_service - INFO - Strategy 190d928a-aec7-4d54-ac57-94f59d8e8548 can operate autonomously. Proceeding with autonomous logic.
2025-06-24 15:08:12,868 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,871 - ultibot_backend.services.trading_engine_service - INFO - Processing opportunity 6fc3dbd4-be21-4f20-b1d5-722359ed00d5 for symbol ETHUSDT
2025-06-24 15:08:12,872 - ultibot_backend.services.config_service - INFO - Configuración de usuario cargada exitosamente para el user_id: bd650c93-809b-47b5-bffe-f0751e5adf36
2025-06-24 15:08:12,875 - ultibot_backend.services.trading_engine_service - WARNING - No active and applicable strategies found for opportunity 6fc3dbd4-be21-4f20-b1d5-722359ed00d5 with symbol ETHUSDT.
2025-06-24 15:08:12,875 - ultibot_backend.services.trading_engine_service - INFO - Updated opportunity 6fc3dbd4-be21-4f20-b1d5-722359ed00d5 status to rejected_by_system: No active strategies are applicable to this opportunity's symbol.
2025-06-24 15:08:12,877 - ultibot_backend.services.trading_engine_service - INFO - Persisted status update for opportunity 6fc3dbd4-be21-4f20-b1d5-722359ed00d5
2025-06-24 15:08:12,882 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,887 - ultibot_backend.services.trading_engine_service - INFO - Processing opportunity 943618d0-5fad-478e-b266-79d79dd65acb for symbol BTCUSDT
2025-06-24 15:08:12,888 - ultibot_backend.services.config_service - INFO - Configuración de usuario cargada exitosamente para el user_id: 743bd3ae-249e-40b1-9ebd-830209638cf4
2025-06-24 15:08:12,889 - ultibot_backend.services.trading_engine_service - INFO - AI confidence 0.65 for strategy cd74cd7b-d6df-4b49-bab7-718abf23b6c2 is below threshold 0.8.
2025-06-24 15:08:12,892 - ultibot_backend.services.trading_engine_service - INFO - Strategy cd74cd7b-d6df-4b49-bab7-718abf23b6c2 did not produce a decision for opportunity 943618d0-5fad-478e-b266-79d79dd65acb.
2025-06-24 15:08:12,892 - ultibot_backend.services.trading_engine_service - INFO - No affirmative trading decisions made for opportunity 943618d0-5fad-478e-b266-79d79dd65acb.
2025-06-24 15:08:12,898 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,902 - ultibot_backend.services.trading_engine_service - INFO - Processing opportunity c54fa7e4-9540-4891-be57-959fc4faabad for symbol BTCUSDT
2025-06-24 15:08:12,903 - ultibot_backend.services.config_service - INFO - Configuración de usuario cargada exitosamente para el user_id: 765348ac-bb0b-44e1-893c-02a39268f12a
2025-06-24 15:08:12,909 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,912 - ultibot_backend.services.trading_engine_service - INFO - Processing opportunity da405928-4a34-4a86-bdcd-ad0c87b1eb76 for symbol BTCUSDT
2025-06-24 15:08:12,913 - ultibot_backend.services.config_service - INFO - Configuración de usuario cargada exitosamente para el user_id: 9addf234-ad81-4248-b451-e8bbf4dd6a9a
2025-06-24 15:08:12,918 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,923 - ultibot_backend.services.trading_engine_service - INFO - Created trade 3782ab12-3860-4a66-84cf-e965d44ff597 from decision 130d1f24-7967-4e15-9a52-e49d62311127
2025-06-24 15:08:12,929 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,930 - ultibot_backend.services.trading_engine_service - INFO - Created trade bae93269-d9d2-4ea1-9eb8-d677e375802f from decision 8278a4fe-f81f-4782-9708-6d4b0a163f8d
2025-06-24 15:08:12,931 - ultibot_backend.services.trading_engine_service - INFO - Created trade 3e93a48a-a221-4a2f-b216-ccac60880f0a from decision 8278a4fe-f81f-4782-9708-6d4b0a163f8d
2025-06-24 15:08:12,932 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:12,933 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5b640e0>
2025-06-24 15:08:12,934 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5b640e0> completed
2025-06-24 15:08:12,935 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7d300>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:12,936 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7d300>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:12,937 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7d300>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:12,938 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7d300>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:12,941 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:12,942 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:12,954 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7d300>)
2025-06-24 15:08:12,956 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7d300>) completed
2025-06-24 15:08:12,956 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4eee9c0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:12,957 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4eee9c0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:12,958 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4eee9c0>)
2025-06-24 15:08:12,959 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4eee9c0>) completed
2025-06-24 15:08:12,959 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4eee9c0>)
2025-06-24 15:08:12,960 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4eee9c0>) completed
2025-06-24 15:08:12,961 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:12,961 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,008 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,010 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,011 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7d300>)
2025-06-24 15:08:13,013 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7d300>) completed
2025-06-24 15:08:13,014 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7d300>)
2025-06-24 15:08:13,016 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7d300>) completed
2025-06-24 15:08:13,017 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7d300>)
2025-06-24 15:08:13,018 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7d300>) completed
2025-06-24 15:08:13,021 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,023 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5b667a0>
2025-06-24 15:08:13,024 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5b667a0> completed
2025-06-24 15:08:13,024 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa52688b0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,025 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa52688b0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,026 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa52688b0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,026 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa52688b0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,030 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,031 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,037 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa52688b0>)
2025-06-24 15:08:13,039 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa52688b0>) completed
2025-06-24 15:08:13,040 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4db6a40>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,041 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4db6a40>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,042 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4db6a40>)
2025-06-24 15:08:13,042 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4db6a40>) completed
2025-06-24 15:08:13,043 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4db6a40>)
2025-06-24 15:08:13,044 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4db6a40>) completed
2025-06-24 15:08:13,044 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,045 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,209 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,212 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,213 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa52688b0>)
2025-06-24 15:08:13,214 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa52688b0>) completed
2025-06-24 15:08:13,215 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa52688b0>)
2025-06-24 15:08:13,215 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa52688b0>) completed
2025-06-24 15:08:13,216 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa52688b0>)
2025-06-24 15:08:13,216 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa52688b0>) completed
2025-06-24 15:08:13,218 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,220 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60aaac0>
2025-06-24 15:08:13,221 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60aaac0> completed
2025-06-24 15:08:13,222 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,223 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,223 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,224 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f6a0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,227 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,228 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,235 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:13,235 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:13,237 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cd7ac0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,237 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cd7ac0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,238 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5cd7ac0>)
2025-06-24 15:08:13,239 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5cd7ac0>) completed
2025-06-24 15:08:13,240 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cd7ac0>)
2025-06-24 15:08:13,240 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cd7ac0>) completed
2025-06-24 15:08:13,241 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,242 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,279 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,281 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,282 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:13,283 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:13,284 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:13,287 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:13,288 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>)
2025-06-24 15:08:13,288 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f6a0>) completed
2025-06-24 15:08:13,290 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,291 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5f563e0>
2025-06-24 15:08:13,292 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5f563e0> completed
2025-06-24 15:08:13,292 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,293 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,293 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,294 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7f2e0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,297 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,298 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,304 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f2e0>)
2025-06-24 15:08:13,305 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7f2e0>) completed
2025-06-24 15:08:13,307 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4a02540>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,307 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4a02540>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,308 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4a02540>)
2025-06-24 15:08:13,308 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4a02540>) completed
2025-06-24 15:08:13,309 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4a02540>)
2025-06-24 15:08:13,309 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4a02540>) completed
2025-06-24 15:08:13,310 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,311 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,351 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,353 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,355 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>)
2025-06-24 15:08:13,356 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>) completed
2025-06-24 15:08:13,357 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>)
2025-06-24 15:08:13,358 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7f2e0>) completed
2025-06-24 15:08:13,359 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f2e0>)
2025-06-24 15:08:13,359 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7f2e0>) completed
2025-06-24 15:08:13,361 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,362 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5f54540>
2025-06-24 15:08:13,363 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5f54540> completed
2025-06-24 15:08:13,363 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a6b0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,364 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a6b0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,365 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a6b0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,365 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526a6b0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,368 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,369 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,375 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a6b0>)
2025-06-24 15:08:13,376 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526a6b0>) completed
2025-06-24 15:08:13,377 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf6bc0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,378 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf6bc0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,379 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5cf6bc0>)
2025-06-24 15:08:13,379 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5cf6bc0>) completed
2025-06-24 15:08:13,380 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf6bc0>)
2025-06-24 15:08:13,380 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf6bc0>) completed
2025-06-24 15:08:13,381 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,382 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,420 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,422 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,423 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a6b0>)
2025-06-24 15:08:13,424 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a6b0>) completed
2025-06-24 15:08:13,424 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a6b0>)
2025-06-24 15:08:13,425 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526a6b0>) completed
2025-06-24 15:08:13,426 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa526a6b0>)
2025-06-24 15:08:13,426 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa526a6b0>) completed
2025-06-24 15:08:13,428 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,429 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5eb0180>
2025-06-24 15:08:13,429 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5eb0180> completed
2025-06-24 15:08:13,430 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5269d50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,430 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5269d50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,432 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5269d50>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,433 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5269d50>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,437 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,438 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,444 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5269d50>)
2025-06-24 15:08:13,445 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5269d50>) completed
2025-06-24 15:08:13,446 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa50efe40>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,447 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa50efe40>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,447 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa50efe40>)
2025-06-24 15:08:13,448 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa50efe40>) completed
2025-06-24 15:08:13,448 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa50efe40>)
2025-06-24 15:08:13,449 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa50efe40>) completed
2025-06-24 15:08:13,450 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,450 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,602 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,605 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,606 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5269d50>)
2025-06-24 15:08:13,607 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5269d50>) completed
2025-06-24 15:08:13,608 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5269d50>)
2025-06-24 15:08:13,608 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5269d50>) completed
2025-06-24 15:08:13,609 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5269d50>)
2025-06-24 15:08:13,610 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5269d50>) completed
2025-06-24 15:08:13,612 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,614 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60aa020>
2025-06-24 15:08:13,615 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60aa020> completed
2025-06-24 15:08:13,617 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7fc40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,618 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7fc40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,619 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7fc40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,620 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7fc40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,624 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,624 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,631 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7fc40>)
2025-06-24 15:08:13,631 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7fc40>) completed
2025-06-24 15:08:13,632 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf7bc0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,633 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa5cf7bc0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,634 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5cf7bc0>)
2025-06-24 15:08:13,634 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa5cf7bc0>) completed
2025-06-24 15:08:13,635 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf7bc0>)
2025-06-24 15:08:13,636 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa5cf7bc0>) completed
2025-06-24 15:08:13,637 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,637 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,677 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,679 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,681 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7fc40>)
2025-06-24 15:08:13,683 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7fc40>) completed
2025-06-24 15:08:13,685 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7fc40>)
2025-06-24 15:08:13,686 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7fc40>) completed
2025-06-24 15:08:13,687 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7fc40>)
2025-06-24 15:08:13,689 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7fc40>) completed
2025-06-24 15:08:13,691 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,692 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa5eb0ae0>
2025-06-24 15:08:13,692 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa5eb0ae0> completed
2025-06-24 15:08:13,693 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7eb60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,694 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7eb60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,694 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7eb60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,695 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa5e7eb60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,698 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,699 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,705 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7eb60>)
2025-06-24 15:08:13,706 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa5e7eb60>) completed
2025-06-24 15:08:13,707 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4de47c0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,708 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4de47c0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,709 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4de47c0>)
2025-06-24 15:08:13,709 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4de47c0>) completed
2025-06-24 15:08:13,710 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4de47c0>)
2025-06-24 15:08:13,710 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4de47c0>) completed
2025-06-24 15:08:13,711 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,712 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,753 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,755 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,757 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7eb60>)
2025-06-24 15:08:13,757 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7eb60>) completed
2025-06-24 15:08:13,758 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7eb60>)
2025-06-24 15:08:13,759 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa5e7eb60>) completed
2025-06-24 15:08:13,759 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7eb60>)
2025-06-24 15:08:13,760 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa5e7eb60>) completed
2025-06-24 15:08:13,761 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,762 - aiosqlite - DEBUG - executing <function connect.<locals>.connector at 0x7f0aa60aa0c0>
2025-06-24 15:08:13,763 - aiosqlite - DEBUG - operation <function connect.<locals>.connector at 0x7f0aa60aa0c0> completed
2025-06-24 15:08:13,764 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526b1f0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True)
2025-06-24 15:08:13,765 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526b1f0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x7f0aa6042fc0>, deterministic=True) completed
2025-06-24 15:08:13,765 - aiosqlite - DEBUG - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526b1f0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-24 15:08:13,766 - aiosqlite - DEBUG - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x7f0aa526b1f0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-24 15:08:13,769 - ultibot_backend.services.credential_service - INFO - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 15:08:13,770 - ultibot_backend.services.credential_service - INFO - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 15:08:13,777 - aiosqlite - DEBUG - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526b1f0>)
2025-06-24 15:08:13,778 - aiosqlite - DEBUG - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x7f0aa526b1f0>) completed
2025-06-24 15:08:13,778 - aiosqlite - DEBUG - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4eecdc0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ())
2025-06-24 15:08:13,779 - aiosqlite - DEBUG - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x7f0aa4eecdc0>, "SELECT * FROM user_configurations WHERE user_id = '00000000-0000-0000-0000-000000000001' LIMIT 1", ()) completed
2025-06-24 15:08:13,779 - aiosqlite - DEBUG - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4eecdc0>)
2025-06-24 15:08:13,780 - aiosqlite - DEBUG - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x7f0aa4eecdc0>) completed
2025-06-24 15:08:13,780 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4eecdc0>)
2025-06-24 15:08:13,781 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x7f0aa4eecdc0>) completed
2025-06-24 15:08:13,782 - ultibot_backend.services.portfolio_service - INFO - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-24 15:08:13,782 - ultibot_backend.services.portfolio_service - INFO - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-24 15:08:13,824 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Iniciando cierre...
2025-06-24 15:08:13,826 - ultibot_backend.services.market_data_service - INFO - MarketDataService: Cierre completado.
2025-06-24 15:08:13,827 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526b1f0>)
2025-06-24 15:08:13,828 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526b1f0>) completed
2025-06-24 15:08:13,830 - aiosqlite - DEBUG - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526b1f0>)
2025-06-24 15:08:13,830 - aiosqlite - DEBUG - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x7f0aa526b1f0>) completed
2025-06-24 15:08:13,831 - aiosqlite - DEBUG - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa526b1f0>)
2025-06-24 15:08:13,832 - aiosqlite - DEBUG - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x7f0aa526b1f0>) completed
2025-06-24 15:08:13,833 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,834 - src.ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://testserver
2025-06-24 15:08:13,837 - asyncio - DEBUG - Using selector: EpollSelector
2025-06-24 15:08:13,838 - src.ultibot_ui.services.api_client - DEBUG - APIClient singleton: base URL establecida en http://testserver
2025-06-24 15:08:13,840 - src.ultibot_ui.services.api_client - INFO - Obteniendo trades, modo: paper, filtros: {'trading_mode': 'paper', 'limit': 100, 'offset': 0, 'status': 'open'}
2025-06-24 15:08:13,841 - src.ultibot_ui.services.api_client - DEBUG - APIClient httpx client ya está inicializado.
2025-06-24 15:08:13,841 - src.ultibot_ui.services.api_client - DEBUG - APIClient: _make_request invocado para GET /api/v1/trades
2025-06-24 15:08:13,842 - src.ultibot_ui.services.api_client - WARNING - Error de red para GET http://testserver/api/v1/trades: Connection refused. Re-lanzando para posible reintento.
2025-06-24 15:08:13,843 - src.ultibot_ui.services.api_client - WARNING - Fallo de conexión, reintentando en 1.00s... (Intento 1) para GET
2025-06-24 15:08:14,844 - src.ultibot_ui.services.api_client - DEBUG - APIClient httpx client ya está inicializado.
2025-06-24 15:08:14,845 - src.ultibot_ui.services.api_client - DEBUG - APIClient: _make_request invocado para GET /api/v1/trades
2025-06-24 15:08:14,846 - src.ultibot_ui.services.api_client - INFO - HTTP Request: GET http://testserver/api/v1/trades "HTTP/HTTP/1.1 200 OK"
2025-06-24 15:08:14,847 - src.ultibot_ui.services.api_client - DEBUG - Response content (processed): [{'id': 'trade_123', 'symbol': 'BTC/USDT', 'status': 'open'}]
2025-06-24 15:08:41,714 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:08:41,716 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:08:41,717 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:08:41,719 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 15:09:11,781 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:09:11,783 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:09:11,784 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:09:11,786 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 15:09:41,813 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:09:41,815 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:09:41,816 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:09:41,818 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 11:09:50,189 - ultibot_backend - INFO - [MainThread] - main.py:100 - Apagando UltiBot Backend (lifespan)...
2025-06-24 11:09:50,189 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:200 - Shutting down dependency container...
2025-06-24 11:09:50,195 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:205 - Dependency container shut down.
2025-06-24 11:09:50,195 - ultibot_backend - INFO - [MainThread] - main.py:103 - Recursos liberados y aplicación apagada (lifespan).
2025-06-24 11:09:54,259 - ultibot_backend - INFO - [MainThread] - main.py:111 - Creando nueva instancia de FastAPI...
2025-06-24 11:09:54,259 - ultibot_backend - INFO - [MainThread] - main.py:154 - Registrando routers de la API...
2025-06-24 11:09:54,290 - ultibot_backend - INFO - [MainThread] - main.py:165 - Todos los routers han sido registrados.
2025-06-24 11:09:54,291 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 11:09:54,293 - ultibot_backend - INFO - [MainThread] - main.py:82 - Iniciando UltiBot Backend (lifespan)...
2025-06-24 11:09:54,294 - ultibot_backend - INFO - [MainThread] - main.py:87 - DependencyContainer adjuntado a app.state: True
2025-06-24 11:09:54,294 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-24 11:09:54,294 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///./ultibot_local.db
2025-06-24 11:09:54,331 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-24 11:09:54,717 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 11:09:54,719 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:30 - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 11:09:54,719 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:36 - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 11:09:54,719 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 11:09:54,729 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:144 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-24 11:09:54,734 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x0000028E6CF5DBD0>
2025-06-24 11:09:54,735 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-24 11:09:54,735 - ultibot_backend - INFO - [MainThread] - main.py:91 - Contenedor de dependencias inicializado en lifespan.
2025-06-24 11:09:54,735 - ultibot_backend - INFO - [MainThread] - main.py:97 - Aplicación iniciada correctamente (lifespan).
2025-06-24 11:09:58,728 - ultibot_backend - INFO - [MainThread] - main.py:111 - Creando nueva instancia de FastAPI...
2025-06-24 11:09:58,729 - ultibot_backend - INFO - [MainThread] - main.py:154 - Registrando routers de la API...
2025-06-24 11:09:58,752 - ultibot_backend - INFO - [MainThread] - main.py:165 - Todos los routers han sido registrados.
2025-06-24 11:09:58,753 - ultibot_backend - INFO - [MainThread] - main.py:218 - Instancia global de la aplicación creada.
2025-06-24 11:09:58,754 - ultibot_backend - INFO - [MainThread] - main.py:82 - Iniciando UltiBot Backend (lifespan)...
2025-06-24 11:09:58,754 - ultibot_backend - INFO - [MainThread] - main.py:87 - DependencyContainer adjuntado a app.state: True
2025-06-24 11:09:58,754 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-24 11:09:58,754 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///./ultibot_local.db
2025-06-24 11:09:58,791 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-24 11:09:59,179 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-24 11:09:59,179 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:30 - CredentialService __init__ intentando obtener encryption_key de AppSettings: Presente
2025-06-24 11:09:59,179 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:36 - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-24 11:09:59,179 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-24 11:09:59,198 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:144 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-24 11:09:59,199 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001B49270EE10>
2025-06-24 11:09:59,199 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-24 11:09:59,199 - ultibot_backend - INFO - [MainThread] - main.py:91 - Contenedor de dependencias inicializado en lifespan.
2025-06-24 11:09:59,199 - ultibot_backend - INFO - [MainThread] - main.py:97 - Aplicación iniciada correctamente (lifespan).
2025-06-24 15:10:11,843 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:10:11,844 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:10:11,845 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:10:11,846 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 15:10:41,876 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:10:41,878 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:10:41,879 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:10:41,880 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 15:11:11,905 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:11:11,907 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:11:11,908 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:11:11,909 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
2025-06-24 15:11:41,931 - ultibot_backend - INFO - [MainThread] - main.py:123 - Middleware: Solicitud entrante: GET /health
2025-06-24 15:11:41,935 - ultibot_backend - INFO - [MainThread] - main.py:170 - Ejecutando health check extendido
2025-06-24 15:11:41,937 - ultibot_backend - ERROR - [MainThread] - main.py:208 - Error durante health check: 'DependencyContainer' object has no attribute 'db_client'
2025-06-24 15:11:41,939 - ultibot_backend - INFO - [MainThread] - main.py:125 - Middleware: Solicitud procesada: GET /health - Status: 503
