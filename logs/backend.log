2025-06-21 09:06:46,149 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:06:46,149 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:06:46,168 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:06:46,340 - qasync - INFO - [MainThread] - __init__.py:57 - Forcing use of PySide6 as Qt Implementation
2025-06-21 09:06:46,575 - matplotlib - DEBUG - [MainThread] - __init__.py:342 - matplotlib data path: C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\matplotlib\mpl-data
2025-06-21 09:06:46,580 - matplotlib - DEBUG - [MainThread] - __init__.py:342 - CONFIGDIR=C:\Users\zamor\.matplotlib
2025-06-21 09:06:46,581 - matplotlib - DEBUG - [MainThread] - __init__.py:1557 - interactive is False
2025-06-21 09:06:46,581 - matplotlib - DEBUG - [MainThread] - __init__.py:1558 - platform is win32
2025-06-21 09:06:46,641 - matplotlib - DEBUG - [MainThread] - __init__.py:342 - CACHEDIR=C:\Users\zamor\.matplotlib
2025-06-21 09:06:46,646 - matplotlib.font_manager - DEBUG - [MainThread] - font_manager.py:1635 - Using fontManager instance from C:\Users\zamor\.matplotlib\fontlist-v390.json
2025-06-21 09:06:47,287 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:06:47,288 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:06:47,288 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:06:47,288 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///./ultibot_local.db
2025-06-21 09:06:47,318 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:06:47,706 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:06:47,706 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:47,707 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:47,707 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:06:47,724 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:47,724 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000205F989BA10>
2025-06-21 09:06:47,724 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:06:47,725 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:06:47,725 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: None
2025-06-21 09:06:47,725 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000205F989BA10>
2025-06-21 09:06:47,734 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:06:48,054 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:06:48,055 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:48,055 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000205F989BA10>
2025-06-21 09:06:48,059 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:06:48,073 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:06:48,074 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: OperatingMode.REAL
2025-06-21 09:06:48,074 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000205F989BA10>
2025-06-21 09:06:48,079 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:06:48,093 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:06:48,094 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: None
2025-06-21 09:06:48,094 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000205F989BA10>
2025-06-21 09:06:48,097 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:06:48,113 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:06:48,114 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:48,114 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000205F989BA10>
2025-06-21 09:06:48,117 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:06:48,129 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:06:48,130 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 422
2025-06-21 09:06:48,137 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:06:48,138 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: None
2025-06-21 09:06:48,138 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000205F989BA10>
2025-06-21 09:06:48,141 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:06:48,241 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:06:48,247 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:06:48,248 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:06:48,274 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:06:48,275 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:06:48,277 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:06:48,287 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:48,288 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 200
2025-06-21 09:06:48,289 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:06:48,290 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:06:48,311 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:06:48,312 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:06:48,313 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:06:48,322 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:48,323 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 200
2025-06-21 09:06:48,349 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:06:48,349 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:06:48,350 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:06:48,359 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:48,359 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 200
2025-06-21 09:06:48,393 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:06:48,394 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 422
2025-06-21 09:06:48,406 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 5c2b774b-e5e8-4cff-9098-9cc6b99c5574
2025-06-21 09:06:48,407 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:152 - User configuration saved after initializing last_daily_reset for user 9e00b950-2d60-47ce-83c5-abcdee09de12.
2025-06-21 09:06:48,407 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'test_strategy' as context for confirmed opportunity 5c2b774b-e5e8-4cff-9098-9cc6b99c5574
2025-06-21 09:06:48,408 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 96c33e44-a1d9-4308-a40c-ccec10927c87 from decision d28cd091-9a6b-4ff5-a0e0-c50bd5ff917b
2025-06-21 09:06:48,408 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 96c33e44-a1d9-4308-a40c-ccec10927c87 persisted before execution.
2025-06-21 09:06:48,409 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 96c33e44-a1d9-4308-a40c-ccec10927c87 from confirmed opportunity.
2025-06-21 09:06:48,410 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:06:48,410 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 96c33e44-a1d9-4308-a40c-ccec10927c87. OCO List ID: oco_list_123
2025-06-21 09:06:48,410 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:348 - Updated daily_capital_risked_usd for user 9e00b950-2d60-47ce-83c5-abcdee09de12 to 200.0000000000000000000000000.
2025-06-21 09:06:48,410 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 5c2b774b-e5e8-4cff-9098-9cc6b99c5574 status to converted_to_trade_real: Trade 96c33e44-a1d9-4308-a40c-ccec10927c87 executed based on user confirmation.
2025-06-21 09:06:48,411 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 5c2b774b-e5e8-4cff-9098-9cc6b99c5574
2025-06-21 09:06:48,421 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 8b5477aa-c647-4ef9-bad1-b5feebb590d2
2025-06-21 09:06:48,421 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:190 - Límite de riesgo de capital diario excedido. Límite: 5000.00, Arriesgado: 4800.0, Nuevo Trade: 300.000
2025-06-21 09:06:48,421 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 8b5477aa-c647-4ef9-bad1-b5feebb590d2 status to error_in_processing: Límite de riesgo de capital diario excedido. Límite: 5000.00, Arriesgado: 4800.0, Nuevo Trade: 300.000
2025-06-21 09:06:48,422 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 8b5477aa-c647-4ef9-bad1-b5feebb590d2
2025-06-21 09:06:48,436 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 4f45232f-26e7-4bf6-8045-3c9a387cd826
2025-06-21 09:06:48,437 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:143 - Daily capital reset triggered for user cd61da55-5182-45f0-9f46-452a126a01dc. Resetting daily_capital_risked_usd.
2025-06-21 09:06:48,437 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:147 - User configuration saved after daily capital reset for user cd61da55-5182-45f0-9f46-452a126a01dc.
2025-06-21 09:06:48,437 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'test_strategy' as context for confirmed opportunity 4f45232f-26e7-4bf6-8045-3c9a387cd826
2025-06-21 09:06:48,438 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 970cfab7-a8c3-4229-8a67-b26e2e88570b from decision 484cb78f-2173-4354-aa21-71f3ed5a5ed3
2025-06-21 09:06:48,439 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 970cfab7-a8c3-4229-8a67-b26e2e88570b persisted before execution.
2025-06-21 09:06:48,439 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 970cfab7-a8c3-4229-8a67-b26e2e88570b from confirmed opportunity.
2025-06-21 09:06:48,440 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:06:48,440 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 970cfab7-a8c3-4229-8a67-b26e2e88570b. OCO List ID: oco_reset_test
2025-06-21 09:06:48,440 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:348 - Updated daily_capital_risked_usd for user cd61da55-5182-45f0-9f46-452a126a01dc to 100.000.
2025-06-21 09:06:48,440 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 4f45232f-26e7-4bf6-8045-3c9a387cd826 status to converted_to_trade_real: Trade 970cfab7-a8c3-4229-8a67-b26e2e88570b executed based on user confirmation.
2025-06-21 09:06:48,441 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 4f45232f-26e7-4bf6-8045-3c9a387cd826
2025-06-21 09:06:49,895 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity b6f2ee83-e3e6-4331-b915-c1495b0a511d for symbol BTCUSDT
2025-06-21 09:06:49,897 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 0ef55700-65d6-4b09-8ae8-72ea84a49d37
2025-06-21 09:06:49,897 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 41fa0408-d4a6-4adf-aa2f-d25c59dc514e can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:49,905 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity ac386fe0-bbaa-4d8c-8e47-21e09efaf0ae for symbol BTCUSDT
2025-06-21 09:06:49,905 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 0995fd29-adc1-4901-b9cf-72d1c99f4efe can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:49,911 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 54d07677-7719-4e04-b959-c0c68c2f4846 for symbol ETHUSDT
2025-06-21 09:06:49,912 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: db9216fd-fd8b-4ab4-9183-ba3b32b83281
2025-06-21 09:06:49,913 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity 54d07677-7719-4e04-b959-c0c68c2f4846 with symbol ETHUSDT.
2025-06-21 09:06:50,059 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 7020da42-23ef-4013-8d2b-e8ab67ecc629 for symbol BTCUSDT
2025-06-21 09:06:50,059 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 147930c3-87cc-45e2-8727-a5e3079ef8f7
2025-06-21 09:06:50,061 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity 7020da42-23ef-4013-8d2b-e8ab67ecc629 with symbol BTCUSDT.
2025-06-21 09:06:50,076 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 680d540e-ee69-4739-9f36-2eef5c496aa7 for symbol BTCUSDT
2025-06-21 09:06:50,077 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 39576c83-01dd-4874-b02b-5fa82ca75ac9
2025-06-21 09:06:50,078 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity 680d540e-ee69-4739-9f36-2eef5c496aa7 with symbol BTCUSDT.
2025-06-21 09:06:50,093 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 10a04522-3ca3-480b-97ab-efde97ca819b for symbol BTCUSDT
2025-06-21 09:06:50,094 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 6ce83235-750d-495b-b170-6e97c4868299
2025-06-21 09:06:50,096 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity 10a04522-3ca3-480b-97ab-efde97ca819b with symbol BTCUSDT.
2025-06-21 09:06:50,110 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 8f0af340-cd76-4792-be9b-aacef1aa15bf from decision d863a04a-e4c4-4439-90b0-28d88cedbfb7
2025-06-21 09:06:50,111 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 8f0af340-cd76-4792-be9b-aacef1aa15bf persisted before execution.
2025-06-21 09:06:50,115 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 93ae2a29-cbf4-4328-b7b7-8bb0c3c6dfe6 from decision 9c2c50da-fc3c-4016-beb5-5f0c69ee99ad
2025-06-21 09:06:50,117 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 93ae2a29-cbf4-4328-b7b7-8bb0c3c6dfe6 persisted before execution.
2025-06-21 09:06:50,118 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 4b8279c8-a98e-4f57-9601-314cd1d7dbb4 from decision 9c2c50da-fc3c-4016-beb5-5f0c69ee99ad
2025-06-21 09:06:50,118 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 4b8279c8-a98e-4f57-9601-314cd1d7dbb4 persisted before execution.
2025-06-21 09:06:50,142 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,142 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,157 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,157 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,159 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,161 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 80768b4c-ced7-403f-b3f8-fb81e00d4366
2025-06-21 09:06:50,165 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 0e96bdec-5332-4a17-a73d-e0eb942ffaaf. Creando y guardando configuración por defecto.
2025-06-21 09:06:50,168 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:50,172 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 0e96bdec-5332-4a17-a73d-e0eb942ffaaf. Using default values.
2025-06-21 09:06:50,172 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 0e96bdec-5332-4a17-a73d-e0eb942ffaaf with capital: 10000.0
2025-06-21 09:06:50,173 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:06:50,174 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:06:50,174 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'AI-Enhanced Scalping' as context for confirmed opportunity 80768b4c-ced7-403f-b3f8-fb81e00d4366
2025-06-21 09:06:50,174 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade cb034614-d050-4596-99bb-b60b21067bc6 from decision 833670c5-ca98-4657-9451-9826f77da467
2025-06-21 09:06:50,174 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade cb034614-d050-4596-99bb-b60b21067bc6 persisted before execution.
2025-06-21 09:06:50,175 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade cb034614-d050-4596-99bb-b60b21067bc6 from confirmed opportunity.
2025-06-21 09:06:50,176 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:06:50,176 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade cb034614-d050-4596-99bb-b60b21067bc6. OCO List ID: <MagicMock id='2224691882704'>
2025-06-21 09:06:50,180 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None), (UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None), (UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:06:50,185 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity 80768b4c-ced7-403f-b3f8-fb81e00d4366: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None), (UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:06:50,189 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 80768b4c-ced7-403f-b3f8-fb81e00d4366 status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:06:50,189 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity 80768b4c-ced7-403f-b3f8-fb81e00d4366: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None), (UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None), (UUID('cb034614-d050-4596-99bb-b60b21067bc6'), 'fcecabfc-7300-49ab-a2cf-74b32a0b1d44', '{"id":"cb034614-d050-4596-99bb-b60b21067bc6","user_id":"fcecabfc-7300-49ab-a2cf-74b32a0b1d44","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.174369","opened_at":"2025-06-21T13:06:50.174369","updated_at":"2025-06-21T13:06:50.174369","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.174369', '2025-06-21 13:06:50.174369', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:06:50,201 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,203 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,227 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,227 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,240 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,240 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,242 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,244 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,245 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,269 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,270 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,279 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,279 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,282 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,284 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 65c62731-088c-43e1-a728-04d30e736caa for symbol BTC/USDT
2025-06-21 09:06:50,288 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 1be77978-6c1a-4c80-b3ca-9b48a34ab8ce. Creando y guardando configuración por defecto.
2025-06-21 09:06:50,291 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:50,292 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:657 - AI profile 'ai-profile-scalping-1' for strategy c8f6ae74-827a-4838-8df1-25a3f0c9531d not found. Skipping AI analysis.
2025-06-21 09:06:50,292 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy c8f6ae74-827a-4838-8df1-25a3f0c9531d can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:50,292 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 65c62731-088c-43e1-a728-04d30e736caa status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:50,299 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 65c62731-088c-43e1-a728-04d30e736caa
2025-06-21 09:06:50,300 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,301 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,327 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,328 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,339 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,339 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,342 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,344 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity ac440532-bbf4-4155-a540-709610ee168a
2025-06-21 09:06:50,347 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 5922111a-432e-4faa-ab29-5a340db308fd. Creando y guardando configuración por defecto.
2025-06-21 09:06:50,349 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:50,351 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 5922111a-432e-4faa-ab29-5a340db308fd. Using default values.
2025-06-21 09:06:50,352 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 5922111a-432e-4faa-ab29-5a340db308fd with capital: 10000.0
2025-06-21 09:06:50,353 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:06:50,354 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:06:50,354 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'Autonomous Scalping' as context for confirmed opportunity ac440532-bbf4-4155-a540-709610ee168a
2025-06-21 09:06:50,354 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 48eb1714-1107-4b3d-ac87-0f7c7f186679 from decision 5db33c60-aff0-4e96-bad7-fc5618e30373
2025-06-21 09:06:50,354 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 48eb1714-1107-4b3d-ac87-0f7c7f186679 persisted before execution.
2025-06-21 09:06:50,355 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 48eb1714-1107-4b3d-ac87-0f7c7f186679 from confirmed opportunity.
2025-06-21 09:06:50,356 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:06:50,357 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 48eb1714-1107-4b3d-ac87-0f7c7f186679. OCO List ID: <MagicMock id='2224694672016'>
2025-06-21 09:06:50,360 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None), (UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None), (UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:06:50,362 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity ac440532-bbf4-4155-a540-709610ee168a: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None), (UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:06:50,364 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity ac440532-bbf4-4155-a540-709610ee168a status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:06:50,365 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity ac440532-bbf4-4155-a540-709610ee168a: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None), (UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None), (UUID('48eb1714-1107-4b3d-ac87-0f7c7f186679'), '07b02845-75a4-49ae-8b1a-3d77d236587e', '{"id":"48eb1714-1107-4b3d-ac87-0f7c7f186679","user_id":"07b02845-75a4-49ae-8b1a-3d77d236587e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.354430","opened_at":"2025-06-21T13:06:50.354430","updated_at":"2025-06-21T13:06:50.354430","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.354430', '2025-06-21 13:06:50.354430', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:06:50,375 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,376 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,399 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,399 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,410 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,410 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,412 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,414 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 2d18a9d3-04ef-4f68-a21c-59e92a393e50
2025-06-21 09:06:50,417 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id f21c6d32-401c-47bb-a67a-9368aaa7b436. Creando y guardando configuración por defecto.
2025-06-21 09:06:50,420 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:50,423 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for f21c6d32-401c-47bb-a67a-9368aaa7b436. Using default values.
2025-06-21 09:06:50,423 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for f21c6d32-401c-47bb-a67a-9368aaa7b436 with capital: 10000.0
2025-06-21 09:06:50,424 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:06:50,425 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:06:50,425 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'AI-Enhanced Scalping' as context for confirmed opportunity 2d18a9d3-04ef-4f68-a21c-59e92a393e50
2025-06-21 09:06:50,425 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 0e27adc3-5624-4efc-8951-20473224d4ac from decision 6f541eb9-e08f-4e98-a7e0-2f3fa7059a9c
2025-06-21 09:06:50,425 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 0e27adc3-5624-4efc-8951-20473224d4ac persisted before execution.
2025-06-21 09:06:50,426 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 0e27adc3-5624-4efc-8951-20473224d4ac from confirmed opportunity.
2025-06-21 09:06:50,426 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:06:50,427 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 0e27adc3-5624-4efc-8951-20473224d4ac. OCO List ID: <MagicMock id='2224690237072'>
2025-06-21 09:06:50,431 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None), (UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None), (UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:06:50,433 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity 2d18a9d3-04ef-4f68-a21c-59e92a393e50: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None), (UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:06:50,435 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 2d18a9d3-04ef-4f68-a21c-59e92a393e50 status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:06:50,436 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity 2d18a9d3-04ef-4f68-a21c-59e92a393e50: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None), (UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None), (UUID('0e27adc3-5624-4efc-8951-20473224d4ac'), 'fb906ad1-95aa-4abc-8cab-3f9bf5461420', '{"id":"0e27adc3-5624-4efc-8951-20473224d4ac","user_id":"fb906ad1-95aa-4abc-8cab-3f9bf5461420","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.425102","opened_at":"2025-06-21T13:06:50.425102","updated_at":"2025-06-21T13:06:50.425102","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.425102', '2025-06-21 13:06:50.425102', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:06:50,445 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,446 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,469 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,470 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,479 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,479 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,481 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,482 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 6b7c3d35-0cf4-486a-86fa-621a41c2ede4
2025-06-21 09:06:50,487 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 2bde549e-c143-4989-8fc6-5d99e2e6c40a. Creando y guardando configuración por defecto.
2025-06-21 09:06:50,490 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:50,492 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 2bde549e-c143-4989-8fc6-5d99e2e6c40a. Using default values.
2025-06-21 09:06:50,492 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 2bde549e-c143-4989-8fc6-5d99e2e6c40a with capital: 10000.0
2025-06-21 09:06:50,494 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:06:50,494 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:06:50,494 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'Day Trading Strategy' as context for confirmed opportunity 6b7c3d35-0cf4-486a-86fa-621a41c2ede4
2025-06-21 09:06:50,494 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 318eb362-c1bb-4d91-95eb-d8140331f523 from decision ef684b13-321c-476f-a613-efd92d86a637
2025-06-21 09:06:50,495 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 318eb362-c1bb-4d91-95eb-d8140331f523 persisted before execution.
2025-06-21 09:06:50,495 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 318eb362-c1bb-4d91-95eb-d8140331f523 from confirmed opportunity.
2025-06-21 09:06:50,496 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:06:50,497 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 318eb362-c1bb-4d91-95eb-d8140331f523. OCO List ID: <MagicMock id='2224716703376'>
2025-06-21 09:06:50,500 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None), (UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None), (UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:06:50,502 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity 6b7c3d35-0cf4-486a-86fa-621a41c2ede4: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None), (UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:06:50,505 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 6b7c3d35-0cf4-486a-86fa-621a41c2ede4 status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:06:50,505 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity 6b7c3d35-0cf4-486a-86fa-621a41c2ede4: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None), (UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None), (UUID('318eb362-c1bb-4d91-95eb-d8140331f523'), 'df15b315-99cc-4092-b7e4-86c1669ccbc0', '{"id":"318eb362-c1bb-4d91-95eb-d8140331f523","user_id":"df15b315-99cc-4092-b7e4-86c1669ccbc0","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:06:50.494467","opened_at":"2025-06-21T13:06:50.494467","updated_at":"2025-06-21T13:06:50.494467","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:06:50.494467', '2025-06-21 13:06:50.494467', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:06:50,515 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,516 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,541 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,541 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,551 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,551 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,554 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,556 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 4033dec1-9e7f-4ecd-91e0-6b7db89ada2b from decision c00385fc-916a-42a9-844a-3649a1934bb5
2025-06-21 09:06:50,556 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 4033dec1-9e7f-4ecd-91e0-6b7db89ada2b persisted before execution.
2025-06-21 09:06:50,557 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,558 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,589 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,589 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,602 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,602 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,605 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,606 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade a46dd968-3546-48ea-b393-159c374ca490 from decision 01eb74e9-c8f0-43e9-a627-51b66f1b251e
2025-06-21 09:06:50,607 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade a46dd968-3546-48ea-b393-159c374ca490 persisted before execution.
2025-06-21 09:06:50,607 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,608 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:50,636 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:50,637 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:50,646 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:06:50,646 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:06:50,649 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:50,650 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:50,651 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:51,655 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,657 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: -nw83... (truncada por seguridad)
2025-06-21 09:06:51,678 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:06:51,680 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:06:51,682 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:06:51,687 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:06:51,691 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 00000000-0000-0000-0000-000000000001. Creando y guardando configuración por defecto.
2025-06-21 09:06:51,692 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:51,695 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:06:51,701 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:06:51,705 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:06:51,709 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,709 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,712 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,713 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,714 - ultibot_backend.services.credential_service - WARNING - [MainThread] - credential_service.py:56 - Advertencia: Token de encriptación inválido. La desencriptación falló.
2025-06-21 09:06:51,716 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,716 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,724 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,725 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,732 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,732 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,735 - ultibot_backend.services.credential_service - WARNING - [MainThread] - credential_service.py:56 - Advertencia: Token de encriptación inválido. La desencriptación falló.
2025-06-21 09:06:51,740 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,740 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,743 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:285 - Verificación de Binance BINANCE_SPOT exitosa.
2025-06-21 09:06:51,748 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,749 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,752 - ultibot_backend.services.credential_service - ERROR - [MainThread] - credential_service.py:314 - Error de Binance API durante la verificación: Binance Down
2025-06-21 09:06:51,756 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,756 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,759 - ultibot_backend.services.credential_service - WARNING - [MainThread] - credential_service.py:56 - Advertencia: Token de encriptación inválido. La desencriptación falló.
2025-06-21 09:06:51,763 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:06:51,764 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: W8knO... (truncada por seguridad)
2025-06-21 09:06:51,767 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:240 - Verificación de Telegram exitosa.
2025-06-21 09:06:51,776 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:73 - Conexión con Binance exitosa.
2025-06-21 09:06:51,781 - ultibot_backend.services.market_data_service - WARNING - [MainThread] - market_data_service.py:53 - Credenciales de Binance no encontradas. Por favor, configúrelas.
2025-06-21 09:06:51,788 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:70 - Fallo en la verificación de conexión con Binance. Revise sus credenciales y permisos.
2025-06-21 09:06:51,793 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:78 - Error al acceder a las credenciales de Binance: Decryption failed
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\market_data_service.py", line 46, in get_binance_connection_status
    binance_credential = await self.credential_service.get_credential(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 2237, in _execute_mock_call
    raise effect
ultibot_backend.core.exceptions.CredentialError: Decryption failed
2025-06-21 09:06:51,798 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:82 - Error de la API de Binance: API unavailable
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\market_data_service.py", line 62, in get_binance_connection_status
    is_connected = await self.credential_service.verify_credential(binance_credential)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 2237, in _execute_mock_call
    raise effect
ultibot_backend.core.exceptions.BinanceAPIError: API unavailable
2025-06-21 09:06:51,804 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:06:51,814 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:122 - Error de la API de Binance al obtener balances: Failed to fetch balances
2025-06-21 09:06:51,817 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224720722704'>
2025-06-21 09:06:51,819 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: None
2025-06-21 09:06:51,819 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224720722704'>
2025-06-21 09:06:51,820 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 0000381a-f8d7-452e-adb4-e74040163382 with mode_filter: None
2025-06-21 09:06:51,824 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224720726992'>
2025-06-21 09:06:51,825 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: None
2025-06-21 09:06:51,826 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224720726992'>
2025-06-21 09:06:51,826 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 0000381a-f8d7-452e-adb4-e74040163382 with mode_filter: None
2025-06-21 09:06:51,828 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224720722192'>
2025-06-21 09:06:51,829 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,831 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224720722192'>
2025-06-21 09:06:51,831 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,834 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224715749264'>
2025-06-21 09:06:51,835 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,835 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224715749264'>
2025-06-21 09:06:51,836 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,842 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224715843472'>
2025-06-21 09:06:51,844 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.REAL
2025-06-21 09:06:51,844 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224715843472'>
2025-06-21 09:06:51,845 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,849 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224720862480'>
2025-06-21 09:06:51,850 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,851 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224720862480'>
2025-06-21 09:06:51,851 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,856 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224715852304'>
2025-06-21 09:06:51,858 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: None
2025-06-21 09:06:51,858 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224715852304'>
2025-06-21 09:06:51,858 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 2 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,862 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224715599504'>
2025-06-21 09:06:51,864 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,864 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224715599504'>
2025-06-21 09:06:51,864 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,868 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224714972112'>
2025-06-21 09:06:51,870 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,870 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224714972112'>
2025-06-21 09:06:51,871 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 0000381a-f8d7-452e-adb4-e74040163382 with mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,874 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224715601040'>
2025-06-21 09:06:51,876 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,876 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224715601040'>
2025-06-21 09:06:51,876 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 0000381a-f8d7-452e-adb4-e74040163382 with mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,879 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224715412368'>
2025-06-21 09:06:51,880 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,880 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224715412368'>
2025-06-21 09:06:51,881 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,883 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224716752080'>
2025-06-21 09:06:51,885 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,886 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224716752080'>
2025-06-21 09:06:51,886 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,889 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224714913040'>
2025-06-21 09:06:51,891 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,891 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224714913040'>
2025-06-21 09:06:51,891 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,894 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2224715045328'>
2025-06-21 09:06:51,896 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 0000381a-f8d7-452e-adb4-e74040163382, mode_filter: OperatingMode.PAPER
2025-06-21 09:06:51,896 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2224715045328'>
2025-06-21 09:06:51,896 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 0000381a-f8d7-452e-adb4-e74040163382
2025-06-21 09:06:51,942 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 3 trades cerrados para usuario 5d7958a3-d3f1-4ed0-a9bf-490d0ec7a3ab en modo paper
2025-06-21 09:06:51,948 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 3 trades cerrados para usuario 16d923ad-4d70-41f1-951b-24997db7e66b en modo paper
2025-06-21 09:06:51,952 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 3c9fe50d-e695-4640-90c3-1c6b2aa771fc en modo paper
2025-06-21 09:06:51,957 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:79 - Error al obtener trades cerrados para usuario 8f915aed-3530-4ba1-94bc-2ac42769953c: Database connection failed
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 2237, in _execute_mock_call
    raise effect
Exception: Database connection failed
2025-06-21 09:06:51,980 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 4e1b7417-1029-4c96-a844-c22568189a94 for symbol BTC/USDT
2025-06-21 09:06:51,981 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy a1982c3e-a023-4f99-8d80-7dea3d9ba6a4 can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:51,981 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 4e1b7417-1029-4c96-a844-c22568189a94 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:51,982 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 4e1b7417-1029-4c96-a844-c22568189a94
2025-06-21 09:06:51,993 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 618b0a29-2cab-4e7e-ab2d-2ddd931916a0 for symbol BTC/USDT
2025-06-21 09:06:51,995 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy dc9f820e-d841-4221-8f7d-5500ea675e86 can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:51,995 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 618b0a29-2cab-4e7e-ab2d-2ddd931916a0 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:51,995 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 618b0a29-2cab-4e7e-ab2d-2ddd931916a0
2025-06-21 09:06:52,007 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity f3e272a7-9b9d-492a-8a13-df1f035e4f8f for symbol BTC/USDT
2025-06-21 09:06:52,008 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy a9df3931-4a23-4e97-b4b3-9f163b7a88ba can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:52,008 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity f3e272a7-9b9d-492a-8a13-df1f035e4f8f status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:52,009 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity f3e272a7-9b9d-492a-8a13-df1f035e4f8f
2025-06-21 09:06:52,021 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 8c9bd448-a370-4454-b6ad-681b43e86090 for symbol BTC/USDT
2025-06-21 09:06:52,023 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy e39430e3-af55-463a-a38b-baf302a64e9e can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:52,023 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 8c9bd448-a370-4454-b6ad-681b43e86090 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:52,024 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 8c9bd448-a370-4454-b6ad-681b43e86090
2025-06-21 09:06:52,033 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 3ecc365c-a880-4fa8-8891-7a9ed87a881a for symbol BTC/USDT
2025-06-21 09:06:52,034 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:638 - Unknown strategy type 'CUSTOM_UNKNOWN_TYPE' for strategy bc3b6ef6-73ee-4620-b632-8eec76928167. Recommending investigation.
2025-06-21 09:06:52,034 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 3ecc365c-a880-4fa8-8891-7a9ed87a881a status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:52,036 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 3ecc365c-a880-4fa8-8891-7a9ed87a881a
2025-06-21 09:06:52,045 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 30929086-0040-4c8f-bc39-ef8952816314 for symbol BTC/USDT
2025-06-21 09:06:52,046 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy a2ef11c7-e615-452c-8ad0-bc41cae5c4f6 can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:52,046 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 30929086-0040-4c8f-bc39-ef8952816314 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:52,047 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 30929086-0040-4c8f-bc39-ef8952816314
2025-06-21 09:06:52,072 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity c88ce35c-927f-4d48-896a-3bfe8165ac28 for symbol BTC/USDT
2025-06-21 09:06:52,073 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 61a7d3bc-86cd-4bfb-812e-50cc2d08591c can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:06:52,073 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity c88ce35c-927f-4d48-896a-3bfe8165ac28 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:06:52,075 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity c88ce35c-927f-4d48-896a-3bfe8165ac28
2025-06-21 09:09:08,208 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:09:08,208 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:09:08,228 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:09:08,368 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:09:08,369 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:09:08,371 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp0cgprlzy/test_db.sqlite
2025-06-21 09:09:08,380 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378D5F740>
2025-06-21 09:09:08,381 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378D5F740> completed
2025-06-21 09:09:08,382 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D55D50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:08,382 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D55D50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:08,382 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D55D50>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:08,383 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D55D50>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:08,383 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,383 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,384 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D474C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:09:08,384 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D474C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:09:08,384 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D474C0>)
2025-06-21 09:09:08,385 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D474C0>) completed
2025-06-21 09:09:08,385 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D474C0>)
2025-06-21 09:09:08,385 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D474C0>) completed
2025-06-21 09:09:08,385 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,387 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,387 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,387 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,388 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D472C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:09:08,389 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D472C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:09:08,389 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D472C0>)
2025-06-21 09:09:08,390 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D472C0>) completed
2025-06-21 09:09:08,390 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D472C0>)
2025-06-21 09:09:08,391 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D472C0>) completed
2025-06-21 09:09:08,391 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,392 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,392 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D1EA40>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:09:08,392 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D1EA40>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:09:08,393 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D1EA40>)
2025-06-21 09:09:08,393 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D1EA40>) completed
2025-06-21 09:09:08,393 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D1EA40>)
2025-06-21 09:09:08,394 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D1EA40>) completed
2025-06-21 09:09:08,394 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,394 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,395 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D473C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:09:08,395 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D473C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:09:08,395 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D473C0>)
2025-06-21 09:09:08,396 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D473C0>) completed
2025-06-21 09:09:08,396 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D473C0>)
2025-06-21 09:09:08,396 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D473C0>) completed
2025-06-21 09:09:08,396 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,397 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,397 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47540>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:09:08,397 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47540>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:09:08,397 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47540>)
2025-06-21 09:09:08,398 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47540>) completed
2025-06-21 09:09:08,398 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47540>)
2025-06-21 09:09:08,398 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47540>) completed
2025-06-21 09:09:08,399 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,399 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,399 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D475C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:09:08,400 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D475C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:09:08,400 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D475C0>)
2025-06-21 09:09:08,400 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D475C0>) completed
2025-06-21 09:09:08,400 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D475C0>)
2025-06-21 09:09:08,401 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D475C0>) completed
2025-06-21 09:09:08,401 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,401 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,402 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47740>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:09:08,402 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47740>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:09:08,402 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47740>)
2025-06-21 09:09:08,402 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47740>) completed
2025-06-21 09:09:08,403 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47740>)
2025-06-21 09:09:08,403 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47740>) completed
2025-06-21 09:09:08,403 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,404 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,404 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D476C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:09:08,405 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D476C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:09:08,405 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D476C0>)
2025-06-21 09:09:08,405 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D476C0>) completed
2025-06-21 09:09:08,407 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D476C0>)
2025-06-21 09:09:08,407 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D476C0>) completed
2025-06-21 09:09:08,407 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,408 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,408 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D478C0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:09:08,408 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D478C0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:09:08,408 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D478C0>)
2025-06-21 09:09:08,409 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D478C0>) completed
2025-06-21 09:09:08,409 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D478C0>)
2025-06-21 09:09:08,409 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D478C0>) completed
2025-06-21 09:09:08,410 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,410 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,410 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D477C0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:09:08,411 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D477C0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:09:08,411 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D477C0>)
2025-06-21 09:09:08,411 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D477C0>) completed
2025-06-21 09:09:08,411 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D477C0>)
2025-06-21 09:09:08,412 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D477C0>) completed
2025-06-21 09:09:08,412 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,412 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,412 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47AC0>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:09:08,413 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47AC0>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:09:08,414 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47AC0>)
2025-06-21 09:09:08,414 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47AC0>) completed
2025-06-21 09:09:08,414 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47AC0>)
2025-06-21 09:09:08,414 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47AC0>) completed
2025-06-21 09:09:08,415 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,415 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,416 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47A40>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:09:08,416 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47A40>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:09:08,417 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47A40>)
2025-06-21 09:09:08,417 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47A40>) completed
2025-06-21 09:09:08,417 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47A40>)
2025-06-21 09:09:08,417 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47A40>) completed
2025-06-21 09:09:08,418 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,418 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,418 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47C40>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:09:08,419 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47C40>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:09:08,419 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47C40>)
2025-06-21 09:09:08,419 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47C40>) completed
2025-06-21 09:09:08,420 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47C40>)
2025-06-21 09:09:08,420 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47C40>) completed
2025-06-21 09:09:08,420 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,420 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,421 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47BC0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:09:08,422 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47BC0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:09:08,422 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47BC0>)
2025-06-21 09:09:08,422 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47BC0>) completed
2025-06-21 09:09:08,423 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47BC0>)
2025-06-21 09:09:08,423 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47BC0>) completed
2025-06-21 09:09:08,424 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,424 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,424 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47DC0>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:09:08,425 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47DC0>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:09:08,425 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47DC0>)
2025-06-21 09:09:08,425 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47DC0>) completed
2025-06-21 09:09:08,425 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47DC0>)
2025-06-21 09:09:08,425 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47DC0>) completed
2025-06-21 09:09:08,427 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,427 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,427 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47D40>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:09:08,432 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47D40>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:09:08,432 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47D40>)
2025-06-21 09:09:08,433 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47D40>) completed
2025-06-21 09:09:08,433 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,434 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,434 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DAA040>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:09:08,437 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DAA040>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:09:08,438 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DAA040>)
2025-06-21 09:09:08,439 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DAA040>) completed
2025-06-21 09:09:08,440 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,440 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,440 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47B40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:09:08,443 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47B40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:09:08,444 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47B40>)
2025-06-21 09:09:08,444 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47B40>) completed
2025-06-21 09:09:08,445 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,445 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,445 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47140>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:09:08,448 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47140>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:09:08,449 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47140>)
2025-06-21 09:09:08,449 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47140>) completed
2025-06-21 09:09:08,450 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,450 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,450 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47E40>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:09:08,452 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47E40>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:09:08,453 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47E40>)
2025-06-21 09:09:08,453 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47E40>) completed
2025-06-21 09:09:08,454 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,454 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,455 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47EC0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:09:08,457 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47EC0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:09:08,457 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47EC0>)
2025-06-21 09:09:08,458 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47EC0>) completed
2025-06-21 09:09:08,458 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,460 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,460 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47F40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:09:08,462 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47F40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:09:08,463 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47F40>)
2025-06-21 09:09:08,463 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47F40>) completed
2025-06-21 09:09:08,463 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,464 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,464 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DAB0C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:09:08,466 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DAB0C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:09:08,466 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DAB0C0>)
2025-06-21 09:09:08,467 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DAB0C0>) completed
2025-06-21 09:09:08,467 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,467 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,468 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47CC0>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:09:08,468 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378D47CC0>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:09:08,468 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47CC0>)
2025-06-21 09:09:08,468 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378D47CC0>) completed
2025-06-21 09:09:08,469 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47CC0>)
2025-06-21 09:09:08,469 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378D47CC0>) completed
2025-06-21 09:09:08,469 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:09:08,470 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,470 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,470 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,471 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,471 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378D55D50>)
2025-06-21 09:09:08,471 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378D55D50>) completed
2025-06-21 09:09:08,473 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:09:08,475 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378D75800>
2025-06-21 09:09:08,476 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378D75800> completed
2025-06-21 09:09:08,476 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7F970>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:08,476 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7F970>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:08,477 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7F970>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:08,477 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7F970>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:08,478 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,478 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,479 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC58C0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:09:08,480 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC58C0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:09:08,480 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC58C0>)
2025-06-21 09:09:08,480 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC58C0>) completed
2025-06-21 09:09:08,481 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,481 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,482 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC5B40>, 'DELETE FROM trades', ())
2025-06-21 09:09:08,482 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC5B40>, 'DELETE FROM trades', ()) completed
2025-06-21 09:09:08,483 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC5B40>)
2025-06-21 09:09:08,483 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC5B40>) completed
2025-06-21 09:09:08,483 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,484 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,484 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC60C0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:09:08,484 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC60C0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:09:08,484 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC60C0>)
2025-06-21 09:09:08,484 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC60C0>) completed
2025-06-21 09:09:08,485 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,485 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,485 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC5A40>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:09:08,487 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC5A40>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:09:08,487 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC5A40>)
2025-06-21 09:09:08,487 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC5A40>) completed
2025-06-21 09:09:08,489 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,489 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,490 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC4BC0>, 'DELETE FROM opportunities', ())
2025-06-21 09:09:08,490 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC4BC0>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:09:08,491 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC4BC0>)
2025-06-21 09:09:08,491 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC4BC0>) completed
2025-06-21 09:09:08,492 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,492 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,493 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378BDE940>, 'DELETE FROM market_data', ())
2025-06-21 09:09:08,493 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378BDE940>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:09:08,493 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378BDE940>)
2025-06-21 09:09:08,493 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378BDE940>) completed
2025-06-21 09:09:08,494 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,494 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,494 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC6340>, 'DELETE FROM api_credentials', ())
2025-06-21 09:09:08,495 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DC6340>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:09:08,495 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC6340>)
2025-06-21 09:09:08,495 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DC6340>) completed
2025-06-21 09:09:08,495 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,498 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,499 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,499 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,499 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378D7F970>)
2025-06-21 09:09:08,499 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378D7F970>) completed
2025-06-21 09:09:08,500 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378D754E0>
2025-06-21 09:09:08,502 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378D754E0> completed
2025-06-21 09:09:08,502 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7FD30>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:08,502 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7FD30>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:08,503 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7FD30>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:08,503 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378D7FD30>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:08,504 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7FD30>)
2025-06-21 09:09:08,504 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7FD30>) completed
2025-06-21 09:09:08,505 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DF8FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "651cbb16-0721-419f-afee-1923f89588fa", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:08.500855+00:00"}}', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00'))
2025-06-21 09:09:08,505 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DF8FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "651cbb16-0721-419f-afee-1923f89588fa", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:08.500855+00:00"}}', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00')) completed
2025-06-21 09:09:08,507 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DF8FC0>)
2025-06-21 09:09:08,507 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DF8FC0>) completed
2025-06-21 09:09:08,508 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7FD30>)
2025-06-21 09:09:08,508 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7FD30>) completed
2025-06-21 09:09:08,509 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DFA040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "b11b7523-62cd-4464-a383-582eb6041442", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:08.500855+00:00"}}', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00'))
2025-06-21 09:09:08,509 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DFA040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "b11b7523-62cd-4464-a383-582eb6041442", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:08.500855+00:00"}}', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00')) completed
2025-06-21 09:09:08,509 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DFA040>)
2025-06-21 09:09:08,509 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DFA040>) completed
2025-06-21 09:09:08,510 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7FD30>)
2025-06-21 09:09:08,510 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378D7FD30>) completed
2025-06-21 09:09:08,510 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DF9FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "b1673bb0-7577-40be-8081-63be120c2203", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:08.500855+00:00"}}', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00'))
2025-06-21 09:09:08,511 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378DF9FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "b1673bb0-7577-40be-8081-63be120c2203", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:08.500855+00:00"}}', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00', '2025-06-21T13:09:08.500855+00:00')) completed
2025-06-21 09:09:08,511 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DF9FC0>)
2025-06-21 09:09:08,511 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378DF9FC0>) completed
2025-06-21 09:09:08,512 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378D7FD30>)
2025-06-21 09:09:08,514 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378D7FD30>) completed
2025-06-21 09:09:08,514 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D7FD30>)
2025-06-21 09:09:08,514 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378D7FD30>) completed
2025-06-21 09:09:08,515 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378D7FD30>)
2025-06-21 09:09:08,515 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378D7FD30>) completed
2025-06-21 09:09:08,534 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:09:08,535 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:09:08,535 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:09:08,535 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp0cgprlzy/test_db.sqlite
2025-06-21 09:09:08,537 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378FC2F20>
2025-06-21 09:09:08,539 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378FC2F20> completed
2025-06-21 09:09:08,539 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF1F0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378FC2700>, deterministic=True)
2025-06-21 09:09:08,540 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF1F0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378FC2700>, deterministic=True) completed
2025-06-21 09:09:08,540 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF1F0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:08,541 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF1F0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:08,541 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,541 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,542 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB31C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:09:08,542 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB31C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:09:08,542 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB31C0>)
2025-06-21 09:09:08,542 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB31C0>) completed
2025-06-21 09:09:08,543 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB31C0>)
2025-06-21 09:09:08,543 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB31C0>) completed
2025-06-21 09:09:08,543 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,544 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,544 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,544 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,545 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB32C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:09:08,545 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB32C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:09:08,545 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB32C0>)
2025-06-21 09:09:08,546 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB32C0>) completed
2025-06-21 09:09:08,546 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB32C0>)
2025-06-21 09:09:08,546 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB32C0>) completed
2025-06-21 09:09:08,547 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,547 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,548 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB3040>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:09:08,548 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB3040>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:09:08,548 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB3040>)
2025-06-21 09:09:08,549 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB3040>) completed
2025-06-21 09:09:08,549 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB3040>)
2025-06-21 09:09:08,549 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB3040>) completed
2025-06-21 09:09:08,550 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,550 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,550 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB3340>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:09:08,551 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB3340>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:09:08,551 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB3340>)
2025-06-21 09:09:08,551 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB3340>) completed
2025-06-21 09:09:08,551 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB3340>)
2025-06-21 09:09:08,552 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB3340>) completed
2025-06-21 09:09:08,552 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,552 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,553 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB3440>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:09:08,553 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB3440>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:09:08,554 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB3440>)
2025-06-21 09:09:08,554 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB3440>) completed
2025-06-21 09:09:08,554 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB3440>)
2025-06-21 09:09:08,555 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB3440>) completed
2025-06-21 09:09:08,555 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,556 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,556 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB35C0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:09:08,556 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB35C0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:09:08,557 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB35C0>)
2025-06-21 09:09:08,557 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB35C0>) completed
2025-06-21 09:09:08,558 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB35C0>)
2025-06-21 09:09:08,558 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB35C0>) completed
2025-06-21 09:09:08,558 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,559 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,559 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB36C0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:09:08,559 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB36C0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:09:08,560 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB36C0>)
2025-06-21 09:09:08,560 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB36C0>) completed
2025-06-21 09:09:08,561 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB36C0>)
2025-06-21 09:09:08,561 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB36C0>) completed
2025-06-21 09:09:08,561 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,562 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,562 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB37C0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:09:08,562 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000024378FB37C0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:09:08,563 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB37C0>)
2025-06-21 09:09:08,563 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000024378FB37C0>) completed
2025-06-21 09:09:08,563 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB37C0>)
2025-06-21 09:09:08,564 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000024378FB37C0>) completed
2025-06-21 09:09:08,564 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,564 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,565 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:08,565 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:08,566 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:09:08,566 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:09:08,567 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:09:08,791 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:09:08,793 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:09:08,999 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:09:08,999 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:09:08,999 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: QN4vO... (truncada por seguridad)
2025-06-21 09:09:08,999 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:09:09,018 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:09:09,018 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x0000024378E01DD0>
2025-06-21 09:09:09,019 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:09:09,019 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:09:09,026 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,027 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,027 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A19F940>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:09:09,028 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A19F940>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:09:09,028 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A19F940>)
2025-06-21 09:09:09,028 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A19F940>) completed
2025-06-21 09:09:09,029 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A19F940>)
2025-06-21 09:09:09,029 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A19F940>) completed
2025-06-21 09:09:09,030 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 3 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:09:09,030 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,031 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,031 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,031 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,032 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:09:09,033 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:09:09,035 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:09:09,037 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378D774C0>
2025-06-21 09:09:09,038 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378D774C0> completed
2025-06-21 09:09:09,039 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFF10>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:09,039 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFF10>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:09,040 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFF10>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:09,040 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFF10>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:09,040 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,041 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,041 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8FC0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:09:09,043 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8FC0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:09:09,044 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8FC0>)
2025-06-21 09:09:09,044 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8FC0>) completed
2025-06-21 09:09:09,045 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,045 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,045 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9340>, 'DELETE FROM trades', ())
2025-06-21 09:09:09,045 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9340>, 'DELETE FROM trades', ()) completed
2025-06-21 09:09:09,046 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9340>)
2025-06-21 09:09:09,046 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9340>) completed
2025-06-21 09:09:09,046 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,047 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,047 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9140>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:09:09,047 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9140>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:09:09,047 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9140>)
2025-06-21 09:09:09,048 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9140>) completed
2025-06-21 09:09:09,048 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,048 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,048 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9040>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:09:09,049 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9040>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:09:09,049 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9040>)
2025-06-21 09:09:09,049 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9040>) completed
2025-06-21 09:09:09,050 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,050 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,050 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C90C0>, 'DELETE FROM opportunities', ())
2025-06-21 09:09:09,051 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C90C0>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:09:09,051 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C90C0>)
2025-06-21 09:09:09,051 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C90C0>) completed
2025-06-21 09:09:09,052 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,052 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,052 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8EC0>, 'DELETE FROM market_data', ())
2025-06-21 09:09:09,052 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8EC0>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:09:09,053 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8EC0>)
2025-06-21 09:09:09,053 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8EC0>) completed
2025-06-21 09:09:09,054 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,055 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,055 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9440>, 'DELETE FROM api_credentials', ())
2025-06-21 09:09:09,055 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9440>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:09:09,055 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9440>)
2025-06-21 09:09:09,057 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9440>) completed
2025-06-21 09:09:09,057 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,059 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,060 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,060 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,060 - aiosqlite - DEBUG - [Thread-5] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDFF10>)
2025-06-21 09:09:09,061 - aiosqlite - DEBUG - [Thread-5] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDFF10>) completed
2025-06-21 09:09:09,062 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378FC3880>
2025-06-21 09:09:09,063 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378FC3880> completed
2025-06-21 09:09:09,064 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:09,064 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:09,064 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF880>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:09,064 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF880>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:09,065 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF880>)
2025-06-21 09:09:09,065 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF880>) completed
2025-06-21 09:09:09,066 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9DC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "66fea2f8-baf9-4b69-8354-4c405f017251", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.061497+00:00"}}', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00'))
2025-06-21 09:09:09,067 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9DC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "66fea2f8-baf9-4b69-8354-4c405f017251", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.061497+00:00"}}', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00')) completed
2025-06-21 09:09:09,068 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9DC0>)
2025-06-21 09:09:09,068 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9DC0>) completed
2025-06-21 09:09:09,069 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF880>)
2025-06-21 09:09:09,069 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF880>) completed
2025-06-21 09:09:09,069 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9D40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "98a84b80-ff79-4479-b87c-c892895627fd", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.061497+00:00"}}', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00'))
2025-06-21 09:09:09,069 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9D40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "98a84b80-ff79-4479-b87c-c892895627fd", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.061497+00:00"}}', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00')) completed
2025-06-21 09:09:09,070 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9D40>)
2025-06-21 09:09:09,070 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9D40>) completed
2025-06-21 09:09:09,070 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF880>)
2025-06-21 09:09:09,071 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF880>) completed
2025-06-21 09:09:09,071 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9CC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "b21977d7-e6db-4287-86cc-e0afe7bc08d1", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.061497+00:00"}}', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00'))
2025-06-21 09:09:09,071 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9CC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "b21977d7-e6db-4287-86cc-e0afe7bc08d1", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.061497+00:00"}}', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00', '2025-06-21T13:09:09.061497+00:00')) completed
2025-06-21 09:09:09,072 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9CC0>)
2025-06-21 09:09:09,072 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9CC0>) completed
2025-06-21 09:09:09,073 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF880>)
2025-06-21 09:09:09,075 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF880>) completed
2025-06-21 09:09:09,075 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF880>)
2025-06-21 09:09:09,076 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF880>) completed
2025-06-21 09:09:09,076 - aiosqlite - DEBUG - [Thread-6] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDF880>)
2025-06-21 09:09:09,076 - aiosqlite - DEBUG - [Thread-6] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDF880>) completed
2025-06-21 09:09:09,077 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:09:09,079 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,080 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,080 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A154C40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.symbol = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'BTCUSDT', 'paper'))
2025-06-21 09:09:09,080 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A154C40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.symbol = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'BTCUSDT', 'paper')) completed
2025-06-21 09:09:09,081 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A154C40>)
2025-06-21 09:09:09,081 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A154C40>) completed
2025-06-21 09:09:09,082 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A154C40>)
2025-06-21 09:09:09,082 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A154C40>) completed
2025-06-21 09:09:09,083 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 1 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:09:09,083 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,083 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,084 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,084 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,085 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:09:09,085 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?symbol=BTCUSDT&user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:09:09,087 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:09:09,089 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378D5FBA0>
2025-06-21 09:09:09,090 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378D5FBA0> completed
2025-06-21 09:09:09,091 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:09,091 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:09,092 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF2E0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:09,092 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF2E0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:09,093 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,093 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,093 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9CC0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:09:09,094 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9CC0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:09:09,094 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9CC0>)
2025-06-21 09:09:09,095 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9CC0>) completed
2025-06-21 09:09:09,095 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,095 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,095 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C86C0>, 'DELETE FROM trades', ())
2025-06-21 09:09:09,097 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C86C0>, 'DELETE FROM trades', ()) completed
2025-06-21 09:09:09,097 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C86C0>)
2025-06-21 09:09:09,097 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C86C0>) completed
2025-06-21 09:09:09,098 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,098 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,098 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C97C0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:09:09,099 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C97C0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:09:09,099 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C97C0>)
2025-06-21 09:09:09,099 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C97C0>) completed
2025-06-21 09:09:09,100 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,100 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,100 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9DC0>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:09:09,100 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9DC0>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:09:09,101 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9DC0>)
2025-06-21 09:09:09,101 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9DC0>) completed
2025-06-21 09:09:09,101 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,101 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,102 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8540>, 'DELETE FROM opportunities', ())
2025-06-21 09:09:09,102 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8540>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:09:09,102 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8540>)
2025-06-21 09:09:09,102 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8540>) completed
2025-06-21 09:09:09,103 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,103 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,103 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8440>, 'DELETE FROM market_data', ())
2025-06-21 09:09:09,103 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8440>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:09:09,104 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8440>)
2025-06-21 09:09:09,105 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8440>) completed
2025-06-21 09:09:09,105 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,106 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,106 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8BC0>, 'DELETE FROM api_credentials', ())
2025-06-21 09:09:09,107 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C8BC0>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:09:09,108 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8BC0>)
2025-06-21 09:09:09,108 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C8BC0>) completed
2025-06-21 09:09:09,108 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,110 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,111 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,111 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,111 - aiosqlite - DEBUG - [Thread-7] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDF2E0>)
2025-06-21 09:09:09,111 - aiosqlite - DEBUG - [Thread-7] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDF2E0>) completed
2025-06-21 09:09:09,112 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378FC2480>
2025-06-21 09:09:09,113 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378FC2480> completed
2025-06-21 09:09:09,114 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF4C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:09,114 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF4C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:09,114 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF4C0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:09,115 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDF4C0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:09,115 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF4C0>)
2025-06-21 09:09:09,115 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF4C0>) completed
2025-06-21 09:09:09,116 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1CAAC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "dcc7259a-fca3-469d-a413-080d4d7d073e", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.112549+00:00"}}', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00'))
2025-06-21 09:09:09,116 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1CAAC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "dcc7259a-fca3-469d-a413-080d4d7d073e", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.112549+00:00"}}', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00')) completed
2025-06-21 09:09:09,117 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1CAAC0>)
2025-06-21 09:09:09,118 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1CAAC0>) completed
2025-06-21 09:09:09,118 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF4C0>)
2025-06-21 09:09:09,118 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF4C0>) completed
2025-06-21 09:09:09,119 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1CAA40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "206fdcff-9cb2-40e9-b63d-ac2700fa8f14", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.112549+00:00"}}', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00'))
2025-06-21 09:09:09,119 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1CAA40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "206fdcff-9cb2-40e9-b63d-ac2700fa8f14", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.112549+00:00"}}', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00')) completed
2025-06-21 09:09:09,119 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1CAA40>)
2025-06-21 09:09:09,119 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1CAA40>) completed
2025-06-21 09:09:09,120 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF4C0>)
2025-06-21 09:09:09,120 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF4C0>) completed
2025-06-21 09:09:09,120 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9540>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "48abea7c-a412-4c60-a691-b4d267ef8525", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.112549+00:00"}}', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00'))
2025-06-21 09:09:09,120 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C9540>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "48abea7c-a412-4c60-a691-b4d267ef8525", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.112549+00:00"}}', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00', '2025-06-21T13:09:09.112549+00:00')) completed
2025-06-21 09:09:09,121 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9540>)
2025-06-21 09:09:09,121 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C9540>) completed
2025-06-21 09:09:09,122 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF4C0>)
2025-06-21 09:09:09,124 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDF4C0>) completed
2025-06-21 09:09:09,124 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF4C0>)
2025-06-21 09:09:09,124 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF4C0>) completed
2025-06-21 09:09:09,125 - aiosqlite - DEBUG - [Thread-8] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDF4C0>)
2025-06-21 09:09:09,125 - aiosqlite - DEBUG - [Thread-8] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDF4C0>) completed
2025-06-21 09:09:09,126 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/portfolio/paper/performance_summary
2025-06-21 09:09:09,127 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,128 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,128 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1CAD40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:09:09,128 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1CAD40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:09:09,129 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A1CAD40>)
2025-06-21 09:09:09,129 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A1CAD40>) completed
2025-06-21 09:09:09,129 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1CAD40>)
2025-06-21 09:09:09,130 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1CAD40>) completed
2025-06-21 09:09:09,130 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 3 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:09:09,130 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,131 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,131 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,131 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,132 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/portfolio/paper/performance_summary - Status: 200
2025-06-21 09:09:09,132 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/portfolio/paper/performance_summary?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:09:09,288 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:09:09,290 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378FC2660>
2025-06-21 09:09:09,292 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378FC2660> completed
2025-06-21 09:09:09,292 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDC4F0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:09,293 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDC4F0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:09,293 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDC4F0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:09,293 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDC4F0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:09,294 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,294 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,295 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537140>, 'DELETE FROM user_configurations', ())
2025-06-21 09:09:09,298 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537140>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:09:09,298 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537140>)
2025-06-21 09:09:09,298 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537140>) completed
2025-06-21 09:09:09,299 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,299 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,300 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E5375C0>, 'DELETE FROM trades', ())
2025-06-21 09:09:09,300 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E5375C0>, 'DELETE FROM trades', ()) completed
2025-06-21 09:09:09,300 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E5375C0>)
2025-06-21 09:09:09,300 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E5375C0>) completed
2025-06-21 09:09:09,300 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,301 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,301 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537540>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:09:09,301 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537540>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:09:09,302 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537540>)
2025-06-21 09:09:09,302 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537540>) completed
2025-06-21 09:09:09,302 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,303 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,303 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E5378C0>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:09:09,304 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E5378C0>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:09:09,304 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E5378C0>)
2025-06-21 09:09:09,304 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E5378C0>) completed
2025-06-21 09:09:09,305 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,305 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,305 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537B40>, 'DELETE FROM opportunities', ())
2025-06-21 09:09:09,307 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537B40>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:09:09,307 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537B40>)
2025-06-21 09:09:09,307 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537B40>) completed
2025-06-21 09:09:09,308 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,308 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,309 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537DC0>, 'DELETE FROM market_data', ())
2025-06-21 09:09:09,309 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E537DC0>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:09:09,310 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537DC0>)
2025-06-21 09:09:09,310 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E537DC0>) completed
2025-06-21 09:09:09,310 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,311 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,311 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53C0C0>, 'DELETE FROM api_credentials', ())
2025-06-21 09:09:09,311 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53C0C0>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:09:09,311 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53C0C0>)
2025-06-21 09:09:09,312 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53C0C0>) completed
2025-06-21 09:09:09,312 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,314 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,315 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,315 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,315 - aiosqlite - DEBUG - [Thread-9] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDC4F0>)
2025-06-21 09:09:09,315 - aiosqlite - DEBUG - [Thread-9] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDC4F0>) completed
2025-06-21 09:09:09,316 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing <function connect.<locals>.connector at 0x0000024378FC22A0>
2025-06-21 09:09:09,317 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation <function connect.<locals>.connector at 0x0000024378FC22A0> completed
2025-06-21 09:09:09,318 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFD30>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True)
2025-06-21 09:09:09,318 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFD30>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000024378D5DEE0>, deterministic=True) completed
2025-06-21 09:09:09,318 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFD30>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:09:09,318 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000024378DDFD30>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:09:09,319 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFD30>)
2025-06-21 09:09:09,319 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFD30>) completed
2025-06-21 09:09:09,319 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53CB40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "ed43ca9d-1d17-4306-9d8c-8694943ae638", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.316264+00:00"}}', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00'))
2025-06-21 09:09:09,320 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53CB40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy", "entryOrder": {"orderId_internal": "ed43ca9d-1d17-4306-9d8c-8694943ae638", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.316264+00:00"}}', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00')) completed
2025-06-21 09:09:09,321 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53CB40>)
2025-06-21 09:09:09,321 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53CB40>) completed
2025-06-21 09:09:09,322 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFD30>)
2025-06-21 09:09:09,322 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFD30>) completed
2025-06-21 09:09:09,323 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53CC40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "f191ab81-9bb4-4c74-ac30-14b737cce594", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.316264+00:00"}}', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00'))
2025-06-21 09:09:09,323 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53CC40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell", "entryOrder": {"orderId_internal": "f191ab81-9bb4-4c74-ac30-14b737cce594", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.316264+00:00"}}', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00')) completed
2025-06-21 09:09:09,323 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53CC40>)
2025-06-21 09:09:09,324 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53CC40>) completed
2025-06-21 09:09:09,324 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFD30>)
2025-06-21 09:09:09,324 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDFD30>) completed
2025-06-21 09:09:09,325 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53CBC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "540e183a-7e59-4467-aa63-d25d02e18b19", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.316264+00:00"}}', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00'))
2025-06-21 09:09:09,325 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437E53CBC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy", "entryOrder": {"orderId_internal": "540e183a-7e59-4467-aa63-d25d02e18b19", "orderCategory": "entry", "type": "market", "status": "filled", "requestedQuantity": 1.0, "executedQuantity": 1.0, "executedPrice": 50000.0, "timestamp": "2025-06-21T13:09:09.316264+00:00"}}', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00', '2025-06-21T13:09:09.316264+00:00')) completed
2025-06-21 09:09:09,325 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53CBC0>)
2025-06-21 09:09:09,325 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437E53CBC0>) completed
2025-06-21 09:09:09,325 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDFD30>)
2025-06-21 09:09:09,328 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000024378DDFD30>) completed
2025-06-21 09:09:09,329 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDFD30>)
2025-06-21 09:09:09,329 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDFD30>) completed
2025-06-21 09:09:09,329 - aiosqlite - DEBUG - [Thread-10] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDFD30>)
2025-06-21 09:09:09,330 - aiosqlite - DEBUG - [Thread-10] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000024378DDFD30>) completed
2025-06-21 09:09:09,331 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/portfolio/paper/performance_summary
2025-06-21 09:09:09,333 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,333 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,334 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C93C0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:09:09.330300'))
2025-06-21 09:09:09,334 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002437A1C93C0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:09:09.330300')) completed
2025-06-21 09:09:09,335 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A1C93C0>)
2025-06-21 09:09:09,335 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002437A1C93C0>) completed
2025-06-21 09:09:09,335 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C93C0>)
2025-06-21 09:09:09,335 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002437A1C93C0>) completed
2025-06-21 09:09:09,336 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:09:09,336 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,336 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,337 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>)
2025-06-21 09:09:09,337 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000024378DDF1F0>) completed
2025-06-21 09:09:09,337 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/portfolio/paper/performance_summary - Status: 200
2025-06-21 09:09:09,338 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/portfolio/paper/performance_summary?start_date=2025-06-22T13%3A09%3A09.330300%2B00%3A00&user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:09:09,339 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:09:09,340 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp0cgprlzy. Reintentando en 0.2s...
2025-06-21 09:09:09,541 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp0cgprlzy. Reintentando en 0.2s...
2025-06-21 09:09:09,743 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp0cgprlzy. Reintentando en 0.2s...
2025-06-21 09:09:09,944 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp0cgprlzy. Reintentando en 0.2s...
2025-06-21 09:09:10,145 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp0cgprlzy. Reintentando en 0.2s...
2025-06-21 09:09:10,347 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmp0cgprlzy después de 5 intentos.
2025-06-21 09:10:27,789 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:10:27,789 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:10:27,811 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:10:27,988 - qasync - INFO - [MainThread] - __init__.py:57 - Forcing use of PySide6 as Qt Implementation
2025-06-21 09:10:28,227 - matplotlib - DEBUG - [MainThread] - __init__.py:342 - matplotlib data path: C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\matplotlib\mpl-data
2025-06-21 09:10:28,231 - matplotlib - DEBUG - [MainThread] - __init__.py:342 - CONFIGDIR=C:\Users\zamor\.matplotlib
2025-06-21 09:10:28,232 - matplotlib - DEBUG - [MainThread] - __init__.py:1557 - interactive is False
2025-06-21 09:10:28,232 - matplotlib - DEBUG - [MainThread] - __init__.py:1558 - platform is win32
2025-06-21 09:10:28,290 - matplotlib - DEBUG - [MainThread] - __init__.py:342 - CACHEDIR=C:\Users\zamor\.matplotlib
2025-06-21 09:10:28,295 - matplotlib.font_manager - DEBUG - [MainThread] - font_manager.py:1635 - Using fontManager instance from C:\Users\zamor\.matplotlib\fontlist-v390.json
2025-06-21 09:10:28,913 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:10:28,914 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:10:28,914 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:10:28,914 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///./ultibot_local.db
2025-06-21 09:10:28,946 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:10:29,328 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:10:29,328 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:29,329 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:29,329 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:10:29,345 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:29,345 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001DF6B3C8F90>
2025-06-21 09:10:29,345 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:10:29,345 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:10:29,345 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: None
2025-06-21 09:10:29,345 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001DF6B3C8F90>
2025-06-21 09:10:29,356 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:10:29,650 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:10:29,651 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:29,651 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001DF6B3C8F90>
2025-06-21 09:10:29,655 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:10:29,669 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:10:29,670 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: OperatingMode.REAL
2025-06-21 09:10:29,670 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001DF6B3C8F90>
2025-06-21 09:10:29,674 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:10:29,688 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:10:29,688 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: None
2025-06-21 09:10:29,689 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001DF6B3C8F90>
2025-06-21 09:10:29,693 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:10:29,710 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:10:29,710 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:29,710 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001DF6B3C8F90>
2025-06-21 09:10:29,714 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:10:29,726 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:10:29,727 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 422
2025-06-21 09:10:29,733 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/performance/strategies
2025-06-21 09:10:29,734 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 00000000-0000-0000-0000-000000000001, mode_filter: None
2025-06-21 09:10:29,734 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001DF6B3C8F90>
2025-06-21 09:10:29,737 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/performance/strategies - Status: 500
2025-06-21 09:10:29,838 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:10:29,843 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:10:29,844 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:10:29,870 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:10:29,871 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:10:29,872 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:10:29,882 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:29,882 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 200
2025-06-21 09:10:29,883 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:10:29,884 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:10:29,905 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:10:29,905 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:10:29,907 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:10:29,916 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:29,916 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 200
2025-06-21 09:10:29,941 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/config
2025-06-21 09:10:29,942 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-21 09:10:29,943 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:10:29,951 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:29,951 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 200
2025-06-21 09:10:29,975 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: PATCH /api/v1/config
2025-06-21 09:10:29,977 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: PATCH /api/v1/config - Status: 422
2025-06-21 09:10:29,987 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity b7ca8c3e-162b-4d2b-956b-5bdef60e0244
2025-06-21 09:10:29,988 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:152 - User configuration saved after initializing last_daily_reset for user 866b8b63-d572-4603-8cbc-0b1e5139afc3.
2025-06-21 09:10:29,988 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'test_strategy' as context for confirmed opportunity b7ca8c3e-162b-4d2b-956b-5bdef60e0244
2025-06-21 09:10:29,989 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 5578ed2f-3d17-464c-9682-50879fc6df0e from decision 8e17f08c-d414-4322-8c0f-360c38d38d97
2025-06-21 09:10:29,990 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 5578ed2f-3d17-464c-9682-50879fc6df0e persisted before execution.
2025-06-21 09:10:29,991 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 5578ed2f-3d17-464c-9682-50879fc6df0e from confirmed opportunity.
2025-06-21 09:10:29,992 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:10:29,993 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 5578ed2f-3d17-464c-9682-50879fc6df0e. OCO List ID: oco_list_123
2025-06-21 09:10:29,993 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:348 - Updated daily_capital_risked_usd for user 866b8b63-d572-4603-8cbc-0b1e5139afc3 to 200.0000000000000000000000000.
2025-06-21 09:10:29,993 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity b7ca8c3e-162b-4d2b-956b-5bdef60e0244 status to converted_to_trade_real: Trade 5578ed2f-3d17-464c-9682-50879fc6df0e executed based on user confirmation.
2025-06-21 09:10:29,994 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity b7ca8c3e-162b-4d2b-956b-5bdef60e0244
2025-06-21 09:10:30,002 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity f9b42473-69f5-4fea-9339-6e1c13187bf7
2025-06-21 09:10:30,002 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:190 - Límite de riesgo de capital diario excedido. Límite: 5000.00, Arriesgado: 4800.0, Nuevo Trade: 300.000
2025-06-21 09:10:30,002 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity f9b42473-69f5-4fea-9339-6e1c13187bf7 status to error_in_processing: Límite de riesgo de capital diario excedido. Límite: 5000.00, Arriesgado: 4800.0, Nuevo Trade: 300.000
2025-06-21 09:10:30,003 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity f9b42473-69f5-4fea-9339-6e1c13187bf7
2025-06-21 09:10:30,018 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 80b69468-8bf0-4800-8bcf-0121290d02b7
2025-06-21 09:10:30,018 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:143 - Daily capital reset triggered for user 28a71b34-f4f0-4645-a65b-639d54984b8f. Resetting daily_capital_risked_usd.
2025-06-21 09:10:30,018 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:147 - User configuration saved after daily capital reset for user 28a71b34-f4f0-4645-a65b-639d54984b8f.
2025-06-21 09:10:30,019 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'test_strategy' as context for confirmed opportunity 80b69468-8bf0-4800-8bcf-0121290d02b7
2025-06-21 09:10:30,019 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 10ed7f34-40b0-41f0-a745-f8c49a11cb79 from decision 360fedff-c601-4b86-aeb0-f46cfdd3b408
2025-06-21 09:10:30,020 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 10ed7f34-40b0-41f0-a745-f8c49a11cb79 persisted before execution.
2025-06-21 09:10:30,020 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 10ed7f34-40b0-41f0-a745-f8c49a11cb79 from confirmed opportunity.
2025-06-21 09:10:30,021 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:10:30,021 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 10ed7f34-40b0-41f0-a745-f8c49a11cb79. OCO List ID: oco_reset_test
2025-06-21 09:10:30,021 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:348 - Updated daily_capital_risked_usd for user 28a71b34-f4f0-4645-a65b-639d54984b8f to 100.000.
2025-06-21 09:10:30,022 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 80b69468-8bf0-4800-8bcf-0121290d02b7 status to converted_to_trade_real: Trade 10ed7f34-40b0-41f0-a745-f8c49a11cb79 executed based on user confirmation.
2025-06-21 09:10:30,024 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 80b69468-8bf0-4800-8bcf-0121290d02b7
2025-06-21 09:10:30,058 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:10:30,062 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:79 - Error al obtener trades cerrados para usuario 00000000-0000-0000-0000-000000000001: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,068 - ultibot_backend.api.v1.endpoints.trades - ERROR - [MainThread] - trades.py:200 - Error al obtener historial de paper trading: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\api\v1\endpoints\trades.py", line 166, in get_paper_trading_history
    trades = await report_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 80, in get_closed_trades
    raise ReportError(f"Error al obtener historial de trades: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,070 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 500
2025-06-21 09:10:30,111 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:10:30,115 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:79 - Error al obtener trades cerrados para usuario 00000000-0000-0000-0000-000000000001: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.symbol = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'BTCUSDT', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.symbol = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'BTCUSDT', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,117 - ultibot_backend.api.v1.endpoints.trades - ERROR - [MainThread] - trades.py:200 - Error al obtener historial de paper trading: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.symbol = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'BTCUSDT', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.symbol = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'BTCUSDT', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\api\v1\endpoints\trades.py", line 166, in get_paper_trading_history
    trades = await report_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 80, in get_closed_trades
    raise ReportError(f"Error al obtener historial de trades: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.symbol = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'BTCUSDT', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,119 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 500
2025-06-21 09:10:30,161 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/portfolio/paper/performance_summary
2025-06-21 09:10:30,165 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:79 - Error al obtener trades cerrados para usuario 00000000-0000-0000-0000-000000000001: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,167 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:194 - Error al calcular métricas de rendimiento para usuario 00000000-0000-0000-0000-000000000001: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 105, in calculate_performance_metrics
    trades = await self.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 80, in get_closed_trades
    raise ReportError(f"Error al obtener historial de trades: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,169 - ultibot_backend.api.v1.endpoints.portfolio - ERROR - [MainThread] - portfolio.py:202 - Error al calcular métricas de rendimiento: Error al calcular métricas de rendimiento: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 105, in calculate_performance_metrics
    trades = await self.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 80, in get_closed_trades
    raise ReportError(f"Error al obtener historial de trades: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\api\v1\endpoints\portfolio.py", line 192, in get_paper_trading_performance
    metrics = await report_service.calculate_performance_metrics(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 195, in calculate_performance_metrics
    raise ReportError(f"Error al calcular métricas de rendimiento: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al calcular métricas de rendimiento: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,171 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/portfolio/paper/performance_summary - Status: 500
2025-06-21 09:10:30,215 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/portfolio/paper/performance_summary
2025-06-21 09:10:30,220 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:79 - Error al obtener trades cerrados para usuario 00000000-0000-0000-0000-000000000001: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,221 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:194 - Error al calcular métricas de rendimiento para usuario 00000000-0000-0000-0000-000000000001: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 105, in calculate_performance_metrics
    trades = await self.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 80, in get_closed_trades
    raise ReportError(f"Error al obtener historial de trades: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,223 - ultibot_backend.api.v1.endpoints.portfolio - ERROR - [MainThread] - portfolio.py:202 - Error al calcular métricas de rendimiento: Error al calcular métricas de rendimiento: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.OperationalError: no such column: trades.status

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 451, in get_closed_trades
    result = await session.execute(query)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 149, in execute
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 131, in execute
    self.await_(_cursor.execute(operation, parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 40, in execute
    await self._execute(self._cursor.execute, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 105, in calculate_performance_metrics
    trades = await self.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 80, in get_closed_trades
    raise ReportError(f"Error al obtener historial de trades: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\api\v1\endpoints\portfolio.py", line 192, in get_paper_trading_performance
    metrics = await report_service.calculate_performance_metrics(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 195, in calculate_performance_metrics
    raise ReportError(f"Error al calcular métricas de rendimiento: {str(e)}")
ultibot_backend.core.exceptions.ReportError: Error al calcular métricas de rendimiento: Error al obtener historial de trades: (sqlite3.OperationalError) no such column: trades.status
[SQL: SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at 
FROM trades 
WHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ? AND trades.closed_at >= ?]
[parameters: ('00000000-0000-0000-0000-000000000001', 'closed', 'paper', '2025-06-22 13:10:30.215862')]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-06-21 09:10:30,226 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/portfolio/paper/performance_summary - Status: 500
2025-06-21 09:10:30,464 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 25ecb67b-532b-441b-8c5a-27cdc39dfa91 for symbol BTCUSDT
2025-06-21 09:10:30,466 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: d10dbfdc-6395-411e-ab9f-78d123d1da7b
2025-06-21 09:10:30,466 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 0fe6660c-3f7a-40b8-826e-83e2c5b8458a can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:30,474 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 99aaea77-4cc3-45c4-9a3f-a8b59b180ef1 for symbol BTCUSDT
2025-06-21 09:10:30,475 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 7510f6fa-bbc5-475d-9c74-811e0f414c64 can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:30,484 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 428d5dea-f119-47a3-a779-b971538ae099 for symbol ETHUSDT
2025-06-21 09:10:30,484 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 2550e74f-ffd4-4486-84cf-1d05187b89e5
2025-06-21 09:10:30,486 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity 428d5dea-f119-47a3-a779-b971538ae099 with symbol ETHUSDT.
2025-06-21 09:10:30,645 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 7c980956-ca6a-440a-bbd3-7f1140b6c023 for symbol BTCUSDT
2025-06-21 09:10:30,645 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: a14f04af-47a4-4ec5-ad47-48858365b70c
2025-06-21 09:10:30,648 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity 7c980956-ca6a-440a-bbd3-7f1140b6c023 with symbol BTCUSDT.
2025-06-21 09:10:30,662 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 24348e56-fede-4e9c-b0b9-90840e5e6f18 for symbol BTCUSDT
2025-06-21 09:10:30,663 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 986cff3f-5680-45f3-81c0-ec02672f9d79
2025-06-21 09:10:30,664 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity 24348e56-fede-4e9c-b0b9-90840e5e6f18 with symbol BTCUSDT.
2025-06-21 09:10:30,679 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity c1ed37f5-bacd-4443-b92d-ed71208fc169 for symbol BTCUSDT
2025-06-21 09:10:30,679 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 8ed6d33b-ca54-47be-9535-93805dcd7292
2025-06-21 09:10:30,681 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:589 - No active and applicable strategies found for opportunity c1ed37f5-bacd-4443-b92d-ed71208fc169 with symbol BTCUSDT.
2025-06-21 09:10:30,698 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 5453989b-b3e8-462c-9f0e-0c6e32278ee8 from decision 8062c3c4-daf0-4a23-8b45-c404ca2bd45a
2025-06-21 09:10:30,699 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 5453989b-b3e8-462c-9f0e-0c6e32278ee8 persisted before execution.
2025-06-21 09:10:30,705 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade d16125cd-3766-4770-875a-30cb79448739 from decision 0302ebc2-4b44-4d3c-80c9-4da789d3a04f
2025-06-21 09:10:30,705 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade d16125cd-3766-4770-875a-30cb79448739 persisted before execution.
2025-06-21 09:10:30,707 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade a4717fff-33e4-4b7e-a3bc-0ce6d38965c9 from decision 0302ebc2-4b44-4d3c-80c9-4da789d3a04f
2025-06-21 09:10:30,707 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade a4717fff-33e4-4b7e-a3bc-0ce6d38965c9 persisted before execution.
2025-06-21 09:10:30,733 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:30,733 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:30,744 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:30,744 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:30,748 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:30,749 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 1d0d6095-7029-4be1-b3fb-dc8e36a02627
2025-06-21 09:10:30,753 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 2a2897a5-ada3-4019-a603-6930a7b545ba. Creando y guardando configuración por defecto.
2025-06-21 09:10:30,757 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:30,760 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 2a2897a5-ada3-4019-a603-6930a7b545ba. Using default values.
2025-06-21 09:10:30,760 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 2a2897a5-ada3-4019-a603-6930a7b545ba with capital: 10000.0
2025-06-21 09:10:30,761 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:10:30,761 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:10:30,761 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'AI-Enhanced Scalping' as context for confirmed opportunity 1d0d6095-7029-4be1-b3fb-dc8e36a02627
2025-06-21 09:10:30,762 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 22bb791d-9124-47e9-82b6-354289059ea6 from decision c26be85b-9662-4b3d-8493-11f5e3764709
2025-06-21 09:10:30,762 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 22bb791d-9124-47e9-82b6-354289059ea6 persisted before execution.
2025-06-21 09:10:30,763 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 22bb791d-9124-47e9-82b6-354289059ea6 from confirmed opportunity.
2025-06-21 09:10:30,763 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:10:30,764 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 22bb791d-9124-47e9-82b6-354289059ea6. OCO List ID: <MagicMock id='2059086459088'>
2025-06-21 09:10:30,768 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None), (UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None), (UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:10:30,771 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity 1d0d6095-7029-4be1-b3fb-dc8e36a02627: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None), (UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:10:30,773 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 1d0d6095-7029-4be1-b3fb-dc8e36a02627 status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:10:30,774 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity 1d0d6095-7029-4be1-b3fb-dc8e36a02627: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None), (UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (917 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None), (UUID('22bb791d-9124-47e9-82b6-354289059ea6'), '1254f847-dac9-466d-84f3-543c18c7a36e', '{"id":"22bb791d-9124-47e9-82b6-354289059ea6","user_id":"1254f847-dac9-466d-84f3-543c18c7a36e","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1135 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.762348","opened_at":"2025-06-21T13:10:30.762348","updated_at":"2025-06-21T13:10:30.762348","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.762348', '2025-06-21 13:10:30.762348', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:10:30,786 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:30,787 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:30,810 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:30,810 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:30,819 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:30,819 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:30,821 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:30,823 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:30,824 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:30,847 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:30,848 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:30,858 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:30,858 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:30,861 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:30,863 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity bbdead5a-3095-4db2-a177-57911c4e5431 for symbol BTC/USDT
2025-06-21 09:10:30,866 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 4c768f8f-2a05-4fae-896c-db6deafb2596. Creando y guardando configuración por defecto.
2025-06-21 09:10:30,869 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:30,871 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:657 - AI profile 'ai-profile-scalping-1' for strategy 6bf04e19-71d9-4333-8d76-2204b6a0f53d not found. Skipping AI analysis.
2025-06-21 09:10:30,871 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 6bf04e19-71d9-4333-8d76-2204b6a0f53d can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:30,871 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity bbdead5a-3095-4db2-a177-57911c4e5431 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:30,880 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity bbdead5a-3095-4db2-a177-57911c4e5431
2025-06-21 09:10:30,881 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:30,881 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:30,907 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:30,907 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:30,917 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:30,917 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:30,920 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:30,921 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity b04bbef1-4abb-42a8-9e98-f323f67d3458
2025-06-21 09:10:30,925 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 09643074-d244-4c98-b809-3d613e6e6077. Creando y guardando configuración por defecto.
2025-06-21 09:10:30,928 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:30,931 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 09643074-d244-4c98-b809-3d613e6e6077. Using default values.
2025-06-21 09:10:30,931 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 09643074-d244-4c98-b809-3d613e6e6077 with capital: 10000.0
2025-06-21 09:10:30,932 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:10:30,932 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:10:30,932 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'Autonomous Scalping' as context for confirmed opportunity b04bbef1-4abb-42a8-9e98-f323f67d3458
2025-06-21 09:10:30,933 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 733050e9-4301-46c8-a25e-fcbc2fb59bb7 from decision a7fac080-7de5-45f9-81ff-401515a4d9e7
2025-06-21 09:10:30,933 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 733050e9-4301-46c8-a25e-fcbc2fb59bb7 persisted before execution.
2025-06-21 09:10:30,933 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 733050e9-4301-46c8-a25e-fcbc2fb59bb7 from confirmed opportunity.
2025-06-21 09:10:30,934 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:10:30,935 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 733050e9-4301-46c8-a25e-fcbc2fb59bb7. OCO List ID: <MagicMock id='2059117056208'>
2025-06-21 09:10:30,939 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None), (UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None), (UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:10:30,941 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity b04bbef1-4abb-42a8-9e98-f323f67d3458: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None), (UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:10:30,943 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity b04bbef1-4abb-42a8-9e98-f323f67d3458 status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:10:30,944 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity b04bbef1-4abb-42a8-9e98-f323f67d3458: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None), (UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None), (UUID('733050e9-4301-46c8-a25e-fcbc2fb59bb7'), 'e938b5ad-791c-426f-9e1b-ce4138e62adf', '{"id":"733050e9-4301-46c8-a25e-fcbc2fb59bb7","user_id":"e938b5ad-791c-426f-9e1b-ce4138e62adf","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:30.933457","opened_at":"2025-06-21T13:10:30.933457","updated_at":"2025-06-21T13:10:30.933457","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:30.933457', '2025-06-21 13:10:30.933457', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:10:30,954 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:30,955 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:30,981 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:30,981 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:30,990 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:30,990 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:30,993 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:30,995 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity a88f76f5-185c-4795-86a1-ca047b1473b0
2025-06-21 09:10:30,998 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id ce068265-eaa1-4954-a678-9914276b6f6b. Creando y guardando configuración por defecto.
2025-06-21 09:10:31,001 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:31,003 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for ce068265-eaa1-4954-a678-9914276b6f6b. Using default values.
2025-06-21 09:10:31,004 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for ce068265-eaa1-4954-a678-9914276b6f6b with capital: 10000.0
2025-06-21 09:10:31,004 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:10:31,005 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:10:31,005 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'AI-Enhanced Scalping' as context for confirmed opportunity a88f76f5-185c-4795-86a1-ca047b1473b0
2025-06-21 09:10:31,005 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 14c8cf7c-0f83-413a-9ecb-b04451c8c70c from decision f6b1927e-cdae-424d-b5e9-1de5d83faefc
2025-06-21 09:10:31,006 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 14c8cf7c-0f83-413a-9ecb-b04451c8c70c persisted before execution.
2025-06-21 09:10:31,006 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 14c8cf7c-0f83-413a-9ecb-b04451c8c70c from confirmed opportunity.
2025-06-21 09:10:31,008 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:10:31,009 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 14c8cf7c-0f83-413a-9ecb-b04451c8c70c. OCO List ID: <MagicMock id='2059117501648'>
2025-06-21 09:10:31,013 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None), (UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None), (UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:10:31,015 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity a88f76f5-185c-4795-86a1-ca047b1473b0: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None), (UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:10:31,016 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity a88f76f5-185c-4795-86a1-ca047b1473b0 status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:10:31,017 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity a88f76f5-185c-4795-86a1-ca047b1473b0: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None), (UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (916 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None), (UUID('14c8cf7c-0f83-413a-9ecb-b04451c8c70c'), 'b294f589-6f04-428c-9482-f5add12d666b', '{"id":"14c8cf7c-0f83-413a-9ecb-b04451c8c70c","user_id":"b294f589-6f04-428c-9482-f5add12d666b","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1134 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.005530","opened_at":"2025-06-21T13:10:31.005530","updated_at":"2025-06-21T13:10:31.005530","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.005530', '2025-06-21 13:10:31.005530', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:10:31,027 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:31,029 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:31,050 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:31,051 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:31,061 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:31,061 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:31,064 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:31,065 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:132 - Executing trade directly from confirmed opportunity 519c336d-58d7-4e98-b697-6522e647e885
2025-06-21 09:10:31,068 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id e367fe76-d02b-4cfe-bf84-0528d681dced. Creando y guardando configuración por defecto.
2025-06-21 09:10:31,070 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:31,073 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for e367fe76-d02b-4cfe-bf84-0528d681dced. Using default values.
2025-06-21 09:10:31,073 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for e367fe76-d02b-4cfe-bf84-0528d681dced with capital: 10000.0
2025-06-21 09:10:31,074 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:10:31,074 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:193 - Último precio de BTC/USDT: 50000.0
2025-06-21 09:10:31,074 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:205 - Using strategy 'Day Trading Strategy' as context for confirmed opportunity 519c336d-58d7-4e98-b697-6522e647e885
2025-06-21 09:10:31,075 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade 72dd9946-8619-4d91-87ce-92cfd3c5529a from decision df56f328-d199-4629-8f5a-f5e106554dfd
2025-06-21 09:10:31,075 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade 72dd9946-8619-4d91-87ce-92cfd3c5529a persisted before execution.
2025-06-21 09:10:31,076 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:270 - Successfully executed trade 72dd9946-8619-4d91-87ce-92cfd3c5529a from confirmed opportunity.
2025-06-21 09:10:31,076 - ultibot_backend.services.trading_engine_service - DEBUG - [MainThread] - trading_engine_service.py:294 - Trade side: buy, OCO side calculated: sell
2025-06-21 09:10:31,078 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:310 - Successfully created OCO order for trade 72dd9946-8619-4d91-87ce-92cfd3c5529a. OCO List ID: <MagicMock id='2059117915792'>
2025-06-21 09:10:31,081 - ultibot_backend.services.config_service - ERROR - [MainThread] - config_service.py:119 - Error al guardar la configuración: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None), (UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None), (UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-06-21 09:10:31,083 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:358 - Failed to execute trade for opportunity 519c336d-58d7-4e98-b697-6522e647e885: No se pudo guardar la configuración.
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlite3.IntegrityError: UNIQUE constraint failed: trades.id

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 115, in save_user_configuration
    await self.persistence_service.upsert_user_configuration(config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 228, in upsert_user_configuration
    result = await session.execute(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\context.py", line 577, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3065, in _autoflush
    raise e.with_traceback(sys.exc_info()[2])
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1048, in _emit_insert_statements
    result = connection.execute(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
           ^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1932, in _exec_single_context
    self.dialect.do_executemany(
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 940, in do_executemany
    cursor.executemany(statement, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 160, in executemany
    self._adapt_connection._handle_exception(error)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 300, in _handle_exception
    raise error
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\dialects\sqlite\aiosqlite.py", line 154, in executemany
    self.await_(_cursor.executemany(operation, seq_of_parameters))
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 47, in executemany
    await self._execute(self._cursor.executemany, sql, parameters)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\cursor.py", line 32, in _execute
    return await self._conn._execute(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 122, in _execute
    return await future
           ^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\aiosqlite\core.py", line 105, in run
    result = function()
             ^^^^^^^^^^
sqlalchemy.exc.IntegrityError: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None), (UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 347, in execute_trade_from_confirmed_opportunity
    await self.configuration_service.save_user_configuration(user_config)
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\config_service.py", line 120, in save_user_configuration
    raise ConfigurationError("No se pudo guardar la configuración.") from e
ultibot_backend.core.exceptions.ConfigurationError: No se pudo guardar la configuración.
2025-06-21 09:10:31,086 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 519c336d-58d7-4e98-b697-6522e647e885 status to error_in_processing: Failed to execute trade: No se pudo guardar la configuración.
2025-06-21 09:10:31,086 - ultibot_backend.services.trading_engine_service - ERROR - [MainThread] - trading_engine_service.py:540 - Failed to persist status update for opportunity 519c336d-58d7-4e98-b697-6522e647e885: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None), (UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_engine_service.py", line 533, in _update_opportunity_status
    await self.persistence_service.update_opportunity_status(
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\adapters\persistence_service.py", line 390, in update_opportunity_status
    await session.execute(stmt)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 190, in greenlet_spawn
    result = context.switch(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2230, in _execute_internal
    ) = compile_state_cls.orm_pre_session_exec(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 728, in orm_pre_session_exec
    session._autoflush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 3054, in _autoflush
    self.flush()
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4437, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 103, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "C:\Users\zamor\UltiBotInversiones\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 973, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (raised as a result of Query-invoked autoflush; consider using a session.no_autoflush block if this flush is occurring prematurely)
(sqlite3.IntegrityError) UNIQUE constraint failed: trades.id
[SQL: INSERT INTO trades (id, user_id, data, status, position_status, mode, symbol, created_at, updated_at, closed_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [(UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (915 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'pending_entry_conditions', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None), (UUID('72dd9946-8619-4d91-87ce-92cfd3c5529a'), '868a974c-2ecc-48e8-9da9-03698a2f2994', '{"id":"72dd9946-8619-4d91-87ce-92cfd3c5529a","user_id":"868a974c-2ecc-48e8-9da9-03698a2f2994","mode":"real","symbol":"BTC/USDT","side":"buy","entryOr ... (1133 characters truncated) ... ts":[],"created_at":"2025-06-21T13:10:31.075500","opened_at":"2025-06-21T13:10:31.075500","updated_at":"2025-06-21T13:10:31.075500","closed_at":null}', 'PENDING', 'open', 'real', 'BTC/USDT', '2025-06-21 13:10:31.075500', '2025-06-21 13:10:31.075500', None)]]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
2025-06-21 09:10:31,095 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:31,096 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:31,119 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:31,119 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:31,130 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:31,130 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:31,133 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:31,135 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade d7acb242-c0d7-415c-99b0-167df871ca6a from decision 4f47c364-6b38-4c0a-9e7c-e9f0e57ffa8b
2025-06-21 09:10:31,135 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade d7acb242-c0d7-415c-99b0-167df871ca6a persisted before execution.
2025-06-21 09:10:31,136 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:31,137 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:31,167 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:31,167 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:31,177 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:31,178 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:31,181 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:31,182 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:443 - Created trade dd101087-e1ba-46be-9b13-cb40e182906e from decision a8fed7c8-7922-4a33-9946-98c6ff8942dc
2025-06-21 09:10:31,182 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:446 - Trade dd101087-e1ba-46be-9b13-cb40e182906e persisted before execution.
2025-06-21 09:10:31,183 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:31,184 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:31,211 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:31,211 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:31,220 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:76 - No configuration found for 00000000-0000-0000-0000-000000000001. Using default values.
2025-06-21 09:10:31,220 - ultibot_backend.services.portfolio_service - INFO - [MainThread] - portfolio_service.py:78 - Paper trading portfolio initialized for 00000000-0000-0000-0000-000000000001 with capital: 10000.0
2025-06-21 09:10:31,223 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:31,225 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:31,225 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:32,218 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,219 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hzQPf... (truncada por seguridad)
2025-06-21 09:10:32,241 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:10:32,243 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:303 - MarketDataService: Iniciando cierre...
2025-06-21 09:10:32,244 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:316 - MarketDataService: Cierre completado.
2025-06-21 09:10:32,249 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:10:32,252 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:79 - No se encontró configuración para el user_id 00000000-0000-0000-0000-000000000001. Creando y guardando configuración por defecto.
2025-06-21 09:10:32,253 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:32,256 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:116 - Configuración guardada exitosamente.
2025-06-21 09:10:32,263 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:10:32,265 - ultibot_backend.services.config_service - INFO - [MainThread] - config_service.py:70 - Configuración de usuario cargada exitosamente para el user_id: 00000000-0000-0000-0000-000000000001
2025-06-21 09:10:32,268 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,268 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,271 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,272 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,273 - ultibot_backend.services.credential_service - WARNING - [MainThread] - credential_service.py:56 - Advertencia: Token de encriptación inválido. La desencriptación falló.
2025-06-21 09:10:32,277 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,277 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,284 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,285 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,293 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,293 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,297 - ultibot_backend.services.credential_service - WARNING - [MainThread] - credential_service.py:56 - Advertencia: Token de encriptación inválido. La desencriptación falló.
2025-06-21 09:10:32,300 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,301 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,304 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:285 - Verificación de Binance BINANCE_SPOT exitosa.
2025-06-21 09:10:32,310 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,310 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,313 - ultibot_backend.services.credential_service - ERROR - [MainThread] - credential_service.py:314 - Error de Binance API durante la verificación: Binance Down
2025-06-21 09:10:32,318 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,318 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,321 - ultibot_backend.services.credential_service - WARNING - [MainThread] - credential_service.py:56 - Advertencia: Token de encriptación inválido. La desencriptación falló.
2025-06-21 09:10:32,327 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:10:32,327 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 5bAn2... (truncada por seguridad)
2025-06-21 09:10:32,332 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:240 - Verificación de Telegram exitosa.
2025-06-21 09:10:32,337 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:73 - Conexión con Binance exitosa.
2025-06-21 09:10:32,343 - ultibot_backend.services.market_data_service - WARNING - [MainThread] - market_data_service.py:53 - Credenciales de Binance no encontradas. Por favor, configúrelas.
2025-06-21 09:10:32,348 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:70 - Fallo en la verificación de conexión con Binance. Revise sus credenciales y permisos.
2025-06-21 09:10:32,352 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:78 - Error al acceder a las credenciales de Binance: Decryption failed
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\market_data_service.py", line 46, in get_binance_connection_status
    binance_credential = await self.credential_service.get_credential(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 2237, in _execute_mock_call
    raise effect
ultibot_backend.core.exceptions.CredentialError: Decryption failed
2025-06-21 09:10:32,358 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:82 - Error de la API de Binance: API unavailable
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\market_data_service.py", line 62, in get_binance_connection_status
    is_connected = await self.credential_service.verify_credential(binance_credential)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 2237, in _execute_mock_call
    raise effect
ultibot_backend.core.exceptions.BinanceAPIError: API unavailable
2025-06-21 09:10:32,363 - ultibot_backend.services.market_data_service - INFO - [MainThread] - market_data_service.py:119 - Balances de Binance obtenidos.
2025-06-21 09:10:32,373 - ultibot_backend.services.market_data_service - ERROR - [MainThread] - market_data_service.py:122 - Error de la API de Binance al obtener balances: Failed to fetch balances
2025-06-21 09:10:32,376 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059128589520'>
2025-06-21 09:10:32,377 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: None
2025-06-21 09:10:32,377 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059128589520'>
2025-06-21 09:10:32,378 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 13646ed1-f7d0-4add-8a03-fa77139268bb with mode_filter: None
2025-06-21 09:10:32,381 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059128566928'>
2025-06-21 09:10:32,382 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: None
2025-06-21 09:10:32,382 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059128566928'>
2025-06-21 09:10:32,383 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 13646ed1-f7d0-4add-8a03-fa77139268bb with mode_filter: None
2025-06-21 09:10:32,385 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059128589840'>
2025-06-21 09:10:32,387 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,387 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059128589840'>
2025-06-21 09:10:32,387 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,391 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059128607120'>
2025-06-21 09:10:32,392 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,393 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059128607120'>
2025-06-21 09:10:32,393 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,395 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059099157648'>
2025-06-21 09:10:32,398 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.REAL
2025-06-21 09:10:32,398 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059099157648'>
2025-06-21 09:10:32,398 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,401 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059128609936'>
2025-06-21 09:10:32,402 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,402 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059128609936'>
2025-06-21 09:10:32,403 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,405 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059098793808'>
2025-06-21 09:10:32,408 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: None
2025-06-21 09:10:32,408 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059098793808'>
2025-06-21 09:10:32,408 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 2 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,411 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059098339216'>
2025-06-21 09:10:32,413 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,413 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059098339216'>
2025-06-21 09:10:32,413 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,416 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059098958288'>
2025-06-21 09:10:32,418 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,418 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059098958288'>
2025-06-21 09:10:32,419 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 13646ed1-f7d0-4add-8a03-fa77139268bb with mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,422 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059098961680'>
2025-06-21 09:10:32,424 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,425 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059098961680'>
2025-06-21 09:10:32,425 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:140 - No closed trades found for user 13646ed1-f7d0-4add-8a03-fa77139268bb with mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,429 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059117784208'>
2025-06-21 09:10:32,432 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,432 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059117784208'>
2025-06-21 09:10:32,432 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,435 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059098802256'>
2025-06-21 09:10:32,436 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,436 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059098802256'>
2025-06-21 09:10:32,436 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,440 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059098446160'>
2025-06-21 09:10:32,442 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,443 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059098446160'>
2025-06-21 09:10:32,443 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,446 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <AsyncMock spec='SupabasePersistenceService' id='2059128419024'>
2025-06-21 09:10:32,447 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:120 - Fetching performance data for user 13646ed1-f7d0-4add-8a03-fa77139268bb, mode_filter: OperatingMode.PAPER
2025-06-21 09:10:32,447 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:129 - Using injected persistence_service: <AsyncMock spec='SupabasePersistenceService' id='2059128419024'>
2025-06-21 09:10:32,447 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:180 - Generated 1 performance entries for user 13646ed1-f7d0-4add-8a03-fa77139268bb
2025-06-21 09:10:32,491 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 3 trades cerrados para usuario adda7a2c-0806-453d-a6e7-2f3dabf75910 en modo paper
2025-06-21 09:10:32,495 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 3 trades cerrados para usuario 2464a54b-8e3a-46cc-814e-bdf79bbac0ae en modo paper
2025-06-21 09:10:32,499 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 04d00c6e-2607-4712-b809-530356ceb42a en modo paper
2025-06-21 09:10:32,503 - ultibot_backend.services.trading_report_service - ERROR - [MainThread] - trading_report_service.py:79 - Error al obtener trades cerrados para usuario ea1f1b86-2d86-456f-aa35-c89b3df7f83c: Database connection failed
Traceback (most recent call last):
  File "C:\Users\zamor\UltiBotInversiones\src\ultibot_backend\services\trading_report_service.py", line 65, in get_closed_trades
    trades = await persistence_service.get_closed_trades(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Program Files\Python311\Lib\unittest\mock.py", line 2237, in _execute_mock_call
    raise effect
Exception: Database connection failed
2025-06-21 09:10:32,531 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 8f28cc8a-a5f7-4fc5-ad70-9b8ee844b77d for symbol BTC/USDT
2025-06-21 09:10:32,532 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 5b037598-87a2-4ae7-9655-db0101f9d32b can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:32,532 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 8f28cc8a-a5f7-4fc5-ad70-9b8ee844b77d status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:32,533 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 8f28cc8a-a5f7-4fc5-ad70-9b8ee844b77d
2025-06-21 09:10:32,543 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity d3558f55-e04a-47e5-ac9b-b66a33dd66b5 for symbol BTC/USDT
2025-06-21 09:10:32,545 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy c7bc5c60-9210-4743-89f9-6a64da483748 can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:32,545 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity d3558f55-e04a-47e5-ac9b-b66a33dd66b5 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:32,546 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity d3558f55-e04a-47e5-ac9b-b66a33dd66b5
2025-06-21 09:10:32,554 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity d3986342-e225-4226-9f6c-d23e87199580 for symbol BTC/USDT
2025-06-21 09:10:32,555 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 9bd5486d-6aeb-436a-96d1-1a65b0b7a2c7 can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:32,557 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity d3986342-e225-4226-9f6c-d23e87199580 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:32,558 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity d3986342-e225-4226-9f6c-d23e87199580
2025-06-21 09:10:32,568 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 062f09f2-a85d-43cd-931e-60b35a1dba63 for symbol BTC/USDT
2025-06-21 09:10:32,570 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 8855134a-07df-47f0-856d-5f5ee855b716 can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:32,570 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 062f09f2-a85d-43cd-931e-60b35a1dba63 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:32,571 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 062f09f2-a85d-43cd-931e-60b35a1dba63
2025-06-21 09:10:32,583 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity b630240e-021e-4656-a944-5a3dfbe0ef9a for symbol BTC/USDT
2025-06-21 09:10:32,584 - ultibot_backend.services.trading_engine_service - WARNING - [MainThread] - trading_engine_service.py:638 - Unknown strategy type 'CUSTOM_UNKNOWN_TYPE' for strategy e5e154e3-197a-4970-96b0-967835cf304e. Recommending investigation.
2025-06-21 09:10:32,584 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity b630240e-021e-4656-a944-5a3dfbe0ef9a status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:32,585 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity b630240e-021e-4656-a944-5a3dfbe0ef9a
2025-06-21 09:10:32,594 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity c00ecd33-4f06-4468-8aa2-d8200376c8eb for symbol BTC/USDT
2025-06-21 09:10:32,595 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy f6331092-191d-4683-b277-806b1c103bee can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:32,596 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity c00ecd33-4f06-4468-8aa2-d8200376c8eb status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:32,597 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity c00ecd33-4f06-4468-8aa2-d8200376c8eb
2025-06-21 09:10:32,619 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:556 - Processing opportunity 46857d0a-222d-4b3e-bb27-addac9ae98c5 for symbol BTC/USDT
2025-06-21 09:10:32,620 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:709 - Strategy 4d6f5705-6e37-4920-9a12-cc4c8cea6efe can operate autonomously. Proceeding with autonomous logic.
2025-06-21 09:10:32,620 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:531 - Updated opportunity 46857d0a-222d-4b3e-bb27-addac9ae98c5 status to under_evaluation: 1 potential trade decision(s) generated.
2025-06-21 09:10:32,621 - ultibot_backend.services.trading_engine_service - INFO - [MainThread] - trading_engine_service.py:538 - Persisted status update for opportunity 46857d0a-222d-4b3e-bb27-addac9ae98c5
2025-06-21 09:15:14,039 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:15:14,040 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:15:14,058 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:15:14,210 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:15:14,212 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:15:14,214 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpnmrdaom3/test_db.sqlite
2025-06-21 09:15:14,223 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x0000026CD57EF880>
2025-06-21 09:15:14,223 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x0000026CD57EF880> completed
2025-06-21 09:15:14,223 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD57E9C60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000026CD57EE020>, deterministic=True)
2025-06-21 09:15:14,225 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD57E9C60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000026CD57EE020>, deterministic=True) completed
2025-06-21 09:15:14,225 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD57E9C60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:15:14,225 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD57E9C60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:15:14,225 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,226 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,227 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB6C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:15:14,227 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB6C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:15:14,227 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB6C0>)
2025-06-21 09:15:14,227 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB6C0>) completed
2025-06-21 09:15:14,228 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB6C0>)
2025-06-21 09:15:14,228 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB6C0>) completed
2025-06-21 09:15:14,229 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,229 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,230 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,230 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,231 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB4C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:15:14,231 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB4C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:15:14,232 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB4C0>)
2025-06-21 09:15:14,232 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB4C0>) completed
2025-06-21 09:15:14,232 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB4C0>)
2025-06-21 09:15:14,233 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB4C0>) completed
2025-06-21 09:15:14,233 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,233 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,234 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57B6C40>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:15:14,234 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57B6C40>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:15:14,235 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57B6C40>)
2025-06-21 09:15:14,235 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57B6C40>) completed
2025-06-21 09:15:14,235 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57B6C40>)
2025-06-21 09:15:14,236 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57B6C40>) completed
2025-06-21 09:15:14,236 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,236 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,237 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB5C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:15:14,237 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB5C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:15:14,238 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB5C0>)
2025-06-21 09:15:14,238 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB5C0>) completed
2025-06-21 09:15:14,238 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB5C0>)
2025-06-21 09:15:14,239 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB5C0>) completed
2025-06-21 09:15:14,239 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,239 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,240 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB740>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:15:14,240 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB740>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:15:14,240 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB740>)
2025-06-21 09:15:14,241 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB740>) completed
2025-06-21 09:15:14,241 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB740>)
2025-06-21 09:15:14,241 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB740>) completed
2025-06-21 09:15:14,242 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,242 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,242 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB7C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:15:14,242 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB7C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:15:14,243 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB7C0>)
2025-06-21 09:15:14,243 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB7C0>) completed
2025-06-21 09:15:14,243 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB7C0>)
2025-06-21 09:15:14,244 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB7C0>) completed
2025-06-21 09:15:14,244 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,245 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,245 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB940>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:15:14,246 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB940>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:15:14,246 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB940>)
2025-06-21 09:15:14,246 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB940>) completed
2025-06-21 09:15:14,247 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB940>)
2025-06-21 09:15:14,247 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB940>) completed
2025-06-21 09:15:14,247 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,247 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,248 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB8C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:15:14,248 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB8C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:15:14,249 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB8C0>)
2025-06-21 09:15:14,249 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB8C0>) completed
2025-06-21 09:15:14,249 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB8C0>)
2025-06-21 09:15:14,249 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB8C0>) completed
2025-06-21 09:15:14,250 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,250 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,250 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBAC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:15:14,251 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBAC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:15:14,251 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBAC0>)
2025-06-21 09:15:14,251 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBAC0>) completed
2025-06-21 09:15:14,252 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBAC0>)
2025-06-21 09:15:14,252 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBAC0>) completed
2025-06-21 09:15:14,252 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,252 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,253 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB9C0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:15:14,253 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB9C0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:15:14,254 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB9C0>)
2025-06-21 09:15:14,254 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DB9C0>) completed
2025-06-21 09:15:14,254 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB9C0>)
2025-06-21 09:15:14,255 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB9C0>) completed
2025-06-21 09:15:14,255 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,255 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,255 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBCC0>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:15:14,255 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBCC0>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:15:14,255 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBCC0>)
2025-06-21 09:15:14,257 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBCC0>) completed
2025-06-21 09:15:14,257 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBCC0>)
2025-06-21 09:15:14,257 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBCC0>) completed
2025-06-21 09:15:14,258 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,258 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,258 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBC40>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:15:14,259 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBC40>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:15:14,259 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBC40>)
2025-06-21 09:15:14,260 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBC40>) completed
2025-06-21 09:15:14,260 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBC40>)
2025-06-21 09:15:14,260 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBC40>) completed
2025-06-21 09:15:14,261 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,261 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,262 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBE40>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:15:14,263 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBE40>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:15:14,263 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBE40>)
2025-06-21 09:15:14,263 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBE40>) completed
2025-06-21 09:15:14,264 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBE40>)
2025-06-21 09:15:14,264 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBE40>) completed
2025-06-21 09:15:14,264 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,264 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,265 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBDC0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:15:14,265 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBDC0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:15:14,266 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBDC0>)
2025-06-21 09:15:14,266 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBDC0>) completed
2025-06-21 09:15:14,266 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBDC0>)
2025-06-21 09:15:14,266 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBDC0>) completed
2025-06-21 09:15:14,267 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,267 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,267 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBF40>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:15:14,268 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBF40>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:15:14,268 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBF40>)
2025-06-21 09:15:14,268 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD57DBF40>) completed
2025-06-21 09:15:14,269 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBF40>)
2025-06-21 09:15:14,269 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBF40>) completed
2025-06-21 09:15:14,270 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,270 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,270 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58400C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:15:14,275 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58400C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:15:14,275 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58400C0>)
2025-06-21 09:15:14,275 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58400C0>) completed
2025-06-21 09:15:14,275 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,277 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,277 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5842240>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:15:14,281 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5842240>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:15:14,281 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5842240>)
2025-06-21 09:15:14,281 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5842240>) completed
2025-06-21 09:15:14,282 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,282 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,283 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBA40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:15:14,285 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBA40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:15:14,285 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBA40>)
2025-06-21 09:15:14,285 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBA40>) completed
2025-06-21 09:15:14,287 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,287 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,287 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:15:14,289 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DB340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:15:14,290 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB340>)
2025-06-21 09:15:14,290 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DB340>) completed
2025-06-21 09:15:14,291 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,291 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,291 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBEC0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:15:14,294 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD57DBEC0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:15:14,295 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBEC0>)
2025-06-21 09:15:14,295 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD57DBEC0>) completed
2025-06-21 09:15:14,296 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,297 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,297 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5840FC0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:15:14,300 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5840FC0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:15:14,300 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5840FC0>)
2025-06-21 09:15:14,300 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5840FC0>) completed
2025-06-21 09:15:14,301 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,301 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,302 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58435C0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:15:14,304 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58435C0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:15:14,305 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58435C0>)
2025-06-21 09:15:14,305 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58435C0>) completed
2025-06-21 09:15:14,306 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,306 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,306 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58436C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:15:14,308 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58436C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:15:14,308 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58436C0>)
2025-06-21 09:15:14,308 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58436C0>) completed
2025-06-21 09:15:14,310 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,310 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,311 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5843BC0>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:15:14,311 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5843BC0>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:15:14,312 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD5843BC0>)
2025-06-21 09:15:14,312 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000026CD5843BC0>) completed
2025-06-21 09:15:14,313 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5843BC0>)
2025-06-21 09:15:14,314 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5843BC0>) completed
2025-06-21 09:15:14,314 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:15:14,314 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,315 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,315 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,315 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,316 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026CD57E9C60>)
2025-06-21 09:15:14,316 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026CD57E9C60>) completed
2025-06-21 09:15:14,317 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:15:14,318 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x0000026CD5805940>
2025-06-21 09:15:14,319 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x0000026CD5805940> completed
2025-06-21 09:15:14,320 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580F880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000026CD57EE020>, deterministic=True)
2025-06-21 09:15:14,320 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580F880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000026CD57EE020>, deterministic=True) completed
2025-06-21 09:15:14,321 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580F880>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:15:14,321 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580F880>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:15:14,322 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,322 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,323 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5855AC0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:15:14,324 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5855AC0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:15:14,324 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5855AC0>)
2025-06-21 09:15:14,325 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5855AC0>) completed
2025-06-21 09:15:14,325 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,325 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,325 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5855D40>, 'DELETE FROM trades', ())
2025-06-21 09:15:14,325 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5855D40>, 'DELETE FROM trades', ()) completed
2025-06-21 09:15:14,325 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5855D40>)
2025-06-21 09:15:14,327 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5855D40>) completed
2025-06-21 09:15:14,327 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,328 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,328 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58562C0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:15:14,329 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD58562C0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:15:14,330 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58562C0>)
2025-06-21 09:15:14,330 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD58562C0>) completed
2025-06-21 09:15:14,330 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,331 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,331 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5855C40>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:15:14,332 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5855C40>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:15:14,332 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5855C40>)
2025-06-21 09:15:14,332 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5855C40>) completed
2025-06-21 09:15:14,333 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,333 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,333 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5854DC0>, 'DELETE FROM opportunities', ())
2025-06-21 09:15:14,334 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5854DC0>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:15:14,334 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5854DC0>)
2025-06-21 09:15:14,334 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5854DC0>) completed
2025-06-21 09:15:14,335 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,335 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,335 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD566EBC0>, 'DELETE FROM market_data', ())
2025-06-21 09:15:14,336 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD566EBC0>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:15:14,336 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD566EBC0>)
2025-06-21 09:15:14,336 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD566EBC0>) completed
2025-06-21 09:15:14,337 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,337 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,337 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5856540>, 'DELETE FROM api_credentials', ())
2025-06-21 09:15:14,338 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD5856540>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:15:14,338 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5856540>)
2025-06-21 09:15:14,338 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000026CD5856540>) completed
2025-06-21 09:15:14,339 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,341 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,341 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,341 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,342 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026CD580F880>)
2025-06-21 09:15:14,342 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026CD580F880>) completed
2025-06-21 09:15:14,344 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x0000026CD58079C0>
2025-06-21 09:15:14,345 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x0000026CD58079C0> completed
2025-06-21 09:15:14,347 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580FC40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000026CD57EE020>, deterministic=True)
2025-06-21 09:15:14,348 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580FC40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000026CD57EE020>, deterministic=True) completed
2025-06-21 09:15:14,348 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580FC40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:15:14,349 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000026CD580FC40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:15:14,350 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580FC40>)
2025-06-21 09:15:14,351 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000026CD580FC40>) completed
2025-06-21 09:15:14,352 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000026CD588DEC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', {'pnl_usd': 150.0, 'side': 'buy'}, '2025-06-21T13:15:14.343695+00:00', '2025-06-21T13:15:14.343695+00:00', '2025-06-21T13:15:14.343695+00:00'))
2025-06-21 09:15:14,353 - aiosqlite - DEBUG - [Thread-3] - core.py:109 - returning exception Error binding parameter 7: type 'dict' is not supported
2025-06-21 09:15:14,837 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026CD580FC40>)
2025-06-21 09:15:14,837 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000026CD580FC40>) completed
2025-06-21 09:15:14,837 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD580FC40>)
2025-06-21 09:15:14,837 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000026CD580FC40>) completed
2025-06-21 09:15:14,838 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026CD580FC40>)
2025-06-21 09:15:14,838 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000026CD580FC40>) completed
2025-06-21 09:15:14,839 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:15:14,839 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpnmrdaom3. Reintentando en 0.2s...
2025-06-21 09:15:15,040 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpnmrdaom3. Reintentando en 0.2s...
2025-06-21 09:15:15,241 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpnmrdaom3. Reintentando en 0.2s...
2025-06-21 09:15:15,442 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpnmrdaom3. Reintentando en 0.2s...
2025-06-21 09:15:15,643 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpnmrdaom3. Reintentando en 0.2s...
2025-06-21 09:15:15,845 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmpnmrdaom3 después de 5 intentos.
2025-06-21 09:16:07,394 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:16:07,395 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:16:07,413 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:16:07,553 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:16:07,554 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:16:07,555 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp5eyzk0ja/test_db.sqlite
2025-06-21 09:16:07,564 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x00000212F3AC7740>
2025-06-21 09:16:07,565 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x00000212F3AC7740> completed
2025-06-21 09:16:07,566 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3ABDE40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3AC5EE0>, deterministic=True)
2025-06-21 09:16:07,566 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3ABDE40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3AC5EE0>, deterministic=True) completed
2025-06-21 09:16:07,567 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3ABDE40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:07,567 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3ABDE40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:07,567 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,568 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,568 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA840>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:16:07,568 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA840>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:16:07,569 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA840>)
2025-06-21 09:16:07,569 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA840>) completed
2025-06-21 09:16:07,570 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA840>)
2025-06-21 09:16:07,570 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA840>) completed
2025-06-21 09:16:07,570 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,570 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,571 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,571 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,572 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA640>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:16:07,572 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA640>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:16:07,573 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA640>)
2025-06-21 09:16:07,573 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA640>) completed
2025-06-21 09:16:07,573 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA640>)
2025-06-21 09:16:07,573 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA640>) completed
2025-06-21 09:16:07,574 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,574 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,574 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3A8DDC0>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:16:07,575 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3A8DDC0>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:16:07,575 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3A8DDC0>)
2025-06-21 09:16:07,575 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3A8DDC0>) completed
2025-06-21 09:16:07,576 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3A8DDC0>)
2025-06-21 09:16:07,576 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3A8DDC0>) completed
2025-06-21 09:16:07,577 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,577 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,577 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA740>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:16:07,577 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA740>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:16:07,578 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA740>)
2025-06-21 09:16:07,578 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA740>) completed
2025-06-21 09:16:07,578 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA740>)
2025-06-21 09:16:07,579 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA740>) completed
2025-06-21 09:16:07,580 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,580 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,581 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA8C0>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:16:07,581 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA8C0>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:16:07,582 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA8C0>)
2025-06-21 09:16:07,582 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA8C0>) completed
2025-06-21 09:16:07,582 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA8C0>)
2025-06-21 09:16:07,583 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA8C0>) completed
2025-06-21 09:16:07,583 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,583 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,584 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA940>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:16:07,584 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACA940>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:16:07,584 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA940>)
2025-06-21 09:16:07,585 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACA940>) completed
2025-06-21 09:16:07,585 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA940>)
2025-06-21 09:16:07,585 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACA940>) completed
2025-06-21 09:16:07,586 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,586 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,586 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAAC0>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:16:07,587 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAAC0>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:16:07,587 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAAC0>)
2025-06-21 09:16:07,587 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAAC0>) completed
2025-06-21 09:16:07,588 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAAC0>)
2025-06-21 09:16:07,588 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAAC0>) completed
2025-06-21 09:16:07,588 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,589 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,589 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAA40>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:16:07,589 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAA40>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:16:07,589 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAA40>)
2025-06-21 09:16:07,590 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAA40>) completed
2025-06-21 09:16:07,590 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAA40>)
2025-06-21 09:16:07,590 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAA40>) completed
2025-06-21 09:16:07,591 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,591 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,591 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAC40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:16:07,591 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAC40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:16:07,592 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAC40>)
2025-06-21 09:16:07,592 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAC40>) completed
2025-06-21 09:16:07,592 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAC40>)
2025-06-21 09:16:07,593 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAC40>) completed
2025-06-21 09:16:07,593 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,593 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,593 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAB40>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:16:07,594 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAB40>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:16:07,594 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAB40>)
2025-06-21 09:16:07,594 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAB40>) completed
2025-06-21 09:16:07,594 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAB40>)
2025-06-21 09:16:07,595 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAB40>) completed
2025-06-21 09:16:07,596 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,596 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,597 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAE40>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:16:07,597 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAE40>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:16:07,598 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAE40>)
2025-06-21 09:16:07,598 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAE40>) completed
2025-06-21 09:16:07,598 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAE40>)
2025-06-21 09:16:07,598 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAE40>) completed
2025-06-21 09:16:07,599 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,599 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,599 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACADC0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:16:07,600 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACADC0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:16:07,600 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACADC0>)
2025-06-21 09:16:07,600 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACADC0>) completed
2025-06-21 09:16:07,601 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACADC0>)
2025-06-21 09:16:07,601 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACADC0>) completed
2025-06-21 09:16:07,601 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,601 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,602 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAFC0>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:16:07,602 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAFC0>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:16:07,602 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAFC0>)
2025-06-21 09:16:07,602 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAFC0>) completed
2025-06-21 09:16:07,603 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAFC0>)
2025-06-21 09:16:07,603 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAFC0>) completed
2025-06-21 09:16:07,603 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,603 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,604 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAF40>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:16:07,604 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAF40>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:16:07,604 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAF40>)
2025-06-21 09:16:07,604 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACAF40>) completed
2025-06-21 09:16:07,605 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAF40>)
2025-06-21 09:16:07,605 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAF40>) completed
2025-06-21 09:16:07,605 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,605 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,605 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB140>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:16:07,605 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB140>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:16:07,607 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACB140>)
2025-06-21 09:16:07,607 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACB140>) completed
2025-06-21 09:16:07,607 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB140>)
2025-06-21 09:16:07,607 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB140>) completed
2025-06-21 09:16:07,608 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,609 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,609 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB0C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:07,613 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB0C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:07,614 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB0C0>)
2025-06-21 09:16:07,615 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB0C0>) completed
2025-06-21 09:16:07,616 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,616 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,617 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B393C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:16:07,619 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B393C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:16:07,620 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B393C0>)
2025-06-21 09:16:07,620 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B393C0>) completed
2025-06-21 09:16:07,621 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,621 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,622 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACABC0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:07,624 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACABC0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:07,624 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACABC0>)
2025-06-21 09:16:07,624 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACABC0>) completed
2025-06-21 09:16:07,625 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,625 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,625 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:07,629 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:07,630 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB340>)
2025-06-21 09:16:07,630 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB340>) completed
2025-06-21 09:16:07,631 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,632 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,632 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB1C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:07,634 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB1C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:07,635 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB1C0>)
2025-06-21 09:16:07,635 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB1C0>) completed
2025-06-21 09:16:07,637 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,637 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,637 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB2C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:07,640 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB2C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:07,640 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB2C0>)
2025-06-21 09:16:07,640 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB2C0>) completed
2025-06-21 09:16:07,641 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,641 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,642 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAEC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:07,644 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACAEC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:07,644 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAEC0>)
2025-06-21 09:16:07,645 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACAEC0>) completed
2025-06-21 09:16:07,645 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,646 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,646 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B3B840>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:16:07,648 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B3B840>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:16:07,649 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B3B840>)
2025-06-21 09:16:07,649 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B3B840>) completed
2025-06-21 09:16:07,650 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,650 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,651 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB040>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:16:07,651 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3ACB040>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:16:07,652 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACB040>)
2025-06-21 09:16:07,652 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3ACB040>) completed
2025-06-21 09:16:07,652 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB040>)
2025-06-21 09:16:07,653 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3ACB040>) completed
2025-06-21 09:16:07,653 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:16:07,654 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,654 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,654 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,655 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,655 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000212F3ABDE40>)
2025-06-21 09:16:07,655 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000212F3ABDE40>) completed
2025-06-21 09:16:07,657 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:16:07,658 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x00000212F3B01800>
2025-06-21 09:16:07,659 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x00000212F3B01800> completed
2025-06-21 09:16:07,660 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3AC5EE0>, deterministic=True)
2025-06-21 09:16:07,660 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3AC5EE0>, deterministic=True) completed
2025-06-21 09:16:07,660 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07A60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:07,661 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07A60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:07,662 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,662 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,662 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B50C40>, 'DELETE FROM user_configurations', ())
2025-06-21 09:16:07,664 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B50C40>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:16:07,664 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B50C40>)
2025-06-21 09:16:07,664 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B50C40>) completed
2025-06-21 09:16:07,665 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,665 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,665 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B50EC0>, 'DELETE FROM trades', ())
2025-06-21 09:16:07,665 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B50EC0>, 'DELETE FROM trades', ()) completed
2025-06-21 09:16:07,667 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B50EC0>)
2025-06-21 09:16:07,667 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B50EC0>) completed
2025-06-21 09:16:07,668 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,668 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,668 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B3B8C0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:16:07,669 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B3B8C0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:16:07,669 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B3B8C0>)
2025-06-21 09:16:07,670 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B3B8C0>) completed
2025-06-21 09:16:07,670 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,671 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,671 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B51440>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:16:07,671 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B51440>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:16:07,672 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B51440>)
2025-06-21 09:16:07,672 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B51440>) completed
2025-06-21 09:16:07,673 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,673 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,673 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3A7FDC0>, 'DELETE FROM opportunities', ())
2025-06-21 09:16:07,674 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3A7FDC0>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:16:07,674 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3A7FDC0>)
2025-06-21 09:16:07,674 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3A7FDC0>) completed
2025-06-21 09:16:07,675 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,675 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,675 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F392EAC0>, 'DELETE FROM market_data', ())
2025-06-21 09:16:07,676 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F392EAC0>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:16:07,676 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F392EAC0>)
2025-06-21 09:16:07,676 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F392EAC0>) completed
2025-06-21 09:16:07,677 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,677 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,677 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B516C0>, 'DELETE FROM api_credentials', ())
2025-06-21 09:16:07,677 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B516C0>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:16:07,678 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B516C0>)
2025-06-21 09:16:07,678 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B516C0>) completed
2025-06-21 09:16:07,679 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,681 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,682 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,682 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,683 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000212F3B07A60>)
2025-06-21 09:16:07,683 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000212F3B07A60>) completed
2025-06-21 09:16:07,685 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x00000212F3B03920>
2025-06-21 09:16:07,687 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x00000212F3B03920> completed
2025-06-21 09:16:07,687 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3AC5EE0>, deterministic=True)
2025-06-21 09:16:07,687 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3AC5EE0>, deterministic=True) completed
2025-06-21 09:16:07,688 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07B50>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:07,688 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B07B50>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:07,689 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07B50>)
2025-06-21 09:16:07,689 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07B50>) completed
2025-06-21 09:16:07,689 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B51E40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00'))
2025-06-21 09:16:07,690 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B51E40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00')) completed
2025-06-21 09:16:07,691 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B51E40>)
2025-06-21 09:16:07,691 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B51E40>) completed
2025-06-21 09:16:07,692 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07B50>)
2025-06-21 09:16:07,692 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07B50>) completed
2025-06-21 09:16:07,692 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B53040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00'))
2025-06-21 09:16:07,692 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B53040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00')) completed
2025-06-21 09:16:07,693 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B53040>)
2025-06-21 09:16:07,693 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B53040>) completed
2025-06-21 09:16:07,693 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07B50>)
2025-06-21 09:16:07,694 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B07B50>) completed
2025-06-21 09:16:07,694 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B530C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00'))
2025-06-21 09:16:07,694 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3B530C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00', '2025-06-21T13:16:07.684586+00:00')) completed
2025-06-21 09:16:07,695 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B530C0>)
2025-06-21 09:16:07,695 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3B530C0>) completed
2025-06-21 09:16:07,695 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3B07B50>)
2025-06-21 09:16:07,700 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3B07B50>) completed
2025-06-21 09:16:07,701 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B07B50>)
2025-06-21 09:16:07,701 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B07B50>) completed
2025-06-21 09:16:07,702 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000212F3B07B50>)
2025-06-21 09:16:07,702 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000212F3B07B50>) completed
2025-06-21 09:16:07,723 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:16:07,724 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:16:07,725 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:16:07,725 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp5eyzk0ja/test_db.sqlite
2025-06-21 09:16:07,727 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x00000212F3D43420>
2025-06-21 09:16:07,728 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x00000212F3D43420> completed
2025-06-21 09:16:07,730 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B6B2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3D42C00>, deterministic=True)
2025-06-21 09:16:07,730 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B6B2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000212F3D42C00>, deterministic=True) completed
2025-06-21 09:16:07,731 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B6B2E0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:07,731 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000212F3B6B2E0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:07,732 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,732 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,733 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D441C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:16:07,733 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D441C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:16:07,733 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D441C0>)
2025-06-21 09:16:07,733 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D441C0>) completed
2025-06-21 09:16:07,734 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D441C0>)
2025-06-21 09:16:07,734 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D441C0>) completed
2025-06-21 09:16:07,735 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,735 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,736 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,736 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,737 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D442C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:16:07,737 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D442C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:16:07,737 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D442C0>)
2025-06-21 09:16:07,738 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D442C0>) completed
2025-06-21 09:16:07,738 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D442C0>)
2025-06-21 09:16:07,738 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D442C0>) completed
2025-06-21 09:16:07,739 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,739 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,740 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D44040>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:16:07,740 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D44040>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:16:07,740 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D44040>)
2025-06-21 09:16:07,741 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D44040>) completed
2025-06-21 09:16:07,741 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D44040>)
2025-06-21 09:16:07,741 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D44040>) completed
2025-06-21 09:16:07,742 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,742 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,742 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D44340>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:16:07,742 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D44340>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:16:07,743 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D44340>)
2025-06-21 09:16:07,743 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D44340>) completed
2025-06-21 09:16:07,743 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D44340>)
2025-06-21 09:16:07,743 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D44340>) completed
2025-06-21 09:16:07,745 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,745 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,746 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D44440>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:16:07,746 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D44440>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:16:07,747 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D44440>)
2025-06-21 09:16:07,747 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D44440>) completed
2025-06-21 09:16:07,748 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D44440>)
2025-06-21 09:16:07,748 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D44440>) completed
2025-06-21 09:16:07,749 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,749 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,749 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D445C0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:16:07,749 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D445C0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:16:07,750 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D445C0>)
2025-06-21 09:16:07,750 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D445C0>) completed
2025-06-21 09:16:07,750 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D445C0>)
2025-06-21 09:16:07,751 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D445C0>) completed
2025-06-21 09:16:07,751 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,751 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,752 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D446C0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:16:07,752 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D446C0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:16:07,753 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D446C0>)
2025-06-21 09:16:07,753 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D446C0>) completed
2025-06-21 09:16:07,753 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D446C0>)
2025-06-21 09:16:07,754 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D446C0>) completed
2025-06-21 09:16:07,754 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,755 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,755 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D447C0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:16:07,755 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F3D447C0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:16:07,755 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D447C0>)
2025-06-21 09:16:07,755 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F3D447C0>) completed
2025-06-21 09:16:07,757 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D447C0>)
2025-06-21 09:16:07,757 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F3D447C0>) completed
2025-06-21 09:16:07,757 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,758 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,758 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:07,759 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:07,759 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:16:07,759 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:16:07,760 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:16:07,968 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:16:07,969 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:16:08,171 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:16:08,171 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:16:08,171 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: hz7So... (truncada por seguridad)
2025-06-21 09:16:08,172 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:16:08,191 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:16:08,191 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000212F3B8EB50>
2025-06-21 09:16:08,192 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:16:08,192 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:16:08,199 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:08,199 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:08,199 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F4F34940>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:16:08,200 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000212F4F34940>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:16:08,200 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F4F34940>)
2025-06-21 09:16:08,201 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000212F4F34940>) completed
2025-06-21 09:16:08,201 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F4F34940>)
2025-06-21 09:16:08,201 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000212F4F34940>) completed
2025-06-21 09:16:08,203 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:16:08,203 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:08,204 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:08,205 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>)
2025-06-21 09:16:08,205 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000212F3B6B2E0>) completed
2025-06-21 09:16:08,205 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:16:08,207 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:16:08,437 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:16:08,438 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp5eyzk0ja. Reintentando en 0.2s...
2025-06-21 09:16:08,638 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp5eyzk0ja. Reintentando en 0.2s...
2025-06-21 09:16:08,839 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp5eyzk0ja. Reintentando en 0.2s...
2025-06-21 09:16:09,041 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp5eyzk0ja. Reintentando en 0.2s...
2025-06-21 09:16:09,242 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp5eyzk0ja. Reintentando en 0.2s...
2025-06-21 09:16:09,443 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmp5eyzk0ja después de 5 intentos.
2025-06-21 09:16:54,068 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:16:54,068 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:16:54,087 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:16:54,205 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:16:54,205 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:16:54,208 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpccpurax5/test_db.sqlite
2025-06-21 09:16:54,219 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x000001A3571037E0>
2025-06-21 09:16:54,220 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x000001A3571037E0> completed
2025-06-21 09:16:54,220 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3570F98A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357101F80>, deterministic=True)
2025-06-21 09:16:54,221 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3570F98A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357101F80>, deterministic=True) completed
2025-06-21 09:16:54,221 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3570F98A0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:54,221 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3570F98A0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:54,222 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,222 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,222 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109AC0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:16:54,223 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109AC0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:16:54,223 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109AC0>)
2025-06-21 09:16:54,223 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109AC0>) completed
2025-06-21 09:16:54,224 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109AC0>)
2025-06-21 09:16:54,224 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109AC0>) completed
2025-06-21 09:16:54,224 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,224 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,225 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,225 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,225 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3571098C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:16:54,225 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3571098C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:16:54,227 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A3571098C0>)
2025-06-21 09:16:54,227 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A3571098C0>) completed
2025-06-21 09:16:54,227 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3571098C0>)
2025-06-21 09:16:54,228 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3571098C0>) completed
2025-06-21 09:16:54,228 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,228 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,229 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3570C1DC0>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:16:54,229 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3570C1DC0>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:16:54,229 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A3570C1DC0>)
2025-06-21 09:16:54,229 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A3570C1DC0>) completed
2025-06-21 09:16:54,230 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3570C1DC0>)
2025-06-21 09:16:54,230 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3570C1DC0>) completed
2025-06-21 09:16:54,231 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,232 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,232 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3571099C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:16:54,232 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3571099C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:16:54,233 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A3571099C0>)
2025-06-21 09:16:54,233 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A3571099C0>) completed
2025-06-21 09:16:54,234 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3571099C0>)
2025-06-21 09:16:54,234 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3571099C0>) completed
2025-06-21 09:16:54,234 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,234 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,235 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109B40>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:16:54,235 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109B40>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:16:54,235 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109B40>)
2025-06-21 09:16:54,235 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109B40>) completed
2025-06-21 09:16:54,236 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109B40>)
2025-06-21 09:16:54,236 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109B40>) completed
2025-06-21 09:16:54,236 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,237 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,237 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109BC0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:16:54,237 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109BC0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:16:54,237 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109BC0>)
2025-06-21 09:16:54,238 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109BC0>) completed
2025-06-21 09:16:54,238 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109BC0>)
2025-06-21 09:16:54,238 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109BC0>) completed
2025-06-21 09:16:54,238 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,239 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,239 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109D40>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:16:54,239 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109D40>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:16:54,239 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109D40>)
2025-06-21 09:16:54,240 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109D40>) completed
2025-06-21 09:16:54,240 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109D40>)
2025-06-21 09:16:54,240 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109D40>) completed
2025-06-21 09:16:54,241 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,241 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,241 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109CC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:16:54,241 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109CC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:16:54,242 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109CC0>)
2025-06-21 09:16:54,242 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109CC0>) completed
2025-06-21 09:16:54,242 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109CC0>)
2025-06-21 09:16:54,243 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109CC0>) completed
2025-06-21 09:16:54,243 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,243 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,243 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109EC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:16:54,244 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109EC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:16:54,244 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109EC0>)
2025-06-21 09:16:54,244 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109EC0>) completed
2025-06-21 09:16:54,244 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109EC0>)
2025-06-21 09:16:54,245 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109EC0>) completed
2025-06-21 09:16:54,245 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,245 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,245 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109DC0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:16:54,246 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109DC0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:16:54,246 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109DC0>)
2025-06-21 09:16:54,247 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A357109DC0>) completed
2025-06-21 09:16:54,247 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109DC0>)
2025-06-21 09:16:54,247 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109DC0>) completed
2025-06-21 09:16:54,248 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,248 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,249 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A0C0>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:16:54,249 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A0C0>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:16:54,249 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A0C0>)
2025-06-21 09:16:54,249 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A0C0>) completed
2025-06-21 09:16:54,250 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A0C0>)
2025-06-21 09:16:54,250 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A0C0>) completed
2025-06-21 09:16:54,250 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,250 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,251 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A040>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:16:54,251 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A040>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:16:54,252 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A040>)
2025-06-21 09:16:54,252 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A040>) completed
2025-06-21 09:16:54,252 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A040>)
2025-06-21 09:16:54,252 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A040>) completed
2025-06-21 09:16:54,253 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,253 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,253 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A240>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:16:54,253 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A240>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:16:54,254 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A240>)
2025-06-21 09:16:54,254 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A240>) completed
2025-06-21 09:16:54,254 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A240>)
2025-06-21 09:16:54,254 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A240>) completed
2025-06-21 09:16:54,255 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,255 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,255 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A1C0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:16:54,255 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A1C0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:16:54,257 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A1C0>)
2025-06-21 09:16:54,257 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A1C0>) completed
2025-06-21 09:16:54,257 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A1C0>)
2025-06-21 09:16:54,257 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A1C0>) completed
2025-06-21 09:16:54,258 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,258 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,258 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A3C0>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:16:54,258 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A3C0>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:16:54,259 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A3C0>)
2025-06-21 09:16:54,259 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710A3C0>) completed
2025-06-21 09:16:54,259 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A3C0>)
2025-06-21 09:16:54,259 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A3C0>) completed
2025-06-21 09:16:54,260 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,260 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,261 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A340>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:54,265 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A340>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:54,265 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A340>)
2025-06-21 09:16:54,265 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A340>) completed
2025-06-21 09:16:54,267 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,268 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,268 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A4C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:16:54,270 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A4C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:16:54,271 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A4C0>)
2025-06-21 09:16:54,271 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A4C0>) completed
2025-06-21 09:16:54,272 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,272 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,272 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109E40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:54,274 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357109E40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:54,275 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109E40>)
2025-06-21 09:16:54,275 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357109E40>) completed
2025-06-21 09:16:54,275 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,275 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,277 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A5C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:54,279 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A5C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:54,279 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A5C0>)
2025-06-21 09:16:54,280 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A5C0>) completed
2025-06-21 09:16:54,280 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,281 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,281 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A440>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:54,284 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A440>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:54,284 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A440>)
2025-06-21 09:16:54,285 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A440>) completed
2025-06-21 09:16:54,285 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,286 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,286 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A540>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:54,289 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A540>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:54,289 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A540>)
2025-06-21 09:16:54,289 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A540>) completed
2025-06-21 09:16:54,290 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,290 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,291 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A140>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:16:54,293 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710A140>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:16:54,293 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A140>)
2025-06-21 09:16:54,293 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710A140>) completed
2025-06-21 09:16:54,294 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,294 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,295 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710BCC0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:16:54,298 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710BCC0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:16:54,298 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710BCC0>)
2025-06-21 09:16:54,299 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710BCC0>) completed
2025-06-21 09:16:54,299 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,300 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,300 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710BD40>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:16:54,300 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35710BD40>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:16:54,301 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710BD40>)
2025-06-21 09:16:54,301 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35710BD40>) completed
2025-06-21 09:16:54,301 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710BD40>)
2025-06-21 09:16:54,302 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35710BD40>) completed
2025-06-21 09:16:54,302 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:16:54,303 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,303 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,303 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,303 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,304 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001A3570F98A0>)
2025-06-21 09:16:54,304 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001A3570F98A0>) completed
2025-06-21 09:16:54,305 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:16:54,306 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x000001A35711D8A0>
2025-06-21 09:16:54,307 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x000001A35711D8A0> completed
2025-06-21 09:16:54,307 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571234C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357101F80>, deterministic=True)
2025-06-21 09:16:54,308 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571234C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357101F80>, deterministic=True) completed
2025-06-21 09:16:54,308 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571234C0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:54,308 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571234C0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:54,309 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,309 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,310 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719C240>, 'DELETE FROM user_configurations', ())
2025-06-21 09:16:54,311 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719C240>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:16:54,311 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719C240>)
2025-06-21 09:16:54,311 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719C240>) completed
2025-06-21 09:16:54,312 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,312 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,312 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719C140>, 'DELETE FROM trades', ())
2025-06-21 09:16:54,313 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719C140>, 'DELETE FROM trades', ()) completed
2025-06-21 09:16:54,313 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719C140>)
2025-06-21 09:16:54,314 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719C140>) completed
2025-06-21 09:16:54,314 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,314 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,315 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357177040>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:16:54,315 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A357177040>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:16:54,315 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357177040>)
2025-06-21 09:16:54,315 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A357177040>) completed
2025-06-21 09:16:54,317 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,317 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,317 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35707F740>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:16:54,318 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35707F740>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:16:54,318 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35707F740>)
2025-06-21 09:16:54,319 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35707F740>) completed
2025-06-21 09:16:54,319 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,320 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,320 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3570AFDC0>, 'DELETE FROM opportunities', ())
2025-06-21 09:16:54,320 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3570AFDC0>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:16:54,321 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3570AFDC0>)
2025-06-21 09:16:54,321 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3570AFDC0>) completed
2025-06-21 09:16:54,322 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,322 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,322 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3570906C0>, 'DELETE FROM market_data', ())
2025-06-21 09:16:54,323 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A3570906C0>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:16:54,323 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3570906C0>)
2025-06-21 09:16:54,323 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A3570906C0>) completed
2025-06-21 09:16:54,324 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,324 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,324 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719C940>, 'DELETE FROM api_credentials', ())
2025-06-21 09:16:54,325 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719C940>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:16:54,325 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719C940>)
2025-06-21 09:16:54,325 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719C940>) completed
2025-06-21 09:16:54,326 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,328 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,329 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,329 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,330 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001A3571234C0>)
2025-06-21 09:16:54,331 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001A3571234C0>) completed
2025-06-21 09:16:54,332 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x000001A35711F920>
2025-06-21 09:16:54,334 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x000001A35711F920> completed
2025-06-21 09:16:54,334 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A357123880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357101F80>, deterministic=True)
2025-06-21 09:16:54,335 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A357123880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357101F80>, deterministic=True) completed
2025-06-21 09:16:54,335 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A357123880>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:54,335 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A357123880>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:54,336 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A357123880>)
2025-06-21 09:16:54,336 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A357123880>) completed
2025-06-21 09:16:54,337 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719D0C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00'))
2025-06-21 09:16:54,338 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719D0C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00')) completed
2025-06-21 09:16:54,338 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719D0C0>)
2025-06-21 09:16:54,338 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719D0C0>) completed
2025-06-21 09:16:54,339 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A357123880>)
2025-06-21 09:16:54,339 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A357123880>) completed
2025-06-21 09:16:54,340 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719E240>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00'))
2025-06-21 09:16:54,340 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719E240>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00')) completed
2025-06-21 09:16:54,340 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719E240>)
2025-06-21 09:16:54,340 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719E240>) completed
2025-06-21 09:16:54,341 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A357123880>)
2025-06-21 09:16:54,341 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A357123880>) completed
2025-06-21 09:16:54,341 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719E1C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00'))
2025-06-21 09:16:54,342 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35719E1C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00', '2025-06-21T13:16:54.332446+00:00')) completed
2025-06-21 09:16:54,342 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719E1C0>)
2025-06-21 09:16:54,342 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35719E1C0>) completed
2025-06-21 09:16:54,343 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A357123880>)
2025-06-21 09:16:54,344 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A357123880>) completed
2025-06-21 09:16:54,345 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A357123880>)
2025-06-21 09:16:54,345 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A357123880>) completed
2025-06-21 09:16:54,345 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001A357123880>)
2025-06-21 09:16:54,347 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001A357123880>) completed
2025-06-21 09:16:54,362 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:16:54,363 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:16:54,363 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:16:54,363 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpccpurax5/test_db.sqlite
2025-06-21 09:16:54,365 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x000001A3573874C0>
2025-06-21 09:16:54,367 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x000001A3573874C0> completed
2025-06-21 09:16:54,367 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571B6D40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357386CA0>, deterministic=True)
2025-06-21 09:16:54,367 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571B6D40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001A357386CA0>, deterministic=True) completed
2025-06-21 09:16:54,368 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571B6D40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:16:54,368 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001A3571B6D40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:16:54,369 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,369 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,369 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B3C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:16:54,370 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B3C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:16:54,370 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B3C0>)
2025-06-21 09:16:54,370 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B3C0>) completed
2025-06-21 09:16:54,371 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B3C0>)
2025-06-21 09:16:54,371 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B3C0>) completed
2025-06-21 09:16:54,371 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,371 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,372 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,372 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,372 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B4C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:16:54,373 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B4C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:16:54,373 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B4C0>)
2025-06-21 09:16:54,374 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B4C0>) completed
2025-06-21 09:16:54,374 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B4C0>)
2025-06-21 09:16:54,374 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B4C0>) completed
2025-06-21 09:16:54,375 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,375 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,375 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B240>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:16:54,376 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B240>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:16:54,376 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B240>)
2025-06-21 09:16:54,376 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B240>) completed
2025-06-21 09:16:54,377 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B240>)
2025-06-21 09:16:54,377 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B240>) completed
2025-06-21 09:16:54,378 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,378 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,378 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B540>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:16:54,378 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B540>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:16:54,379 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B540>)
2025-06-21 09:16:54,379 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B540>) completed
2025-06-21 09:16:54,379 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B540>)
2025-06-21 09:16:54,380 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B540>) completed
2025-06-21 09:16:54,380 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,381 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,381 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B640>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:16:54,382 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B640>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:16:54,382 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B640>)
2025-06-21 09:16:54,382 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B640>) completed
2025-06-21 09:16:54,383 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B640>)
2025-06-21 09:16:54,383 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B640>) completed
2025-06-21 09:16:54,383 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,384 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,384 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B7C0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:16:54,384 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B7C0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:16:54,385 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B7C0>)
2025-06-21 09:16:54,385 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B7C0>) completed
2025-06-21 09:16:54,386 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B7C0>)
2025-06-21 09:16:54,386 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B7C0>) completed
2025-06-21 09:16:54,387 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,387 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,388 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B8C0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:16:54,388 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B8C0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:16:54,389 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B8C0>)
2025-06-21 09:16:54,389 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B8C0>) completed
2025-06-21 09:16:54,389 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B8C0>)
2025-06-21 09:16:54,389 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B8C0>) completed
2025-06-21 09:16:54,390 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,390 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,390 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B9C0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:16:54,391 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A35737B9C0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:16:54,391 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B9C0>)
2025-06-21 09:16:54,391 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A35737B9C0>) completed
2025-06-21 09:16:54,392 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B9C0>)
2025-06-21 09:16:54,392 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A35737B9C0>) completed
2025-06-21 09:16:54,393 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,393 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,393 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,394 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,394 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:16:54,395 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:16:54,395 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:16:54,631 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:16:54,632 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:16:54,830 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:16:54,831 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:16:54,831 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: Yb1ao... (truncada por seguridad)
2025-06-21 09:16:54,831 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:16:54,847 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:16:54,847 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001A3571DA5D0>
2025-06-21 09:16:54,847 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:16:54,847 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:16:54,854 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,854 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,855 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A358567B40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:16:54,855 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001A358567B40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:16:54,855 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A358567B40>)
2025-06-21 09:16:54,855 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001A358567B40>) completed
2025-06-21 09:16:54,857 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A358567B40>)
2025-06-21 09:16:54,857 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001A358567B40>) completed
2025-06-21 09:16:54,859 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:16:54,859 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,859 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,860 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>)
2025-06-21 09:16:54,860 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001A3571B6D40>) completed
2025-06-21 09:16:54,861 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:16:54,862 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:16:55,088 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:16:55,089 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpccpurax5. Reintentando en 0.2s...
2025-06-21 09:16:55,289 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpccpurax5. Reintentando en 0.2s...
2025-06-21 09:16:55,490 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpccpurax5. Reintentando en 0.2s...
2025-06-21 09:16:55,691 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpccpurax5. Reintentando en 0.2s...
2025-06-21 09:16:55,893 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpccpurax5. Reintentando en 0.2s...
2025-06-21 09:16:56,094 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmpccpurax5 después de 5 intentos.
2025-06-21 09:18:26,879 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:18:26,880 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:18:26,898 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:18:27,041 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:18:27,042 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:18:27,044 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp1284vag5/test_db.sqlite
2025-06-21 09:18:27,054 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x000001C03ACE7740>
2025-06-21 09:18:27,055 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x000001C03ACE7740> completed
2025-06-21 09:18:27,056 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03ACDDE40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001C03ACE5EE0>, deterministic=True)
2025-06-21 09:18:27,056 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03ACDDE40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001C03ACE5EE0>, deterministic=True) completed
2025-06-21 09:18:27,057 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03ACDDE40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:18:27,057 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03ACDDE40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:18:27,057 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,058 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,058 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA8C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:18:27,058 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA8C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:18:27,059 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA8C0>)
2025-06-21 09:18:27,059 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA8C0>) completed
2025-06-21 09:18:27,059 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA8C0>)
2025-06-21 09:18:27,060 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA8C0>) completed
2025-06-21 09:18:27,060 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,060 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,061 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,061 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,061 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA6C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:18:27,062 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA6C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:18:27,062 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA6C0>)
2025-06-21 09:18:27,062 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA6C0>) completed
2025-06-21 09:18:27,063 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA6C0>)
2025-06-21 09:18:27,063 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA6C0>) completed
2025-06-21 09:18:27,063 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,064 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,064 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACADE40>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:18:27,064 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACADE40>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:18:27,065 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACADE40>)
2025-06-21 09:18:27,065 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACADE40>) completed
2025-06-21 09:18:27,067 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACADE40>)
2025-06-21 09:18:27,067 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACADE40>) completed
2025-06-21 09:18:27,067 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,068 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,068 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA7C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:18:27,068 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA7C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:18:27,069 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA7C0>)
2025-06-21 09:18:27,069 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA7C0>) completed
2025-06-21 09:18:27,069 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA7C0>)
2025-06-21 09:18:27,069 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA7C0>) completed
2025-06-21 09:18:27,070 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,070 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,070 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA940>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:18:27,070 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA940>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:18:27,071 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA940>)
2025-06-21 09:18:27,071 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA940>) completed
2025-06-21 09:18:27,072 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA940>)
2025-06-21 09:18:27,072 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA940>) completed
2025-06-21 09:18:27,072 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,072 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,073 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA9C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:18:27,073 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEA9C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:18:27,073 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA9C0>)
2025-06-21 09:18:27,074 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEA9C0>) completed
2025-06-21 09:18:27,074 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA9C0>)
2025-06-21 09:18:27,074 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEA9C0>) completed
2025-06-21 09:18:27,074 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,074 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,075 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAB40>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:18:27,075 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAB40>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:18:27,075 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAB40>)
2025-06-21 09:18:27,075 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAB40>) completed
2025-06-21 09:18:27,076 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAB40>)
2025-06-21 09:18:27,076 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAB40>) completed
2025-06-21 09:18:27,076 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,076 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,077 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAAC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:18:27,077 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAAC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:18:27,077 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAAC0>)
2025-06-21 09:18:27,079 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAAC0>) completed
2025-06-21 09:18:27,079 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAAC0>)
2025-06-21 09:18:27,079 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAAC0>) completed
2025-06-21 09:18:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEACC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:18:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEACC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:18:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEACC0>)
2025-06-21 09:18:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEACC0>) completed
2025-06-21 09:18:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEACC0>)
2025-06-21 09:18:27,081 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEACC0>) completed
2025-06-21 09:18:27,081 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,082 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,082 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEABC0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:18:27,083 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEABC0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:18:27,084 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEABC0>)
2025-06-21 09:18:27,084 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEABC0>) completed
2025-06-21 09:18:27,086 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEABC0>)
2025-06-21 09:18:27,086 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEABC0>) completed
2025-06-21 09:18:27,086 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,086 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,086 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAEC0>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:18:27,086 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAEC0>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:18:27,088 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAEC0>)
2025-06-21 09:18:27,088 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAEC0>) completed
2025-06-21 09:18:27,088 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAEC0>)
2025-06-21 09:18:27,089 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAEC0>) completed
2025-06-21 09:18:27,089 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,089 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,090 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAE40>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:18:27,090 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAE40>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:18:27,091 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAE40>)
2025-06-21 09:18:27,091 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAE40>) completed
2025-06-21 09:18:27,091 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAE40>)
2025-06-21 09:18:27,092 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAE40>) completed
2025-06-21 09:18:27,092 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,092 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,093 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB040>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:18:27,093 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB040>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:18:27,093 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEB040>)
2025-06-21 09:18:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEB040>) completed
2025-06-21 09:18:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB040>)
2025-06-21 09:18:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB040>) completed
2025-06-21 09:18:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAFC0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:18:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAFC0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:18:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAFC0>)
2025-06-21 09:18:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEAFC0>) completed
2025-06-21 09:18:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAFC0>)
2025-06-21 09:18:27,097 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAFC0>) completed
2025-06-21 09:18:27,097 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,097 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,098 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB1C0>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:18:27,099 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB1C0>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:18:27,099 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEB1C0>)
2025-06-21 09:18:27,099 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEB1C0>) completed
2025-06-21 09:18:27,100 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB1C0>)
2025-06-21 09:18:27,100 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB1C0>) completed
2025-06-21 09:18:27,101 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,102 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,103 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB140>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:18:27,107 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB140>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:18:27,108 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB140>)
2025-06-21 09:18:27,108 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB140>) completed
2025-06-21 09:18:27,109 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,109 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,110 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD39440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:18:27,112 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD39440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:18:27,113 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD39440>)
2025-06-21 09:18:27,113 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD39440>) completed
2025-06-21 09:18:27,116 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,117 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,117 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAC40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:18:27,120 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAC40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:18:27,121 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAC40>)
2025-06-21 09:18:27,121 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAC40>) completed
2025-06-21 09:18:27,122 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,122 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,123 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB3C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:18:27,125 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB3C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:18:27,125 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB3C0>)
2025-06-21 09:18:27,125 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB3C0>) completed
2025-06-21 09:18:27,127 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,128 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,128 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB240>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:18:27,131 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB240>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:18:27,131 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB240>)
2025-06-21 09:18:27,132 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB240>) completed
2025-06-21 09:18:27,133 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,133 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,133 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB340>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:18:27,135 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB340>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:18:27,137 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB340>)
2025-06-21 09:18:27,137 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB340>) completed
2025-06-21 09:18:27,137 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,138 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,138 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAF40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:18:27,140 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEAF40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:18:27,141 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAF40>)
2025-06-21 09:18:27,141 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEAF40>) completed
2025-06-21 09:18:27,141 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,142 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,142 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD3B8C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:18:27,144 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD3B8C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:18:27,144 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD3B8C0>)
2025-06-21 09:18:27,145 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD3B8C0>) completed
2025-06-21 09:18:27,146 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,146 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,146 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB0C0>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:18:27,147 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03ACEB0C0>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:18:27,147 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEB0C0>)
2025-06-21 09:18:27,147 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001C03ACEB0C0>) completed
2025-06-21 09:18:27,148 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB0C0>)
2025-06-21 09:18:27,148 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03ACEB0C0>) completed
2025-06-21 09:18:27,149 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:18:27,149 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,149 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,150 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,150 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,150 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C03ACDDE40>)
2025-06-21 09:18:27,151 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C03ACDDE40>) completed
2025-06-21 09:18:27,151 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:18:27,153 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x000001C03AD01800>
2025-06-21 09:18:27,154 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x000001C03AD01800> completed
2025-06-21 09:18:27,155 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001C03ACE5EE0>, deterministic=True)
2025-06-21 09:18:27,155 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001C03ACE5EE0>, deterministic=True) completed
2025-06-21 09:18:27,155 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07A60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:18:27,155 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07A60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:18:27,157 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,157 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,157 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD50CC0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:18:27,158 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD50CC0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:18:27,159 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD50CC0>)
2025-06-21 09:18:27,159 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD50CC0>) completed
2025-06-21 09:18:27,160 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,160 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,160 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD50F40>, 'DELETE FROM trades', ())
2025-06-21 09:18:27,161 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD50F40>, 'DELETE FROM trades', ()) completed
2025-06-21 09:18:27,161 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD50F40>)
2025-06-21 09:18:27,161 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD50F40>) completed
2025-06-21 09:18:27,162 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,162 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,163 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD3B940>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:18:27,163 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD3B940>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:18:27,164 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD3B940>)
2025-06-21 09:18:27,164 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD3B940>) completed
2025-06-21 09:18:27,165 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,165 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,166 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD514C0>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:18:27,166 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD514C0>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:18:27,167 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD514C0>)
2025-06-21 09:18:27,167 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD514C0>) completed
2025-06-21 09:18:27,168 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,168 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,168 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AC9FE40>, 'DELETE FROM opportunities', ())
2025-06-21 09:18:27,168 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AC9FE40>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:18:27,169 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AC9FE40>)
2025-06-21 09:18:27,169 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AC9FE40>) completed
2025-06-21 09:18:27,169 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,170 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,170 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AAEE940>, 'DELETE FROM market_data', ())
2025-06-21 09:18:27,170 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AAEE940>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:18:27,171 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AAEE940>)
2025-06-21 09:18:27,171 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AAEE940>) completed
2025-06-21 09:18:27,171 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,172 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,172 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD51740>, 'DELETE FROM api_credentials', ())
2025-06-21 09:18:27,172 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD51740>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:18:27,173 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD51740>)
2025-06-21 09:18:27,173 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD51740>) completed
2025-06-21 09:18:27,174 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,175 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,176 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,176 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,176 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C03AD07A60>)
2025-06-21 09:18:27,177 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C03AD07A60>) completed
2025-06-21 09:18:27,178 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x000001C03AD03880>
2025-06-21 09:18:27,179 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x000001C03AD03880> completed
2025-06-21 09:18:27,180 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001C03ACE5EE0>, deterministic=True)
2025-06-21 09:18:27,180 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001C03ACE5EE0>, deterministic=True) completed
2025-06-21 09:18:27,182 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07B50>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:18:27,182 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001C03AD07B50>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:18:27,182 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07B50>)
2025-06-21 09:18:27,182 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07B50>) completed
2025-06-21 09:18:27,184 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD51F40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00'))
2025-06-21 09:18:27,185 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD51F40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00')) completed
2025-06-21 09:18:27,185 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD51F40>)
2025-06-21 09:18:27,185 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD51F40>) completed
2025-06-21 09:18:27,186 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07B50>)
2025-06-21 09:18:27,187 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07B50>) completed
2025-06-21 09:18:27,187 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD53040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00'))
2025-06-21 09:18:27,187 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD53040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00')) completed
2025-06-21 09:18:27,188 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD53040>)
2025-06-21 09:18:27,188 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD53040>) completed
2025-06-21 09:18:27,188 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07B50>)
2025-06-21 09:18:27,189 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001C03AD07B50>) completed
2025-06-21 09:18:27,189 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD52FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00'))
2025-06-21 09:18:27,189 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001C03AD52FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00', '2025-06-21T13:18:27.178426+00:00')) completed
2025-06-21 09:18:27,190 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD52FC0>)
2025-06-21 09:18:27,190 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001C03AD52FC0>) completed
2025-06-21 09:18:27,190 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C03AD07B50>)
2025-06-21 09:18:27,192 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001C03AD07B50>) completed
2025-06-21 09:18:27,192 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03AD07B50>)
2025-06-21 09:18:27,193 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001C03AD07B50>) completed
2025-06-21 09:18:27,193 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C03AD07B50>)
2025-06-21 09:18:27,193 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001C03AD07B50>) completed
2025-06-21 09:18:27,568 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:18:27,569 - tests.conftest - INFO - [MainThread] - conftest.py:146 - Directorio temporal C:\Users\zamor\AppData\Local\Temp\tmp1284vag5 limpiado exitosamente.
2025-06-21 09:20:09,034 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:20:09,035 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:20:09,056 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:20:09,179 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:20:09,180 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:20:09,182 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpt53ulmii/test_db.sqlite
2025-06-21 09:20:09,190 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x000001CF1396F740>
2025-06-21 09:20:09,191 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x000001CF1396F740> completed
2025-06-21 09:20:09,192 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13965E40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF1396DEE0>, deterministic=True)
2025-06-21 09:20:09,192 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13965E40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF1396DEE0>, deterministic=True) completed
2025-06-21 09:20:09,193 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13965E40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:09,193 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13965E40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:09,193 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,194 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,194 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139728C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:20:09,194 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139728C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:20:09,195 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139728C0>)
2025-06-21 09:20:09,195 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139728C0>) completed
2025-06-21 09:20:09,195 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139728C0>)
2025-06-21 09:20:09,195 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139728C0>) completed
2025-06-21 09:20:09,196 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,196 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,196 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,198 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,198 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139726C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:20:09,198 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139726C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:20:09,199 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139726C0>)
2025-06-21 09:20:09,199 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139726C0>) completed
2025-06-21 09:20:09,199 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139726C0>)
2025-06-21 09:20:09,199 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139726C0>) completed
2025-06-21 09:20:09,200 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,200 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,201 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF1393DE40>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:20:09,202 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF1393DE40>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:20:09,202 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF1393DE40>)
2025-06-21 09:20:09,202 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF1393DE40>) completed
2025-06-21 09:20:09,203 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF1393DE40>)
2025-06-21 09:20:09,203 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF1393DE40>) completed
2025-06-21 09:20:09,204 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,204 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,204 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139727C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:20:09,205 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139727C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:20:09,205 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139727C0>)
2025-06-21 09:20:09,205 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139727C0>) completed
2025-06-21 09:20:09,206 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139727C0>)
2025-06-21 09:20:09,206 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139727C0>) completed
2025-06-21 09:20:09,206 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,207 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,207 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972940>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:20:09,207 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972940>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:20:09,207 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972940>)
2025-06-21 09:20:09,208 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972940>) completed
2025-06-21 09:20:09,208 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972940>)
2025-06-21 09:20:09,208 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972940>) completed
2025-06-21 09:20:09,209 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,209 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,209 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139729C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:20:09,209 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139729C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:20:09,210 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139729C0>)
2025-06-21 09:20:09,210 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139729C0>) completed
2025-06-21 09:20:09,210 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139729C0>)
2025-06-21 09:20:09,211 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139729C0>) completed
2025-06-21 09:20:09,211 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,211 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,211 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972B40>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:20:09,212 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972B40>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:20:09,212 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972B40>)
2025-06-21 09:20:09,212 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972B40>) completed
2025-06-21 09:20:09,212 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972B40>)
2025-06-21 09:20:09,213 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972B40>) completed
2025-06-21 09:20:09,213 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,213 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,214 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972AC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:20:09,214 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972AC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:20:09,214 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972AC0>)
2025-06-21 09:20:09,215 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972AC0>) completed
2025-06-21 09:20:09,215 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972AC0>)
2025-06-21 09:20:09,215 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972AC0>) completed
2025-06-21 09:20:09,215 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,216 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,216 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972CC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:20:09,217 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972CC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:20:09,217 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972CC0>)
2025-06-21 09:20:09,217 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972CC0>) completed
2025-06-21 09:20:09,218 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972CC0>)
2025-06-21 09:20:09,219 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972CC0>) completed
2025-06-21 09:20:09,219 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,219 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,220 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972BC0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:20:09,220 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972BC0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:20:09,221 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972BC0>)
2025-06-21 09:20:09,221 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972BC0>) completed
2025-06-21 09:20:09,221 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972BC0>)
2025-06-21 09:20:09,221 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972BC0>) completed
2025-06-21 09:20:09,222 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,222 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,222 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972EC0>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:20:09,223 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972EC0>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:20:09,223 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972EC0>)
2025-06-21 09:20:09,223 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972EC0>) completed
2025-06-21 09:20:09,224 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972EC0>)
2025-06-21 09:20:09,224 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972EC0>) completed
2025-06-21 09:20:09,225 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,225 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,225 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972E40>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:20:09,225 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972E40>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:20:09,225 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972E40>)
2025-06-21 09:20:09,227 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972E40>) completed
2025-06-21 09:20:09,227 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972E40>)
2025-06-21 09:20:09,227 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972E40>) completed
2025-06-21 09:20:09,227 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,228 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,228 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973040>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:20:09,229 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973040>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:20:09,229 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13973040>)
2025-06-21 09:20:09,229 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13973040>) completed
2025-06-21 09:20:09,230 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973040>)
2025-06-21 09:20:09,230 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973040>) completed
2025-06-21 09:20:09,230 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,231 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,231 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972FC0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:20:09,231 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972FC0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:20:09,232 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972FC0>)
2025-06-21 09:20:09,232 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13972FC0>) completed
2025-06-21 09:20:09,232 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972FC0>)
2025-06-21 09:20:09,233 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972FC0>) completed
2025-06-21 09:20:09,233 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,233 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,234 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139731C0>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:20:09,235 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139731C0>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:20:09,236 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139731C0>)
2025-06-21 09:20:09,236 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139731C0>) completed
2025-06-21 09:20:09,237 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139731C0>)
2025-06-21 09:20:09,237 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139731C0>) completed
2025-06-21 09:20:09,238 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,238 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,239 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973140>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:09,244 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973140>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:09,244 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973140>)
2025-06-21 09:20:09,245 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973140>) completed
2025-06-21 09:20:09,245 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,245 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,246 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139CD440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:20:09,249 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139CD440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:20:09,250 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139CD440>)
2025-06-21 09:20:09,250 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139CD440>) completed
2025-06-21 09:20:09,251 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,251 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,252 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972C40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:09,255 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972C40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:09,256 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972C40>)
2025-06-21 09:20:09,256 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972C40>) completed
2025-06-21 09:20:09,257 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,257 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,258 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139733C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:09,260 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139733C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:09,261 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139733C0>)
2025-06-21 09:20:09,261 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139733C0>) completed
2025-06-21 09:20:09,262 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,262 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,263 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973240>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:09,265 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973240>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:09,265 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973240>)
2025-06-21 09:20:09,265 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973240>) completed
2025-06-21 09:20:09,266 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,266 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,267 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973340>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:09,270 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13973340>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:09,271 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973340>)
2025-06-21 09:20:09,271 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13973340>) completed
2025-06-21 09:20:09,272 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,272 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,273 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972F40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:09,275 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13972F40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:09,276 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972F40>)
2025-06-21 09:20:09,276 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13972F40>) completed
2025-06-21 09:20:09,278 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,278 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,278 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139CF8C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:20:09,281 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139CF8C0>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:20:09,281 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139CF8C0>)
2025-06-21 09:20:09,281 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139CF8C0>) completed
2025-06-21 09:20:09,282 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,282 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,283 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139730C0>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:20:09,283 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139730C0>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:20:09,283 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139730C0>)
2025-06-21 09:20:09,284 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF139730C0>) completed
2025-06-21 09:20:09,284 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139730C0>)
2025-06-21 09:20:09,284 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139730C0>) completed
2025-06-21 09:20:09,285 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:20:09,286 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,286 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,286 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,287 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,287 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001CF13965E40>)
2025-06-21 09:20:09,287 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001CF13965E40>) completed
2025-06-21 09:20:09,288 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:20:09,290 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x000001CF13991800>
2025-06-21 09:20:09,291 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x000001CF13991800> completed
2025-06-21 09:20:09,291 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF1396DEE0>, deterministic=True)
2025-06-21 09:20:09,292 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF1396DEE0>, deterministic=True) completed
2025-06-21 09:20:09,292 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997A60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:09,292 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997A60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:09,293 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,294 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,294 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E4CC0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:20:09,295 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E4CC0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:20:09,295 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E4CC0>)
2025-06-21 09:20:09,295 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E4CC0>) completed
2025-06-21 09:20:09,297 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,297 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,297 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E4F40>, 'DELETE FROM trades', ())
2025-06-21 09:20:09,297 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E4F40>, 'DELETE FROM trades', ()) completed
2025-06-21 09:20:09,298 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E4F40>)
2025-06-21 09:20:09,298 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E4F40>) completed
2025-06-21 09:20:09,299 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,299 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,299 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139CF940>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:20:09,300 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139CF940>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:20:09,300 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139CF940>)
2025-06-21 09:20:09,301 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139CF940>) completed
2025-06-21 09:20:09,302 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,302 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,303 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E54C0>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:20:09,303 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E54C0>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:20:09,304 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E54C0>)
2025-06-21 09:20:09,304 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E54C0>) completed
2025-06-21 09:20:09,305 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,305 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,305 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF1392FE40>, 'DELETE FROM opportunities', ())
2025-06-21 09:20:09,306 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF1392FE40>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:20:09,306 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF1392FE40>)
2025-06-21 09:20:09,306 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF1392FE40>) completed
2025-06-21 09:20:09,307 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,307 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,307 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF137CAB40>, 'DELETE FROM market_data', ())
2025-06-21 09:20:09,307 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF137CAB40>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:20:09,307 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF137CAB40>)
2025-06-21 09:20:09,308 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF137CAB40>) completed
2025-06-21 09:20:09,308 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,308 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,309 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E5740>, 'DELETE FROM api_credentials', ())
2025-06-21 09:20:09,309 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E5740>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:20:09,310 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E5740>)
2025-06-21 09:20:09,310 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E5740>) completed
2025-06-21 09:20:09,310 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,312 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,313 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,313 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,314 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001CF13997A60>)
2025-06-21 09:20:09,314 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001CF13997A60>) completed
2025-06-21 09:20:09,315 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x000001CF13993880>
2025-06-21 09:20:09,317 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x000001CF13993880> completed
2025-06-21 09:20:09,318 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF1396DEE0>, deterministic=True)
2025-06-21 09:20:09,318 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF1396DEE0>, deterministic=True) completed
2025-06-21 09:20:09,319 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997B50>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:09,319 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF13997B50>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:09,320 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997B50>)
2025-06-21 09:20:09,320 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997B50>) completed
2025-06-21 09:20:09,321 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E5EC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00'))
2025-06-21 09:20:09,322 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E5EC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00')) completed
2025-06-21 09:20:09,322 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E5EC0>)
2025-06-21 09:20:09,323 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E5EC0>) completed
2025-06-21 09:20:09,324 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997B50>)
2025-06-21 09:20:09,324 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997B50>) completed
2025-06-21 09:20:09,325 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E7040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00'))
2025-06-21 09:20:09,325 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E7040>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00')) completed
2025-06-21 09:20:09,327 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E7040>)
2025-06-21 09:20:09,328 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E7040>) completed
2025-06-21 09:20:09,328 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997B50>)
2025-06-21 09:20:09,329 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF13997B50>) completed
2025-06-21 09:20:09,330 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E6FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00'))
2025-06-21 09:20:09,330 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF139E6FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00', '2025-06-21T13:20:09.315744+00:00')) completed
2025-06-21 09:20:09,331 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E6FC0>)
2025-06-21 09:20:09,331 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF139E6FC0>) completed
2025-06-21 09:20:09,332 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF13997B50>)
2025-06-21 09:20:09,335 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF13997B50>) completed
2025-06-21 09:20:09,336 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13997B50>)
2025-06-21 09:20:09,336 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF13997B50>) completed
2025-06-21 09:20:09,337 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001CF13997B50>)
2025-06-21 09:20:09,337 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001CF13997B50>) completed
2025-06-21 09:20:09,354 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:20:09,356 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:20:09,357 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:20:09,357 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpt53ulmii/test_db.sqlite
2025-06-21 09:20:09,358 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x000001CF13BD3420>
2025-06-21 09:20:09,359 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x000001CF13BD3420> completed
2025-06-21 09:20:09,360 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF139FF2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF13BD2C00>, deterministic=True)
2025-06-21 09:20:09,360 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF139FF2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001CF13BD2C00>, deterministic=True) completed
2025-06-21 09:20:09,360 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF139FF2E0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:09,361 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001CF139FF2E0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:09,361 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,362 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,362 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4240>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:20:09,362 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4240>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:20:09,363 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4240>)
2025-06-21 09:20:09,363 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4240>) completed
2025-06-21 09:20:09,363 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4240>)
2025-06-21 09:20:09,363 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4240>) completed
2025-06-21 09:20:09,364 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,364 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,365 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,365 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,365 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4340>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:20:09,367 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4340>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:20:09,367 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4340>)
2025-06-21 09:20:09,368 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4340>) completed
2025-06-21 09:20:09,368 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4340>)
2025-06-21 09:20:09,369 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4340>) completed
2025-06-21 09:20:09,369 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,370 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,370 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD40C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:20:09,370 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD40C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:20:09,371 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD40C0>)
2025-06-21 09:20:09,371 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD40C0>) completed
2025-06-21 09:20:09,371 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD40C0>)
2025-06-21 09:20:09,372 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD40C0>) completed
2025-06-21 09:20:09,372 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,372 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,373 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD43C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:20:09,373 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD43C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:20:09,373 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD43C0>)
2025-06-21 09:20:09,374 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD43C0>) completed
2025-06-21 09:20:09,374 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD43C0>)
2025-06-21 09:20:09,374 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD43C0>) completed
2025-06-21 09:20:09,374 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,375 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,375 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD44C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:20:09,375 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD44C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:20:09,376 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD44C0>)
2025-06-21 09:20:09,376 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD44C0>) completed
2025-06-21 09:20:09,376 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD44C0>)
2025-06-21 09:20:09,377 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD44C0>) completed
2025-06-21 09:20:09,377 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,377 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,377 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4640>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:20:09,378 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4640>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:20:09,378 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4640>)
2025-06-21 09:20:09,378 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4640>) completed
2025-06-21 09:20:09,379 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4640>)
2025-06-21 09:20:09,379 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4640>) completed
2025-06-21 09:20:09,380 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,381 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,381 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4740>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:20:09,382 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4740>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:20:09,382 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4740>)
2025-06-21 09:20:09,383 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4740>) completed
2025-06-21 09:20:09,383 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4740>)
2025-06-21 09:20:09,383 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4740>) completed
2025-06-21 09:20:09,384 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,384 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,384 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4840>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:20:09,385 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF13BD4840>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:20:09,385 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4840>)
2025-06-21 09:20:09,385 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF13BD4840>) completed
2025-06-21 09:20:09,386 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4840>)
2025-06-21 09:20:09,386 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF13BD4840>) completed
2025-06-21 09:20:09,386 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,386 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,387 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,387 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,387 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:20:09,388 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:20:09,388 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:20:09,579 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:20:09,579 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:20:09,774 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:20:09,774 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:20:09,774 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: kx7Ax... (truncada por seguridad)
2025-06-21 09:20:09,775 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:20:09,790 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:20:09,791 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001CF13A22C50>
2025-06-21 09:20:09,791 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:20:09,791 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:20:09,797 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,797 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,798 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF14DC89C0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:20:09,798 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001CF14DC89C0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:20:09,799 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF14DC89C0>)
2025-06-21 09:20:09,799 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001CF14DC89C0>) completed
2025-06-21 09:20:09,799 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF14DC89C0>)
2025-06-21 09:20:09,799 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001CF14DC89C0>) completed
2025-06-21 09:20:09,801 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:20:09,802 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,803 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,803 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>)
2025-06-21 09:20:09,803 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001CF139FF2E0>) completed
2025-06-21 09:20:09,804 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:20:09,805 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:20:10,017 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:20:10,018 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpt53ulmii. Reintentando en 0.2s...
2025-06-21 09:20:10,219 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpt53ulmii. Reintentando en 0.2s...
2025-06-21 09:20:10,420 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpt53ulmii. Reintentando en 0.2s...
2025-06-21 09:20:10,621 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpt53ulmii. Reintentando en 0.2s...
2025-06-21 09:20:10,822 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpt53ulmii. Reintentando en 0.2s...
2025-06-21 09:20:11,023 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmpt53ulmii después de 5 intentos.
2025-06-21 09:20:28,209 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:20:28,209 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:20:28,229 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:20:28,351 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:20:28,353 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:20:28,357 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp6xol46hv/test_db.sqlite
2025-06-21 09:20:28,368 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x0000021CB3AA7740>
2025-06-21 09:20:28,369 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x0000021CB3AA7740> completed
2025-06-21 09:20:28,370 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3A99E40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3AA5EE0>, deterministic=True)
2025-06-21 09:20:28,370 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3A99E40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3AA5EE0>, deterministic=True) completed
2025-06-21 09:20:28,371 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3A99E40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:28,371 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3A99E40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:28,372 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,372 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,372 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA8C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:20:28,373 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA8C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:20:28,374 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA8C0>)
2025-06-21 09:20:28,374 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA8C0>) completed
2025-06-21 09:20:28,374 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA8C0>)
2025-06-21 09:20:28,375 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA8C0>) completed
2025-06-21 09:20:28,375 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,375 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,376 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,376 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,377 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA6C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:20:28,377 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA6C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:20:28,378 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA6C0>)
2025-06-21 09:20:28,378 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA6C0>) completed
2025-06-21 09:20:28,378 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA6C0>)
2025-06-21 09:20:28,378 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA6C0>) completed
2025-06-21 09:20:28,379 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,379 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,379 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A61DC0>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:20:28,379 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A61DC0>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:20:28,380 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3A61DC0>)
2025-06-21 09:20:28,380 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3A61DC0>) completed
2025-06-21 09:20:28,380 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A61DC0>)
2025-06-21 09:20:28,381 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A61DC0>) completed
2025-06-21 09:20:28,381 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,381 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,382 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA7C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:20:28,382 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA7C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:20:28,382 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA7C0>)
2025-06-21 09:20:28,382 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA7C0>) completed
2025-06-21 09:20:28,383 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA7C0>)
2025-06-21 09:20:28,383 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA7C0>) completed
2025-06-21 09:20:28,384 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,384 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,384 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA940>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:20:28,384 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA940>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:20:28,385 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA940>)
2025-06-21 09:20:28,385 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA940>) completed
2025-06-21 09:20:28,385 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA940>)
2025-06-21 09:20:28,385 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA940>) completed
2025-06-21 09:20:28,385 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,387 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,387 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA9C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:20:28,387 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAA9C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:20:28,388 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA9C0>)
2025-06-21 09:20:28,388 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAA9C0>) completed
2025-06-21 09:20:28,388 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA9C0>)
2025-06-21 09:20:28,389 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAA9C0>) completed
2025-06-21 09:20:28,389 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,389 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,390 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAB40>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:20:28,390 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAB40>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:20:28,390 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAB40>)
2025-06-21 09:20:28,390 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAB40>) completed
2025-06-21 09:20:28,391 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAB40>)
2025-06-21 09:20:28,391 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAB40>) completed
2025-06-21 09:20:28,391 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,391 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,392 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAAC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:20:28,392 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAAC0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:20:28,392 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAAC0>)
2025-06-21 09:20:28,393 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAAC0>) completed
2025-06-21 09:20:28,393 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAAC0>)
2025-06-21 09:20:28,393 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAAC0>) completed
2025-06-21 09:20:28,394 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,394 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,394 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAACC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:20:28,394 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAACC0>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:20:28,395 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAACC0>)
2025-06-21 09:20:28,395 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAACC0>) completed
2025-06-21 09:20:28,395 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAACC0>)
2025-06-21 09:20:28,395 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAACC0>) completed
2025-06-21 09:20:28,395 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,395 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,397 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAABC0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:20:28,397 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAABC0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:20:28,397 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAABC0>)
2025-06-21 09:20:28,398 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAABC0>) completed
2025-06-21 09:20:28,398 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAABC0>)
2025-06-21 09:20:28,398 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAABC0>) completed
2025-06-21 09:20:28,399 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,399 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,399 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAEC0>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:20:28,399 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAEC0>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:20:28,400 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAEC0>)
2025-06-21 09:20:28,400 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAEC0>) completed
2025-06-21 09:20:28,400 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAEC0>)
2025-06-21 09:20:28,400 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAEC0>) completed
2025-06-21 09:20:28,401 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,401 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,401 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAE40>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:20:28,402 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAE40>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:20:28,402 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAE40>)
2025-06-21 09:20:28,402 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAE40>) completed
2025-06-21 09:20:28,403 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAE40>)
2025-06-21 09:20:28,403 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAE40>) completed
2025-06-21 09:20:28,404 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,404 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,404 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB040>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:20:28,404 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB040>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:20:28,405 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAB040>)
2025-06-21 09:20:28,405 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAB040>) completed
2025-06-21 09:20:28,405 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB040>)
2025-06-21 09:20:28,406 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB040>) completed
2025-06-21 09:20:28,406 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,406 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,407 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAFC0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:20:28,407 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAFC0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:20:28,407 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAFC0>)
2025-06-21 09:20:28,407 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAAFC0>) completed
2025-06-21 09:20:28,408 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAFC0>)
2025-06-21 09:20:28,408 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAFC0>) completed
2025-06-21 09:20:28,408 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,408 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,409 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB1C0>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:20:28,409 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB1C0>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:20:28,409 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAB1C0>)
2025-06-21 09:20:28,409 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3AAB1C0>) completed
2025-06-21 09:20:28,410 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB1C0>)
2025-06-21 09:20:28,410 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB1C0>) completed
2025-06-21 09:20:28,411 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,411 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,411 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB140>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:28,415 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB140>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:28,415 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB140>)
2025-06-21 09:20:28,415 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB140>) completed
2025-06-21 09:20:28,418 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,418 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,419 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B01440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:20:28,422 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B01440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:20:28,423 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B01440>)
2025-06-21 09:20:28,423 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B01440>) completed
2025-06-21 09:20:28,424 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,425 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,425 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAC40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:28,427 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAC40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:28,427 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAC40>)
2025-06-21 09:20:28,428 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAC40>) completed
2025-06-21 09:20:28,428 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,428 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,429 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB3C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:28,431 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB3C0>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:28,432 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB3C0>)
2025-06-21 09:20:28,432 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB3C0>) completed
2025-06-21 09:20:28,433 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,433 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,433 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB240>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:28,435 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB240>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:28,437 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB240>)
2025-06-21 09:20:28,437 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB240>) completed
2025-06-21 09:20:28,439 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,440 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,440 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB340>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:28,442 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAB340>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:28,443 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB340>)
2025-06-21 09:20:28,443 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAB340>) completed
2025-06-21 09:20:28,444 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,444 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,445 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAF40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:20:28,447 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3AAAF40>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:20:28,447 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAF40>)
2025-06-21 09:20:28,447 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3AAAF40>) completed
2025-06-21 09:20:28,447 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,448 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,448 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B03140>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:20:28,450 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B03140>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:20:28,451 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B03140>)
2025-06-21 09:20:28,451 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B03140>) completed
2025-06-21 09:20:28,452 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,452 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,452 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B024C0>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:20:28,453 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B024C0>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:20:28,453 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3B024C0>)
2025-06-21 09:20:28,453 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3B024C0>) completed
2025-06-21 09:20:28,454 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B024C0>)
2025-06-21 09:20:28,454 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B024C0>) completed
2025-06-21 09:20:28,454 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:20:28,455 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,455 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,455 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,455 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,457 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021CB3A99E40>)
2025-06-21 09:20:28,457 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021CB3A99E40>) completed
2025-06-21 09:20:28,458 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:20:28,459 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x0000021CB3AC5760>
2025-06-21 09:20:28,460 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x0000021CB3AC5760> completed
2025-06-21 09:20:28,460 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACB6A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3AA5EE0>, deterministic=True)
2025-06-21 09:20:28,461 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACB6A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3AA5EE0>, deterministic=True) completed
2025-06-21 09:20:28,461 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACB6A0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:28,461 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACB6A0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:28,461 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,462 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,462 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1C240>, 'DELETE FROM user_configurations', ())
2025-06-21 09:20:28,463 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1C240>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:20:28,463 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1C240>)
2025-06-21 09:20:28,463 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1C240>) completed
2025-06-21 09:20:28,464 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,464 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,464 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3957DC0>, 'DELETE FROM trades', ())
2025-06-21 09:20:28,465 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3957DC0>, 'DELETE FROM trades', ()) completed
2025-06-21 09:20:28,465 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3957DC0>)
2025-06-21 09:20:28,465 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3957DC0>) completed
2025-06-21 09:20:28,465 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,465 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,467 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3957D40>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:20:28,467 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3957D40>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:20:28,467 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3957D40>)
2025-06-21 09:20:28,468 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3957D40>) completed
2025-06-21 09:20:28,468 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,468 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,469 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A1F740>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:20:28,469 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A1F740>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:20:28,470 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A1F740>)
2025-06-21 09:20:28,470 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A1F740>) completed
2025-06-21 09:20:28,470 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,470 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,471 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A4FDC0>, 'DELETE FROM opportunities', ())
2025-06-21 09:20:28,471 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A4FDC0>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:20:28,471 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A4FDC0>)
2025-06-21 09:20:28,472 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A4FDC0>) completed
2025-06-21 09:20:28,472 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,473 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,473 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A346C0>, 'DELETE FROM market_data', ())
2025-06-21 09:20:28,473 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3A346C0>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:20:28,474 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A346C0>)
2025-06-21 09:20:28,474 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3A346C0>) completed
2025-06-21 09:20:28,474 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,475 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,475 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1C940>, 'DELETE FROM api_credentials', ())
2025-06-21 09:20:28,475 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1C940>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:20:28,476 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1C940>)
2025-06-21 09:20:28,476 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1C940>) completed
2025-06-21 09:20:28,476 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,479 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,479 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,479 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,479 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021CB3ACB6A0>)
2025-06-21 09:20:28,479 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021CB3ACB6A0>) completed
2025-06-21 09:20:28,482 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x0000021CB3AC77E0>
2025-06-21 09:20:28,483 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x0000021CB3AC77E0> completed
2025-06-21 09:20:28,483 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACBA60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3AA5EE0>, deterministic=True)
2025-06-21 09:20:28,484 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACBA60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3AA5EE0>, deterministic=True) completed
2025-06-21 09:20:28,484 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACBA60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:28,485 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3ACBA60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:28,485 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACBA60>)
2025-06-21 09:20:28,485 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACBA60>) completed
2025-06-21 09:20:28,485 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1D0C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:20:28.480986+00:00', '2025-06-21T13:20:28.480986+00:00', '2025-06-21T13:20:28.480986+00:00'))
2025-06-21 09:20:28,487 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1D0C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:20:28.480986+00:00', '2025-06-21T13:20:28.480986+00:00', '2025-06-21T13:20:28.480986+00:00')) completed
2025-06-21 09:20:28,487 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1D0C0>)
2025-06-21 09:20:28,488 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1D0C0>) completed
2025-06-21 09:20:28,488 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACBA60>)
2025-06-21 09:20:28,488 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACBA60>) completed
2025-06-21 09:20:28,489 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1E240>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00'))
2025-06-21 09:20:28,489 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1E240>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00')) completed
2025-06-21 09:20:28,490 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1E240>)
2025-06-21 09:20:28,490 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1E240>) completed
2025-06-21 09:20:28,490 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACBA60>)
2025-06-21 09:20:28,490 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3ACBA60>) completed
2025-06-21 09:20:28,490 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1E1C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00'))
2025-06-21 09:20:28,492 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3B1E1C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00', '2025-06-21T13:20:28.482056+00:00')) completed
2025-06-21 09:20:28,492 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1E1C0>)
2025-06-21 09:20:28,492 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3B1E1C0>) completed
2025-06-21 09:20:28,492 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3ACBA60>)
2025-06-21 09:20:28,494 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3ACBA60>) completed
2025-06-21 09:20:28,495 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3ACBA60>)
2025-06-21 09:20:28,495 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3ACBA60>) completed
2025-06-21 09:20:28,495 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021CB3ACBA60>)
2025-06-21 09:20:28,496 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021CB3ACBA60>) completed
2025-06-21 09:20:28,513 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:20:28,514 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:20:28,514 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:20:28,515 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp6xol46hv/test_db.sqlite
2025-06-21 09:20:28,515 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x0000021CB3D0B380>
2025-06-21 09:20:28,517 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x0000021CB3D0B380> completed
2025-06-21 09:20:28,517 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3B2EF20>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3D0AB60>, deterministic=True)
2025-06-21 09:20:28,518 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3B2EF20>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021CB3D0AB60>, deterministic=True) completed
2025-06-21 09:20:28,519 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3B2EF20>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:20:28,519 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021CB3B2EF20>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:20:28,519 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,520 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,520 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB3C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:20:28,520 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB3C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:20:28,521 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB3C0>)
2025-06-21 09:20:28,521 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB3C0>) completed
2025-06-21 09:20:28,521 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB3C0>)
2025-06-21 09:20:28,521 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB3C0>) completed
2025-06-21 09:20:28,521 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,522 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,522 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,522 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,523 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB4C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:20:28,523 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB4C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:20:28,523 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB4C0>)
2025-06-21 09:20:28,524 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB4C0>) completed
2025-06-21 09:20:28,524 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB4C0>)
2025-06-21 09:20:28,524 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB4C0>) completed
2025-06-21 09:20:28,525 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,525 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,525 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB240>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:20:28,525 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB240>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:20:28,525 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB240>)
2025-06-21 09:20:28,527 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB240>) completed
2025-06-21 09:20:28,527 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB240>)
2025-06-21 09:20:28,527 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB240>) completed
2025-06-21 09:20:28,528 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,528 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,528 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB540>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:20:28,529 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB540>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:20:28,529 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB540>)
2025-06-21 09:20:28,529 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB540>) completed
2025-06-21 09:20:28,530 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB540>)
2025-06-21 09:20:28,530 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB540>) completed
2025-06-21 09:20:28,530 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,531 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,531 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB640>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:20:28,531 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB640>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:20:28,531 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB640>)
2025-06-21 09:20:28,532 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB640>) completed
2025-06-21 09:20:28,532 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB640>)
2025-06-21 09:20:28,532 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB640>) completed
2025-06-21 09:20:28,532 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,533 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,533 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB7C0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:20:28,534 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB7C0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:20:28,534 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB7C0>)
2025-06-21 09:20:28,534 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB7C0>) completed
2025-06-21 09:20:28,535 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB7C0>)
2025-06-21 09:20:28,535 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB7C0>) completed
2025-06-21 09:20:28,535 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,537 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,537 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB8C0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:20:28,537 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB8C0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:20:28,538 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB8C0>)
2025-06-21 09:20:28,538 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB8C0>) completed
2025-06-21 09:20:28,538 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB8C0>)
2025-06-21 09:20:28,538 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB8C0>) completed
2025-06-21 09:20:28,539 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,539 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,539 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB9C0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:20:28,540 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB3CFB9C0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:20:28,540 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB9C0>)
2025-06-21 09:20:28,540 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB3CFB9C0>) completed
2025-06-21 09:20:28,541 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB9C0>)
2025-06-21 09:20:28,541 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB3CFB9C0>) completed
2025-06-21 09:20:28,541 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,541 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,542 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,542 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,542 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:20:28,543 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:20:28,543 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:20:28,755 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:20:28,757 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:20:28,953 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:20:28,954 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:20:28,954 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: uHWNb... (truncada por seguridad)
2025-06-21 09:20:28,954 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:20:28,970 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:20:28,970 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x0000021CB3809990>
2025-06-21 09:20:28,970 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:20:28,970 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:20:28,977 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,977 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,978 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB4EE7B40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:20:28,978 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021CB4EE7B40>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:20:28,979 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB4EE7B40>)
2025-06-21 09:20:28,979 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021CB4EE7B40>) completed
2025-06-21 09:20:28,979 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB4EE7B40>)
2025-06-21 09:20:28,979 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021CB4EE7B40>) completed
2025-06-21 09:20:28,981 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:20:28,981 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,982 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,982 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>)
2025-06-21 09:20:28,982 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021CB3B2EF20>) completed
2025-06-21 09:20:28,983 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:20:28,984 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:20:29,201 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:20:29,202 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp6xol46hv. Reintentando en 0.2s...
2025-06-21 09:20:29,403 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp6xol46hv. Reintentando en 0.2s...
2025-06-21 09:20:29,605 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp6xol46hv. Reintentando en 0.2s...
2025-06-21 09:20:29,805 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp6xol46hv. Reintentando en 0.2s...
2025-06-21 09:20:30,007 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp6xol46hv. Reintentando en 0.2s...
2025-06-21 09:20:30,208 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmp6xol46hv después de 5 intentos.
2025-06-21 09:21:26,921 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:21:26,922 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:21:26,942 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:21:27,064 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:21:27,065 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:21:27,067 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpv6a8e_k9/test_db.sqlite
2025-06-21 09:21:27,078 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x00000213F7E6F7E0>
2025-06-21 09:21:27,079 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x00000213F7E6F7E0> completed
2025-06-21 09:21:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E698A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F7E6DF80>, deterministic=True)
2025-06-21 09:21:27,080 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E698A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F7E6DF80>, deterministic=True) completed
2025-06-21 09:21:27,081 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E698A0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:27,081 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E698A0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:27,081 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,081 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,082 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79A40>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:21:27,082 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79A40>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:21:27,082 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79A40>)
2025-06-21 09:21:27,083 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79A40>) completed
2025-06-21 09:21:27,083 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79A40>)
2025-06-21 09:21:27,083 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79A40>) completed
2025-06-21 09:21:27,084 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,084 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,085 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,087 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,088 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79840>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:21:27,088 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79840>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:21:27,089 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79840>)
2025-06-21 09:21:27,089 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79840>) completed
2025-06-21 09:21:27,089 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79840>)
2025-06-21 09:21:27,089 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79840>) completed
2025-06-21 09:21:27,090 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,090 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,090 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E39D40>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:21:27,091 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E39D40>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:21:27,091 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E39D40>)
2025-06-21 09:21:27,091 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E39D40>) completed
2025-06-21 09:21:27,092 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E39D40>)
2025-06-21 09:21:27,092 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E39D40>) completed
2025-06-21 09:21:27,092 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,092 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,093 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79940>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:21:27,093 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79940>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:21:27,093 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79940>)
2025-06-21 09:21:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79940>) completed
2025-06-21 09:21:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79940>)
2025-06-21 09:21:27,094 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79940>) completed
2025-06-21 09:21:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79AC0>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:21:27,095 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79AC0>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:21:27,096 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79AC0>)
2025-06-21 09:21:27,096 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79AC0>) completed
2025-06-21 09:21:27,096 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79AC0>)
2025-06-21 09:21:27,097 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79AC0>) completed
2025-06-21 09:21:27,097 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,097 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,097 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79B40>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:21:27,098 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79B40>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:21:27,098 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79B40>)
2025-06-21 09:21:27,098 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79B40>) completed
2025-06-21 09:21:27,099 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79B40>)
2025-06-21 09:21:27,099 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79B40>) completed
2025-06-21 09:21:27,099 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,100 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,100 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79CC0>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:21:27,100 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79CC0>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:21:27,100 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79CC0>)
2025-06-21 09:21:27,101 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79CC0>) completed
2025-06-21 09:21:27,101 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79CC0>)
2025-06-21 09:21:27,101 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79CC0>) completed
2025-06-21 09:21:27,102 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,103 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,103 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79C40>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:21:27,103 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79C40>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:21:27,104 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79C40>)
2025-06-21 09:21:27,104 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79C40>) completed
2025-06-21 09:21:27,105 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79C40>)
2025-06-21 09:21:27,105 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79C40>) completed
2025-06-21 09:21:27,105 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,105 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,106 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79E40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:21:27,106 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79E40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:21:27,106 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79E40>)
2025-06-21 09:21:27,106 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79E40>) completed
2025-06-21 09:21:27,107 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79E40>)
2025-06-21 09:21:27,107 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79E40>) completed
2025-06-21 09:21:27,107 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,107 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,107 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79D40>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:21:27,107 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79D40>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:21:27,108 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79D40>)
2025-06-21 09:21:27,108 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79D40>) completed
2025-06-21 09:21:27,108 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79D40>)
2025-06-21 09:21:27,109 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79D40>) completed
2025-06-21 09:21:27,109 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,109 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,110 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A040>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:21:27,110 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A040>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:21:27,110 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A040>)
2025-06-21 09:21:27,111 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A040>) completed
2025-06-21 09:21:27,111 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A040>)
2025-06-21 09:21:27,111 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A040>) completed
2025-06-21 09:21:27,111 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,112 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,112 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79FC0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:21:27,112 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79FC0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:21:27,113 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79FC0>)
2025-06-21 09:21:27,113 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E79FC0>) completed
2025-06-21 09:21:27,113 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79FC0>)
2025-06-21 09:21:27,113 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79FC0>) completed
2025-06-21 09:21:27,114 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,114 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,114 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A1C0>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:21:27,115 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A1C0>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:21:27,115 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A1C0>)
2025-06-21 09:21:27,115 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A1C0>) completed
2025-06-21 09:21:27,115 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A1C0>)
2025-06-21 09:21:27,115 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A1C0>) completed
2025-06-21 09:21:27,117 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,117 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,118 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A140>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:21:27,118 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A140>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:21:27,119 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A140>)
2025-06-21 09:21:27,119 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A140>) completed
2025-06-21 09:21:27,120 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A140>)
2025-06-21 09:21:27,121 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A140>) completed
2025-06-21 09:21:27,121 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,121 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,122 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A340>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:21:27,122 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A340>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:21:27,122 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A340>)
2025-06-21 09:21:27,122 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7A340>) completed
2025-06-21 09:21:27,123 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A340>)
2025-06-21 09:21:27,123 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A340>) completed
2025-06-21 09:21:27,124 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,124 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,125 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A2C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:27,130 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A2C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:27,130 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A2C0>)
2025-06-21 09:21:27,131 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A2C0>) completed
2025-06-21 09:21:27,131 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,132 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,132 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:21:27,135 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:21:27,137 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A440>)
2025-06-21 09:21:27,137 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A440>) completed
2025-06-21 09:21:27,138 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,138 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,139 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7BF40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:27,141 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7BF40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:27,142 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7BF40>)
2025-06-21 09:21:27,142 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7BF40>) completed
2025-06-21 09:21:27,143 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,143 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,143 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A540>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:27,146 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A540>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:27,146 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A540>)
2025-06-21 09:21:27,147 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A540>) completed
2025-06-21 09:21:27,147 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,147 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,148 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A3C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:27,150 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A3C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:27,151 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A3C0>)
2025-06-21 09:21:27,151 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A3C0>) completed
2025-06-21 09:21:27,152 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,153 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,153 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A0C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:27,156 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7A0C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:27,157 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A0C0>)
2025-06-21 09:21:27,157 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7A0C0>) completed
2025-06-21 09:21:27,158 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,158 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,159 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79DC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:27,161 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E79DC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:27,161 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79DC0>)
2025-06-21 09:21:27,162 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E79DC0>) completed
2025-06-21 09:21:27,162 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,162 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,163 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7BC40>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:21:27,165 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7BC40>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:21:27,166 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7BC40>)
2025-06-21 09:21:27,167 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7BC40>) completed
2025-06-21 09:21:27,167 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,168 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,168 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7BCC0>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:21:27,169 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E7BCC0>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:21:27,170 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7BCC0>)
2025-06-21 09:21:27,170 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F7E7BCC0>) completed
2025-06-21 09:21:27,170 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7BCC0>)
2025-06-21 09:21:27,171 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E7BCC0>) completed
2025-06-21 09:21:27,171 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:21:27,172 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,172 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,173 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,173 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,173 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000213F7E698A0>)
2025-06-21 09:21:27,174 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000213F7E698A0>) completed
2025-06-21 09:21:27,174 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:21:27,176 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x00000213F7E958A0>
2025-06-21 09:21:27,178 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x00000213F7E958A0> completed
2025-06-21 09:21:27,179 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B4C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F7E6DF80>, deterministic=True)
2025-06-21 09:21:27,179 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B4C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F7E6DF80>, deterministic=True) completed
2025-06-21 09:21:27,179 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B4C0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:27,179 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B4C0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:27,180 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,180 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,181 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F101C0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:21:27,182 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F101C0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:21:27,182 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F101C0>)
2025-06-21 09:21:27,182 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F101C0>) completed
2025-06-21 09:21:27,183 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,183 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,184 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7EEBF40>, 'DELETE FROM trades', ())
2025-06-21 09:21:27,185 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7EEBF40>, 'DELETE FROM trades', ()) completed
2025-06-21 09:21:27,185 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7EEBF40>)
2025-06-21 09:21:27,186 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7EEBF40>) completed
2025-06-21 09:21:27,187 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,187 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,187 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7EEAFC0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:21:27,188 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7EEAFC0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:21:27,188 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7EEAFC0>)
2025-06-21 09:21:27,189 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7EEAFC0>) completed
2025-06-21 09:21:27,190 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,190 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,190 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7DF36C0>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:21:27,191 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7DF36C0>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:21:27,191 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7DF36C0>)
2025-06-21 09:21:27,191 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7DF36C0>) completed
2025-06-21 09:21:27,192 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,192 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,192 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E23D40>, 'DELETE FROM opportunities', ())
2025-06-21 09:21:27,193 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E23D40>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:21:27,193 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E23D40>)
2025-06-21 09:21:27,194 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E23D40>) completed
2025-06-21 09:21:27,194 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,195 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,195 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E04640>, 'DELETE FROM market_data', ())
2025-06-21 09:21:27,195 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7E04640>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:21:27,195 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E04640>)
2025-06-21 09:21:27,195 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7E04640>) completed
2025-06-21 09:21:27,197 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,197 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,197 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F108C0>, 'DELETE FROM api_credentials', ())
2025-06-21 09:21:27,197 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F108C0>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:21:27,198 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F108C0>)
2025-06-21 09:21:27,198 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F108C0>) completed
2025-06-21 09:21:27,198 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,200 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,201 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,201 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,202 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000213F7E9B4C0>)
2025-06-21 09:21:27,203 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000213F7E9B4C0>) completed
2025-06-21 09:21:27,204 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x00000213F7E97920>
2025-06-21 09:21:27,206 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x00000213F7E97920> completed
2025-06-21 09:21:27,206 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F7E6DF80>, deterministic=True)
2025-06-21 09:21:27,207 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F7E6DF80>, deterministic=True) completed
2025-06-21 09:21:27,207 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B880>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:27,207 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7E9B880>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:27,208 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B880>)
2025-06-21 09:21:27,208 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B880>) completed
2025-06-21 09:21:27,208 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F110C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00'))
2025-06-21 09:21:27,209 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F110C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00')) completed
2025-06-21 09:21:27,210 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F110C0>)
2025-06-21 09:21:27,210 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F110C0>) completed
2025-06-21 09:21:27,210 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B880>)
2025-06-21 09:21:27,211 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B880>) completed
2025-06-21 09:21:27,211 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F121C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00'))
2025-06-21 09:21:27,211 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F121C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00')) completed
2025-06-21 09:21:27,212 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F121C0>)
2025-06-21 09:21:27,212 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F121C0>) completed
2025-06-21 09:21:27,213 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B880>)
2025-06-21 09:21:27,213 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7E9B880>) completed
2025-06-21 09:21:27,213 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F12140>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00'))
2025-06-21 09:21:27,213 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F7F12140>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00', '2025-06-21T13:21:27.204234+00:00')) completed
2025-06-21 09:21:27,214 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F12140>)
2025-06-21 09:21:27,214 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F7F12140>) completed
2025-06-21 09:21:27,214 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7E9B880>)
2025-06-21 09:21:27,216 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7E9B880>) completed
2025-06-21 09:21:27,216 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E9B880>)
2025-06-21 09:21:27,217 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7E9B880>) completed
2025-06-21 09:21:27,217 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000213F7E9B880>)
2025-06-21 09:21:27,218 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000213F7E9B880>) completed
2025-06-21 09:21:27,237 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:21:27,238 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:21:27,238 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:21:27,239 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpv6a8e_k9/test_db.sqlite
2025-06-21 09:21:27,240 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x00000213F80F74C0>
2025-06-21 09:21:27,241 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x00000213F80F74C0> completed
2025-06-21 09:21:27,242 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7F26D40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F80F6CA0>, deterministic=True)
2025-06-21 09:21:27,242 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7F26D40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x00000213F80F6CA0>, deterministic=True) completed
2025-06-21 09:21:27,242 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7F26D40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:27,243 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000213F7F26D40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:27,243 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,244 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,244 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB340>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:21:27,244 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB340>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:21:27,244 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB340>)
2025-06-21 09:21:27,245 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB340>) completed
2025-06-21 09:21:27,245 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB340>)
2025-06-21 09:21:27,245 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB340>) completed
2025-06-21 09:21:27,246 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,246 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,246 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,246 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,248 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB440>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:21:27,248 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB440>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:21:27,248 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB440>)
2025-06-21 09:21:27,249 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB440>) completed
2025-06-21 09:21:27,249 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB440>)
2025-06-21 09:21:27,250 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB440>) completed
2025-06-21 09:21:27,250 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,250 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,251 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB1C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:21:27,251 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB1C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:21:27,252 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB1C0>)
2025-06-21 09:21:27,252 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB1C0>) completed
2025-06-21 09:21:27,253 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB1C0>)
2025-06-21 09:21:27,253 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB1C0>) completed
2025-06-21 09:21:27,254 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,255 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,255 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB4C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:21:27,255 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB4C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:21:27,256 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB4C0>)
2025-06-21 09:21:27,256 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB4C0>) completed
2025-06-21 09:21:27,257 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB4C0>)
2025-06-21 09:21:27,257 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB4C0>) completed
2025-06-21 09:21:27,257 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,258 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,258 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB5C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:21:27,258 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB5C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:21:27,259 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB5C0>)
2025-06-21 09:21:27,259 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB5C0>) completed
2025-06-21 09:21:27,260 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB5C0>)
2025-06-21 09:21:27,260 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB5C0>) completed
2025-06-21 09:21:27,260 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,261 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,261 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB740>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:21:27,261 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB740>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:21:27,261 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB740>)
2025-06-21 09:21:27,262 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB740>) completed
2025-06-21 09:21:27,262 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB740>)
2025-06-21 09:21:27,262 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB740>) completed
2025-06-21 09:21:27,263 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,263 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,263 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB840>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:21:27,264 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB840>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:21:27,264 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB840>)
2025-06-21 09:21:27,265 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB840>) completed
2025-06-21 09:21:27,265 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB840>)
2025-06-21 09:21:27,265 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB840>) completed
2025-06-21 09:21:27,266 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,266 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,267 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB940>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:21:27,267 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F80EB940>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:21:27,268 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB940>)
2025-06-21 09:21:27,269 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F80EB940>) completed
2025-06-21 09:21:27,269 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB940>)
2025-06-21 09:21:27,269 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F80EB940>) completed
2025-06-21 09:21:27,270 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,271 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,271 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,272 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,272 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:21:27,273 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:21:27,274 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:21:27,499 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:21:27,500 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:21:27,704 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:21:27,704 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:21:27,705 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: az9tU... (truncada por seguridad)
2025-06-21 09:21:27,705 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:21:27,722 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:21:27,723 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x00000213F7F4A690>
2025-06-21 09:21:27,723 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:21:27,723 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:21:27,725 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:440 - get_closed_trades - user_id: 00000000-0000-0000-0000-000000000001, mode: paper, symbol: None, start_date: None, end_date: None
2025-06-21 09:21:27,731 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,731 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,732 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F92D7AC0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:21:27,732 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000213F92D7AC0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:21:27,733 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F92D7AC0>)
2025-06-21 09:21:27,733 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000213F92D7AC0>) completed
2025-06-21 09:21:27,733 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F92D7AC0>)
2025-06-21 09:21:27,733 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000213F92D7AC0>) completed
2025-06-21 09:21:27,735 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-1', 'u...': 150.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:21:27,735 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-2', 'u...: -75.0, 'side': 'sell'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:21:27,737 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-3', 'u...d': 25.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:21:27,737 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:480 - get_closed_trades - Trades recuperados: 0
2025-06-21 09:21:27,738 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:21:27,738 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,739 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,739 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>)
2025-06-21 09:21:27,739 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000213F7F26D40>) completed
2025-06-21 09:21:27,740 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:21:27,741 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:21:28,000 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:21:28,001 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpv6a8e_k9. Reintentando en 0.2s...
2025-06-21 09:21:28,203 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpv6a8e_k9. Reintentando en 0.2s...
2025-06-21 09:21:28,404 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpv6a8e_k9. Reintentando en 0.2s...
2025-06-21 09:21:28,606 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpv6a8e_k9. Reintentando en 0.2s...
2025-06-21 09:21:28,807 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpv6a8e_k9. Reintentando en 0.2s...
2025-06-21 09:21:29,008 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmpv6a8e_k9 después de 5 intentos.
2025-06-21 09:21:46,445 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:21:46,445 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:21:46,465 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:21:46,582 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:21:46,583 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:21:46,586 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp779wqs31/test_db.sqlite
2025-06-21 09:21:46,595 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x000001E0122376A0>
2025-06-21 09:21:46,596 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x000001E0122376A0> completed
2025-06-21 09:21:46,596 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E012229E40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E012235E40>, deterministic=True)
2025-06-21 09:21:46,597 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E012229E40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E012235E40>, deterministic=True) completed
2025-06-21 09:21:46,597 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E012229E40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:46,598 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E012229E40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:46,598 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,599 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,599 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A840>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:21:46,600 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A840>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:21:46,600 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A840>)
2025-06-21 09:21:46,601 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A840>) completed
2025-06-21 09:21:46,601 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A840>)
2025-06-21 09:21:46,601 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A840>) completed
2025-06-21 09:21:46,602 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,602 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,603 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,604 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,605 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A640>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:21:46,605 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A640>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:21:46,606 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A640>)
2025-06-21 09:21:46,606 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A640>) completed
2025-06-21 09:21:46,607 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A640>)
2025-06-21 09:21:46,607 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A640>) completed
2025-06-21 09:21:46,607 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,607 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,608 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121F5F40>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:21:46,608 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121F5F40>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:21:46,609 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0121F5F40>)
2025-06-21 09:21:46,609 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0121F5F40>) completed
2025-06-21 09:21:46,609 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121F5F40>)
2025-06-21 09:21:46,610 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121F5F40>) completed
2025-06-21 09:21:46,610 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,610 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,611 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A740>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:21:46,611 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A740>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:21:46,612 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A740>)
2025-06-21 09:21:46,612 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A740>) completed
2025-06-21 09:21:46,612 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A740>)
2025-06-21 09:21:46,612 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A740>) completed
2025-06-21 09:21:46,613 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,613 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,614 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A8C0>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:21:46,614 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A8C0>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:21:46,614 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A8C0>)
2025-06-21 09:21:46,615 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A8C0>) completed
2025-06-21 09:21:46,615 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A8C0>)
2025-06-21 09:21:46,615 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A8C0>) completed
2025-06-21 09:21:46,615 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,617 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,617 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A940>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:21:46,618 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223A940>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:21:46,618 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A940>)
2025-06-21 09:21:46,619 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223A940>) completed
2025-06-21 09:21:46,619 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A940>)
2025-06-21 09:21:46,620 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223A940>) completed
2025-06-21 09:21:46,620 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,621 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,621 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AAC0>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:21:46,621 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AAC0>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:21:46,622 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AAC0>)
2025-06-21 09:21:46,622 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AAC0>) completed
2025-06-21 09:21:46,623 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AAC0>)
2025-06-21 09:21:46,623 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AAC0>) completed
2025-06-21 09:21:46,624 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,624 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,624 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AA40>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:21:46,625 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AA40>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:21:46,625 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AA40>)
2025-06-21 09:21:46,625 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AA40>) completed
2025-06-21 09:21:46,626 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AA40>)
2025-06-21 09:21:46,626 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AA40>) completed
2025-06-21 09:21:46,627 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,627 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,627 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AC40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:21:46,627 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AC40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:21:46,628 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AC40>)
2025-06-21 09:21:46,628 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AC40>) completed
2025-06-21 09:21:46,628 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AC40>)
2025-06-21 09:21:46,629 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AC40>) completed
2025-06-21 09:21:46,630 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,630 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,631 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AB40>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:21:46,631 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AB40>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:21:46,631 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AB40>)
2025-06-21 09:21:46,632 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AB40>) completed
2025-06-21 09:21:46,632 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AB40>)
2025-06-21 09:21:46,632 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AB40>) completed
2025-06-21 09:21:46,633 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,633 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,634 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AE40>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:21:46,634 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AE40>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:21:46,634 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AE40>)
2025-06-21 09:21:46,635 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AE40>) completed
2025-06-21 09:21:46,635 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AE40>)
2025-06-21 09:21:46,636 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AE40>) completed
2025-06-21 09:21:46,637 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,637 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,638 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223ADC0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:21:46,638 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223ADC0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:21:46,639 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223ADC0>)
2025-06-21 09:21:46,639 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223ADC0>) completed
2025-06-21 09:21:46,639 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223ADC0>)
2025-06-21 09:21:46,640 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223ADC0>) completed
2025-06-21 09:21:46,640 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,640 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,641 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AFC0>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:21:46,641 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AFC0>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:21:46,642 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AFC0>)
2025-06-21 09:21:46,642 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AFC0>) completed
2025-06-21 09:21:46,642 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AFC0>)
2025-06-21 09:21:46,643 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AFC0>) completed
2025-06-21 09:21:46,643 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,644 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,644 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AF40>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:21:46,644 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223AF40>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:21:46,645 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AF40>)
2025-06-21 09:21:46,645 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223AF40>) completed
2025-06-21 09:21:46,645 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AF40>)
2025-06-21 09:21:46,645 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223AF40>) completed
2025-06-21 09:21:46,647 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,647 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,648 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B140>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:21:46,648 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B140>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:21:46,648 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223B140>)
2025-06-21 09:21:46,649 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E01223B140>) completed
2025-06-21 09:21:46,649 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B140>)
2025-06-21 09:21:46,650 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B140>) completed
2025-06-21 09:21:46,651 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,651 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,651 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B0C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:46,656 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B0C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:46,657 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B0C0>)
2025-06-21 09:21:46,657 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B0C0>) completed
2025-06-21 09:21:46,658 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,659 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,660 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122B13C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:21:46,663 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122B13C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:21:46,663 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122B13C0>)
2025-06-21 09:21:46,664 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122B13C0>) completed
2025-06-21 09:21:46,665 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,665 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,665 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223ABC0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:46,669 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223ABC0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:46,670 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223ABC0>)
2025-06-21 09:21:46,670 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223ABC0>) completed
2025-06-21 09:21:46,671 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,671 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,672 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:46,675 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:46,675 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B340>)
2025-06-21 09:21:46,676 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B340>) completed
2025-06-21 09:21:46,677 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,678 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,678 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B1C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:46,681 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B1C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:46,682 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B1C0>)
2025-06-21 09:21:46,682 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B1C0>) completed
2025-06-21 09:21:46,684 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,684 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,685 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B2C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:46,688 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B2C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:46,688 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B2C0>)
2025-06-21 09:21:46,689 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B2C0>) completed
2025-06-21 09:21:46,690 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,690 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,691 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E012108240>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:21:46,694 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E012108240>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:21:46,696 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E012108240>)
2025-06-21 09:21:46,697 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E012108240>) completed
2025-06-21 09:21:46,697 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,697 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,698 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B040>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:21:46,700 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E01223B040>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:21:46,701 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B040>)
2025-06-21 09:21:46,701 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E01223B040>) completed
2025-06-21 09:21:46,702 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,703 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,703 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0120E7540>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:21:46,704 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0120E7540>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:21:46,704 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0120E7540>)
2025-06-21 09:21:46,705 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0120E7540>) completed
2025-06-21 09:21:46,705 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0120E7540>)
2025-06-21 09:21:46,705 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0120E7540>) completed
2025-06-21 09:21:46,707 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:21:46,708 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,708 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,709 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,710 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,711 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001E012229E40>)
2025-06-21 09:21:46,711 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001E012229E40>) completed
2025-06-21 09:21:46,712 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:21:46,714 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x000001E0122556C0>
2025-06-21 09:21:46,715 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x000001E0122556C0> completed
2025-06-21 09:21:46,715 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225B6A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E012235E40>, deterministic=True)
2025-06-21 09:21:46,716 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225B6A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E012235E40>, deterministic=True) completed
2025-06-21 09:21:46,716 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225B6A0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:46,717 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225B6A0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:46,718 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,718 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,719 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D0240>, 'DELETE FROM user_configurations', ())
2025-06-21 09:21:46,720 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D0240>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:21:46,721 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D0240>)
2025-06-21 09:21:46,721 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D0240>) completed
2025-06-21 09:21:46,722 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,723 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,724 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122B3F40>, 'DELETE FROM trades', ())
2025-06-21 09:21:46,724 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122B3F40>, 'DELETE FROM trades', ()) completed
2025-06-21 09:21:46,725 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122B3F40>)
2025-06-21 09:21:46,725 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122B3F40>) completed
2025-06-21 09:21:46,726 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,726 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,727 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0120E71C0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:21:46,727 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0120E71C0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:21:46,727 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0120E71C0>)
2025-06-21 09:21:46,727 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0120E71C0>) completed
2025-06-21 09:21:46,728 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,728 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,729 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121AF6C0>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:21:46,729 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121AF6C0>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:21:46,729 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121AF6C0>)
2025-06-21 09:21:46,730 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121AF6C0>) completed
2025-06-21 09:21:46,730 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,731 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,731 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121DFD40>, 'DELETE FROM opportunities', ())
2025-06-21 09:21:46,732 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121DFD40>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:21:46,732 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121DFD40>)
2025-06-21 09:21:46,732 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121DFD40>) completed
2025-06-21 09:21:46,733 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,733 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,733 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121C4640>, 'DELETE FROM market_data', ())
2025-06-21 09:21:46,734 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0121C4640>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:21:46,734 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121C4640>)
2025-06-21 09:21:46,735 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0121C4640>) completed
2025-06-21 09:21:46,736 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,736 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,738 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D08C0>, 'DELETE FROM api_credentials', ())
2025-06-21 09:21:46,738 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D08C0>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:21:46,739 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D08C0>)
2025-06-21 09:21:46,739 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D08C0>) completed
2025-06-21 09:21:46,740 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,742 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,742 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,743 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,743 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001E01225B6A0>)
2025-06-21 09:21:46,744 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001E01225B6A0>) completed
2025-06-21 09:21:46,745 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x000001E012257740>
2025-06-21 09:21:46,746 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x000001E012257740> completed
2025-06-21 09:21:46,747 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225BA60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E012235E40>, deterministic=True)
2025-06-21 09:21:46,747 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225BA60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E012235E40>, deterministic=True) completed
2025-06-21 09:21:46,747 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225BA60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:46,748 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E01225BA60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:46,748 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225BA60>)
2025-06-21 09:21:46,749 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225BA60>) completed
2025-06-21 09:21:46,749 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D10C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00'))
2025-06-21 09:21:46,750 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D10C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00')) completed
2025-06-21 09:21:46,751 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D10C0>)
2025-06-21 09:21:46,751 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D10C0>) completed
2025-06-21 09:21:46,752 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225BA60>)
2025-06-21 09:21:46,753 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225BA60>) completed
2025-06-21 09:21:46,753 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D21C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00'))
2025-06-21 09:21:46,754 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D21C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00')) completed
2025-06-21 09:21:46,754 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D21C0>)
2025-06-21 09:21:46,755 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D21C0>) completed
2025-06-21 09:21:46,756 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225BA60>)
2025-06-21 09:21:46,757 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E01225BA60>) completed
2025-06-21 09:21:46,757 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D2140>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00'))
2025-06-21 09:21:46,758 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0122D2140>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00', '2025-06-21T13:21:46.745380+00:00')) completed
2025-06-21 09:21:46,758 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D2140>)
2025-06-21 09:21:46,759 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0122D2140>) completed
2025-06-21 09:21:46,759 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E01225BA60>)
2025-06-21 09:21:46,761 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E01225BA60>) completed
2025-06-21 09:21:46,762 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E01225BA60>)
2025-06-21 09:21:46,762 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E01225BA60>) completed
2025-06-21 09:21:46,763 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x000001E01225BA60>)
2025-06-21 09:21:46,763 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x000001E01225BA60>) completed
2025-06-21 09:21:46,779 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:21:46,780 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:21:46,780 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:21:46,781 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmp779wqs31/test_db.sqlite
2025-06-21 09:21:46,782 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x000001E0124B7380>
2025-06-21 09:21:46,783 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x000001E0124B7380> completed
2025-06-21 09:21:46,784 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E0122DEF20>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E0124B6B60>, deterministic=True)
2025-06-21 09:21:46,784 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E0122DEF20>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000001E0124B6B60>, deterministic=True) completed
2025-06-21 09:21:46,785 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E0122DEF20>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:21:46,785 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x000001E0122DEF20>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:21:46,785 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,786 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,787 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB540>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:21:46,788 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB540>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:21:46,788 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB540>)
2025-06-21 09:21:46,789 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB540>) completed
2025-06-21 09:21:46,789 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB540>)
2025-06-21 09:21:46,790 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB540>) completed
2025-06-21 09:21:46,790 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,790 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,791 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,791 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,792 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB640>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:21:46,792 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB640>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:21:46,793 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB640>)
2025-06-21 09:21:46,793 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB640>) completed
2025-06-21 09:21:46,794 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB640>)
2025-06-21 09:21:46,794 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB640>) completed
2025-06-21 09:21:46,794 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,796 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,797 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB3C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:21:46,798 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB3C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:21:46,798 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB3C0>)
2025-06-21 09:21:46,799 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB3C0>) completed
2025-06-21 09:21:46,799 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB3C0>)
2025-06-21 09:21:46,800 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB3C0>) completed
2025-06-21 09:21:46,800 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,801 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,801 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB6C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:21:46,802 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB6C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:21:46,802 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB6C0>)
2025-06-21 09:21:46,803 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB6C0>) completed
2025-06-21 09:21:46,804 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB6C0>)
2025-06-21 09:21:46,805 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB6C0>) completed
2025-06-21 09:21:46,805 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,806 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,806 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB7C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:21:46,807 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB7C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:21:46,807 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB7C0>)
2025-06-21 09:21:46,808 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB7C0>) completed
2025-06-21 09:21:46,808 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB7C0>)
2025-06-21 09:21:46,809 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB7C0>) completed
2025-06-21 09:21:46,810 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,810 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,811 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB940>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:21:46,811 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124AB940>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:21:46,812 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB940>)
2025-06-21 09:21:46,812 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124AB940>) completed
2025-06-21 09:21:46,813 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB940>)
2025-06-21 09:21:46,813 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124AB940>) completed
2025-06-21 09:21:46,814 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,815 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,815 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124ABA40>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:21:46,815 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124ABA40>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:21:46,817 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124ABA40>)
2025-06-21 09:21:46,818 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124ABA40>) completed
2025-06-21 09:21:46,819 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124ABA40>)
2025-06-21 09:21:46,819 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124ABA40>) completed
2025-06-21 09:21:46,820 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,821 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,822 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124ABB40>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:21:46,822 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E0124ABB40>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:21:46,823 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124ABB40>)
2025-06-21 09:21:46,823 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E0124ABB40>) completed
2025-06-21 09:21:46,824 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124ABB40>)
2025-06-21 09:21:46,824 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E0124ABB40>) completed
2025-06-21 09:21:46,825 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,825 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,826 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:46,827 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:46,827 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:21:46,828 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:21:46,829 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:21:47,070 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:21:47,071 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:21:47,281 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:21:47,282 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:21:47,282 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: m7BDi... (truncada por seguridad)
2025-06-21 09:21:47,282 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:21:47,299 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:21:47,299 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x000001E0124BA9D0>
2025-06-21 09:21:47,299 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:21:47,300 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:21:47,300 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:440 - get_closed_trades - user_id: 00000000-0000-0000-0000-000000000001, mode: paper, symbol: None, start_date: None, end_date: None
2025-06-21 09:21:47,307 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:47,307 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:47,308 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E013693AC0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:21:47,308 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000001E013693AC0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:21:47,309 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E013693AC0>)
2025-06-21 09:21:47,309 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000001E013693AC0>) completed
2025-06-21 09:21:47,310 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E013693AC0>)
2025-06-21 09:21:47,310 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000001E013693AC0>) completed
2025-06-21 09:21:47,311 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-1', 'u...': 150.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:21:47,312 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-2', 'u...: -75.0, 'side': 'sell'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:21:47,312 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-3', 'u...d': 25.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:21:47,312 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:480 - get_closed_trades - Trades recuperados: 0
2025-06-21 09:21:47,312 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:21:47,313 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:47,313 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:47,314 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>)
2025-06-21 09:21:47,314 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x000001E0122DEF20>) completed
2025-06-21 09:21:47,315 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:21:47,316 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:21:47,552 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:21:47,553 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp779wqs31. Reintentando en 0.2s...
2025-06-21 09:21:47,755 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp779wqs31. Reintentando en 0.2s...
2025-06-21 09:21:47,957 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp779wqs31. Reintentando en 0.2s...
2025-06-21 09:21:48,158 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp779wqs31. Reintentando en 0.2s...
2025-06-21 09:21:48,359 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmp779wqs31. Reintentando en 0.2s...
2025-06-21 09:21:48,560 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmp779wqs31 después de 5 intentos.
2025-06-21 09:22:18,176 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:22:18,176 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:22:18,196 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:22:18,337 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:22:18,339 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:22:18,342 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpki55sdth/test_db.sqlite
2025-06-21 09:22:18,350 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x0000022D43207740>
2025-06-21 09:22:18,350 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x0000022D43207740> completed
2025-06-21 09:22:18,351 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D431FDE40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43205EE0>, deterministic=True)
2025-06-21 09:22:18,351 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D431FDE40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43205EE0>, deterministic=True) completed
2025-06-21 09:22:18,352 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D431FDE40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:18,352 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D431FDE40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:18,353 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,354 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,354 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A840>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:22:18,355 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A840>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:22:18,355 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A840>)
2025-06-21 09:22:18,356 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A840>) completed
2025-06-21 09:22:18,357 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A840>)
2025-06-21 09:22:18,357 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A840>) completed
2025-06-21 09:22:18,358 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,358 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,359 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,359 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,359 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A640>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:22:18,360 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A640>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:22:18,360 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A640>)
2025-06-21 09:22:18,360 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A640>) completed
2025-06-21 09:22:18,361 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A640>)
2025-06-21 09:22:18,361 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A640>) completed
2025-06-21 09:22:18,362 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,362 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,362 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D431D1DC0>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:22:18,362 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D431D1DC0>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:22:18,363 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D431D1DC0>)
2025-06-21 09:22:18,363 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D431D1DC0>) completed
2025-06-21 09:22:18,363 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D431D1DC0>)
2025-06-21 09:22:18,363 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D431D1DC0>) completed
2025-06-21 09:22:18,364 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,364 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,364 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A740>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:22:18,364 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A740>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:22:18,365 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A740>)
2025-06-21 09:22:18,365 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A740>) completed
2025-06-21 09:22:18,365 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A740>)
2025-06-21 09:22:18,365 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A740>) completed
2025-06-21 09:22:18,365 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,365 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,366 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A8C0>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:22:18,366 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A8C0>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:22:18,366 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A8C0>)
2025-06-21 09:22:18,367 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A8C0>) completed
2025-06-21 09:22:18,367 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A8C0>)
2025-06-21 09:22:18,367 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A8C0>) completed
2025-06-21 09:22:18,368 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,368 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,369 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A940>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:22:18,370 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320A940>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:22:18,370 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A940>)
2025-06-21 09:22:18,371 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320A940>) completed
2025-06-21 09:22:18,372 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A940>)
2025-06-21 09:22:18,372 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320A940>) completed
2025-06-21 09:22:18,373 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,373 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,373 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AAC0>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:22:18,374 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AAC0>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:22:18,374 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AAC0>)
2025-06-21 09:22:18,374 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AAC0>) completed
2025-06-21 09:22:18,375 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AAC0>)
2025-06-21 09:22:18,375 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AAC0>) completed
2025-06-21 09:22:18,375 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,376 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,376 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AA40>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:22:18,377 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AA40>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:22:18,377 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AA40>)
2025-06-21 09:22:18,378 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AA40>) completed
2025-06-21 09:22:18,378 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AA40>)
2025-06-21 09:22:18,378 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AA40>) completed
2025-06-21 09:22:18,379 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,379 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,379 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AC40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:22:18,379 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AC40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:22:18,380 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AC40>)
2025-06-21 09:22:18,380 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AC40>) completed
2025-06-21 09:22:18,380 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AC40>)
2025-06-21 09:22:18,380 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AC40>) completed
2025-06-21 09:22:18,381 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,381 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,381 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AB40>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:22:18,382 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AB40>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:22:18,382 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AB40>)
2025-06-21 09:22:18,382 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AB40>) completed
2025-06-21 09:22:18,383 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AB40>)
2025-06-21 09:22:18,383 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AB40>) completed
2025-06-21 09:22:18,383 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,384 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,384 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AE40>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:22:18,384 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AE40>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:22:18,384 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AE40>)
2025-06-21 09:22:18,385 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AE40>) completed
2025-06-21 09:22:18,385 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AE40>)
2025-06-21 09:22:18,385 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AE40>) completed
2025-06-21 09:22:18,386 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,386 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,387 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320ADC0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:22:18,387 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320ADC0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:22:18,388 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320ADC0>)
2025-06-21 09:22:18,388 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320ADC0>) completed
2025-06-21 09:22:18,389 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320ADC0>)
2025-06-21 09:22:18,389 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320ADC0>) completed
2025-06-21 09:22:18,390 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,390 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,390 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AFC0>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:22:18,391 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AFC0>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:22:18,391 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AFC0>)
2025-06-21 09:22:18,391 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AFC0>) completed
2025-06-21 09:22:18,391 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AFC0>)
2025-06-21 09:22:18,392 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AFC0>) completed
2025-06-21 09:22:18,392 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,392 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,393 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AF40>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:22:18,393 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AF40>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:22:18,394 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AF40>)
2025-06-21 09:22:18,394 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320AF40>) completed
2025-06-21 09:22:18,394 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AF40>)
2025-06-21 09:22:18,394 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AF40>) completed
2025-06-21 09:22:18,395 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,395 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,395 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B140>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:22:18,395 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B140>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:22:18,396 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320B140>)
2025-06-21 09:22:18,396 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320B140>) completed
2025-06-21 09:22:18,397 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B140>)
2025-06-21 09:22:18,397 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B140>) completed
2025-06-21 09:22:18,398 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,398 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,399 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B0C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:18,404 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B0C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:18,404 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B0C0>)
2025-06-21 09:22:18,405 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B0C0>) completed
2025-06-21 09:22:18,405 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,406 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,406 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D432553C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:22:18,409 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D432553C0>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:22:18,409 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D432553C0>)
2025-06-21 09:22:18,409 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D432553C0>) completed
2025-06-21 09:22:18,410 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,410 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,411 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320ABC0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:18,413 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320ABC0>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:18,413 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320ABC0>)
2025-06-21 09:22:18,414 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320ABC0>) completed
2025-06-21 09:22:18,414 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,415 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,415 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:18,418 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B340>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:18,419 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B340>)
2025-06-21 09:22:18,420 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B340>) completed
2025-06-21 09:22:18,421 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,421 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,422 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B1C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:18,426 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B1C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:18,428 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B1C0>)
2025-06-21 09:22:18,428 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B1C0>) completed
2025-06-21 09:22:18,430 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,431 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,432 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B2C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:18,435 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B2C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:18,438 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B2C0>)
2025-06-21 09:22:18,439 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B2C0>) completed
2025-06-21 09:22:18,440 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,440 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,441 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AEC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:18,446 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320AEC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:18,447 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AEC0>)
2025-06-21 09:22:18,447 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320AEC0>) completed
2025-06-21 09:22:18,448 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,449 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,449 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43257840>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:22:18,453 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43257840>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:22:18,454 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43257840>)
2025-06-21 09:22:18,454 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43257840>) completed
2025-06-21 09:22:18,455 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,457 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,457 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B040>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:22:18,458 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4320B040>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:22:18,458 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320B040>)
2025-06-21 09:22:18,459 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D4320B040>) completed
2025-06-21 09:22:18,459 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B040>)
2025-06-21 09:22:18,460 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4320B040>) completed
2025-06-21 09:22:18,460 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:22:18,461 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,461 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,462 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,462 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,462 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022D431FDE40>)
2025-06-21 09:22:18,463 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022D431FDE40>) completed
2025-06-21 09:22:18,464 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:22:18,466 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x0000022D43221800>
2025-06-21 09:22:18,467 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x0000022D43221800> completed
2025-06-21 09:22:18,467 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43205EE0>, deterministic=True)
2025-06-21 09:22:18,468 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227A60>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43205EE0>, deterministic=True) completed
2025-06-21 09:22:18,468 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227A60>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:18,469 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227A60>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:18,470 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,470 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,471 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43270C40>, 'DELETE FROM user_configurations', ())
2025-06-21 09:22:18,473 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43270C40>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:22:18,473 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43270C40>)
2025-06-21 09:22:18,474 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43270C40>) completed
2025-06-21 09:22:18,475 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,475 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,475 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43270EC0>, 'DELETE FROM trades', ())
2025-06-21 09:22:18,477 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43270EC0>, 'DELETE FROM trades', ()) completed
2025-06-21 09:22:18,478 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43270EC0>)
2025-06-21 09:22:18,478 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43270EC0>) completed
2025-06-21 09:22:18,480 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,480 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,481 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D432578C0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:22:18,481 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D432578C0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:22:18,482 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D432578C0>)
2025-06-21 09:22:18,482 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D432578C0>) completed
2025-06-21 09:22:18,483 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,484 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,484 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43271440>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:22:18,485 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43271440>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:22:18,485 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43271440>)
2025-06-21 09:22:18,486 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43271440>) completed
2025-06-21 09:22:18,486 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,487 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,487 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D431BFDC0>, 'DELETE FROM opportunities', ())
2025-06-21 09:22:18,488 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D431BFDC0>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:22:18,488 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D431BFDC0>)
2025-06-21 09:22:18,489 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D431BFDC0>) completed
2025-06-21 09:22:18,489 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,489 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,490 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4303EA40>, 'DELETE FROM market_data', ())
2025-06-21 09:22:18,490 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D4303EA40>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:22:18,490 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4303EA40>)
2025-06-21 09:22:18,491 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D4303EA40>) completed
2025-06-21 09:22:18,492 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,492 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,492 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D432716C0>, 'DELETE FROM api_credentials', ())
2025-06-21 09:22:18,493 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D432716C0>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:22:18,493 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D432716C0>)
2025-06-21 09:22:18,493 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D432716C0>) completed
2025-06-21 09:22:18,494 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,497 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,498 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,498 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,499 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022D43227A60>)
2025-06-21 09:22:18,499 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022D43227A60>) completed
2025-06-21 09:22:18,500 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x0000022D43223880>
2025-06-21 09:22:18,502 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x0000022D43223880> completed
2025-06-21 09:22:18,502 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43205EE0>, deterministic=True)
2025-06-21 09:22:18,503 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227B50>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43205EE0>, deterministic=True) completed
2025-06-21 09:22:18,503 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227B50>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:18,504 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D43227B50>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:18,505 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227B50>)
2025-06-21 09:22:18,506 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227B50>) completed
2025-06-21 09:22:18,506 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43271EC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00'))
2025-06-21 09:22:18,507 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43271EC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', '00000000-0000-0000-0000-000000000001', 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00')) completed
2025-06-21 09:22:18,507 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43271EC0>)
2025-06-21 09:22:18,508 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43271EC0>) completed
2025-06-21 09:22:18,508 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227B50>)
2025-06-21 09:22:18,508 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227B50>) completed
2025-06-21 09:22:18,509 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43272FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00'))
2025-06-21 09:22:18,509 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43272FC0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', '00000000-0000-0000-0000-000000000001', 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00')) completed
2025-06-21 09:22:18,510 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43272FC0>)
2025-06-21 09:22:18,510 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43272FC0>) completed
2025-06-21 09:22:18,511 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227B50>)
2025-06-21 09:22:18,511 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D43227B50>) completed
2025-06-21 09:22:18,511 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43272F40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00'))
2025-06-21 09:22:18,512 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43272F40>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', '00000000-0000-0000-0000-000000000001', 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00', '2025-06-21T13:22:18.500096+00:00')) completed
2025-06-21 09:22:18,512 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43272F40>)
2025-06-21 09:22:18,512 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43272F40>) completed
2025-06-21 09:22:18,513 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D43227B50>)
2025-06-21 09:22:18,515 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D43227B50>) completed
2025-06-21 09:22:18,515 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D43227B50>)
2025-06-21 09:22:18,515 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D43227B50>) completed
2025-06-21 09:22:18,517 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022D43227B50>)
2025-06-21 09:22:18,517 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000022D43227B50>) completed
2025-06-21 09:22:18,534 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:22:18,535 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:22:18,536 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:22:18,537 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpki55sdth/test_db.sqlite
2025-06-21 09:22:18,539 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x0000022D43463420>
2025-06-21 09:22:18,540 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x0000022D43463420> completed
2025-06-21 09:22:18,541 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D4328F2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43462C00>, deterministic=True)
2025-06-21 09:22:18,542 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D4328F2E0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000022D43462C00>, deterministic=True) completed
2025-06-21 09:22:18,542 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D4328F2E0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:18,543 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000022D4328F2E0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:18,543 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,544 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,544 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434681C0>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:22:18,545 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434681C0>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:22:18,545 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434681C0>)
2025-06-21 09:22:18,545 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434681C0>) completed
2025-06-21 09:22:18,546 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434681C0>)
2025-06-21 09:22:18,546 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434681C0>) completed
2025-06-21 09:22:18,547 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,547 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,548 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,549 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,549 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434682C0>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:22:18,550 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434682C0>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:22:18,551 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434682C0>)
2025-06-21 09:22:18,552 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434682C0>) completed
2025-06-21 09:22:18,553 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434682C0>)
2025-06-21 09:22:18,553 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434682C0>) completed
2025-06-21 09:22:18,555 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,555 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,556 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43468040>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:22:18,557 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43468040>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:22:18,558 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D43468040>)
2025-06-21 09:22:18,558 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D43468040>) completed
2025-06-21 09:22:18,559 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43468040>)
2025-06-21 09:22:18,559 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43468040>) completed
2025-06-21 09:22:18,560 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,560 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,561 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43468340>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:22:18,562 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43468340>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:22:18,562 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D43468340>)
2025-06-21 09:22:18,563 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D43468340>) completed
2025-06-21 09:22:18,564 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43468340>)
2025-06-21 09:22:18,564 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43468340>) completed
2025-06-21 09:22:18,565 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,565 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,566 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43468440>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:22:18,566 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D43468440>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:22:18,568 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D43468440>)
2025-06-21 09:22:18,569 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D43468440>) completed
2025-06-21 09:22:18,569 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43468440>)
2025-06-21 09:22:18,569 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D43468440>) completed
2025-06-21 09:22:18,571 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,572 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,573 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434685C0>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:22:18,574 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434685C0>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:22:18,574 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434685C0>)
2025-06-21 09:22:18,575 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434685C0>) completed
2025-06-21 09:22:18,575 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434685C0>)
2025-06-21 09:22:18,576 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434685C0>) completed
2025-06-21 09:22:18,577 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,577 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,578 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434686C0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:22:18,579 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434686C0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:22:18,579 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434686C0>)
2025-06-21 09:22:18,580 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434686C0>) completed
2025-06-21 09:22:18,580 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434686C0>)
2025-06-21 09:22:18,581 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434686C0>) completed
2025-06-21 09:22:18,581 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,582 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,582 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434687C0>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:22:18,583 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D434687C0>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:22:18,584 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434687C0>)
2025-06-21 09:22:18,584 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D434687C0>) completed
2025-06-21 09:22:18,585 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434687C0>)
2025-06-21 09:22:18,585 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D434687C0>) completed
2025-06-21 09:22:18,586 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,586 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,587 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:18,587 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:18,588 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:22:18,588 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:22:18,589 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:22:18,814 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:22:18,815 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:22:19,023 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:22:19,023 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:22:19,024 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: K3PAj... (truncada por seguridad)
2025-06-21 09:22:19,024 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:22:19,041 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:22:19,041 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x0000022D430A6C10>
2025-06-21 09:22:19,042 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:22:19,042 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:22:19,042 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:440 - get_closed_trades - user_id: 00000000-0000-0000-0000-000000000001, mode: paper, symbol: None, start_date: None, end_date: None
2025-06-21 09:22:19,048 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:19,049 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:19,049 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D44654940>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:22:19,050 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000022D44654940>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:22:19,050 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D44654940>)
2025-06-21 09:22:19,050 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000022D44654940>) completed
2025-06-21 09:22:19,050 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D44654940>)
2025-06-21 09:22:19,051 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000022D44654940>) completed
2025-06-21 09:22:19,052 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-1', 'u...': 150.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:22:19,052 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-2', 'u...: -75.0, 'side': 'sell'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:22:19,053 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-3', 'u...d': 25.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:22:19,053 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:480 - get_closed_trades - Trades recuperados: 0
2025-06-21 09:22:19,054 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:22:19,054 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:19,055 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:19,055 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>)
2025-06-21 09:22:19,056 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000022D4328F2E0>) completed
2025-06-21 09:22:19,056 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:22:19,057 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:22:19,284 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:22:19,284 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpki55sdth. Reintentando en 0.2s...
2025-06-21 09:22:19,486 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpki55sdth. Reintentando en 0.2s...
2025-06-21 09:22:19,687 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpki55sdth. Reintentando en 0.2s...
2025-06-21 09:22:19,889 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpki55sdth. Reintentando en 0.2s...
2025-06-21 09:22:20,090 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpki55sdth. Reintentando en 0.2s...
2025-06-21 09:22:20,291 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmpki55sdth después de 5 intentos.
2025-06-21 09:22:53,908 - ultibot_backend - INFO - [MainThread] - main.py:65 - Logging configurado exitosamente usando dictConfig.
2025-06-21 09:22:53,908 - ultibot_backend - INFO - [MainThread] - main.py:141 - Registrando routers de la API...
2025-06-21 09:22:53,929 - ultibot_backend - INFO - [MainThread] - main.py:153 - Todos los routers han sido registrados.
2025-06-21 09:22:54,049 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:22:54,050 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:22:54,052 - tests.conftest - INFO - [MainThread] - conftest.py:126 - db_engine fixture: Usando DATABASE_URL: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpa6l7fdtr/test_db.sqlite
2025-06-21 09:22:54,063 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing <function connect.<locals>.connector at 0x0000021962413740>
2025-06-21 09:22:54,064 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation <function connect.<locals>.connector at 0x0000021962413740> completed
2025-06-21 09:22:54,064 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624098A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021962411EE0>, deterministic=True)
2025-06-21 09:22:54,065 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624098A0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021962411EE0>, deterministic=True) completed
2025-06-21 09:22:54,065 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624098A0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:54,065 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624098A0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:54,067 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,067 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,067 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419A40>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:22:54,068 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419A40>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:22:54,068 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419A40>)
2025-06-21 09:22:54,068 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419A40>) completed
2025-06-21 09:22:54,069 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419A40>)
2025-06-21 09:22:54,069 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419A40>) completed
2025-06-21 09:22:54,070 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,070 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,072 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,072 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,072 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419840>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:22:54,073 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419840>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:22:54,073 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419840>)
2025-06-21 09:22:54,074 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419840>) completed
2025-06-21 09:22:54,074 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419840>)
2025-06-21 09:22:54,075 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419840>) completed
2025-06-21 09:22:54,075 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,075 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,075 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219623D9F40>, 'PRAGMA temp.table_info("api_credentials")', ())
2025-06-21 09:22:54,077 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219623D9F40>, 'PRAGMA temp.table_info("api_credentials")', ()) completed
2025-06-21 09:22:54,077 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000219623D9F40>)
2025-06-21 09:22:54,077 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x00000219623D9F40>) completed
2025-06-21 09:22:54,078 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219623D9F40>)
2025-06-21 09:22:54,078 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219623D9F40>) completed
2025-06-21 09:22:54,078 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,079 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,079 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419940>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:22:54,080 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419940>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:22:54,080 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419940>)
2025-06-21 09:22:54,080 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419940>) completed
2025-06-21 09:22:54,080 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419940>)
2025-06-21 09:22:54,081 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419940>) completed
2025-06-21 09:22:54,081 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,081 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,082 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419AC0>, 'PRAGMA temp.table_info("user_configurations")', ())
2025-06-21 09:22:54,082 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419AC0>, 'PRAGMA temp.table_info("user_configurations")', ()) completed
2025-06-21 09:22:54,082 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419AC0>)
2025-06-21 09:22:54,083 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419AC0>) completed
2025-06-21 09:22:54,083 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419AC0>)
2025-06-21 09:22:54,083 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419AC0>) completed
2025-06-21 09:22:54,084 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,084 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,084 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419B40>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:22:54,085 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419B40>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:22:54,085 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419B40>)
2025-06-21 09:22:54,085 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419B40>) completed
2025-06-21 09:22:54,086 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419B40>)
2025-06-21 09:22:54,086 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419B40>) completed
2025-06-21 09:22:54,087 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,088 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,089 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419CC0>, 'PRAGMA temp.table_info("trades")', ())
2025-06-21 09:22:54,089 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419CC0>, 'PRAGMA temp.table_info("trades")', ()) completed
2025-06-21 09:22:54,090 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419CC0>)
2025-06-21 09:22:54,090 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419CC0>) completed
2025-06-21 09:22:54,091 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419CC0>)
2025-06-21 09:22:54,091 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419CC0>) completed
2025-06-21 09:22:54,092 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,092 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,092 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419C40>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:22:54,093 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419C40>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:22:54,093 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419C40>)
2025-06-21 09:22:54,093 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419C40>) completed
2025-06-21 09:22:54,094 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419C40>)
2025-06-21 09:22:54,094 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419C40>) completed
2025-06-21 09:22:54,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,095 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419E40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ())
2025-06-21 09:22:54,095 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419E40>, 'PRAGMA temp.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:22:54,095 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419E40>)
2025-06-21 09:22:54,097 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419E40>) completed
2025-06-21 09:22:54,097 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419E40>)
2025-06-21 09:22:54,097 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419E40>) completed
2025-06-21 09:22:54,098 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,098 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,099 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419D40>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:22:54,099 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419D40>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:22:54,099 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419D40>)
2025-06-21 09:22:54,100 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419D40>) completed
2025-06-21 09:22:54,100 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419D40>)
2025-06-21 09:22:54,101 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419D40>) completed
2025-06-21 09:22:54,101 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,101 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,102 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A040>, 'PRAGMA temp.table_info("opportunities")', ())
2025-06-21 09:22:54,102 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A040>, 'PRAGMA temp.table_info("opportunities")', ()) completed
2025-06-21 09:22:54,102 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A040>)
2025-06-21 09:22:54,103 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A040>) completed
2025-06-21 09:22:54,103 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A040>)
2025-06-21 09:22:54,104 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A040>) completed
2025-06-21 09:22:54,105 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,106 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,106 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419FC0>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:22:54,106 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419FC0>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:22:54,106 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419FC0>)
2025-06-21 09:22:54,107 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021962419FC0>) completed
2025-06-21 09:22:54,107 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419FC0>)
2025-06-21 09:22:54,108 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419FC0>) completed
2025-06-21 09:22:54,108 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,109 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,109 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A1C0>, 'PRAGMA temp.table_info("strategy_configurations")', ())
2025-06-21 09:22:54,109 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A1C0>, 'PRAGMA temp.table_info("strategy_configurations")', ()) completed
2025-06-21 09:22:54,110 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A1C0>)
2025-06-21 09:22:54,110 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A1C0>) completed
2025-06-21 09:22:54,110 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A1C0>)
2025-06-21 09:22:54,111 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A1C0>) completed
2025-06-21 09:22:54,111 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,112 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,112 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A140>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:22:54,112 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A140>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:22:54,113 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A140>)
2025-06-21 09:22:54,113 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A140>) completed
2025-06-21 09:22:54,113 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A140>)
2025-06-21 09:22:54,114 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A140>) completed
2025-06-21 09:22:54,114 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,115 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,115 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A340>, 'PRAGMA temp.table_info("market_data")', ())
2025-06-21 09:22:54,115 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A340>, 'PRAGMA temp.table_info("market_data")', ()) completed
2025-06-21 09:22:54,116 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A340>)
2025-06-21 09:22:54,116 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241A340>) completed
2025-06-21 09:22:54,117 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A340>)
2025-06-21 09:22:54,117 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A340>) completed
2025-06-21 09:22:54,118 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,118 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,119 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A2C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:54,123 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A2C0>, '\nCREATE TABLE api_credentials (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tservice_name VARCHAR NOT NULL, \n\tcredential_label VARCHAR NOT NULL, \n\tencrypted_api_key TEXT NOT NULL, \n\tencrypted_api_secret TEXT, \n\tis_active BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:54,124 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A2C0>)
2025-06-21 09:22:54,125 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A2C0>) completed
2025-06-21 09:22:54,125 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,126 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,126 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ())
2025-06-21 09:22:54,129 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A440>, '\nCREATE TABLE user_configurations (\n\tid VARCHAR NOT NULL, \n\tuser_id VARCHAR NOT NULL, \n\ttelegram_chat_id VARCHAR, \n\tnotification_preferences TEXT, \n\tenable_telegram_notifications BOOLEAN NOT NULL, \n\tdefault_paper_trading_capital NUMERIC(18, 8) NOT NULL, \n\tpaper_trading_active BOOLEAN NOT NULL, \n\tpaper_trading_assets TEXT, \n\twatchlists TEXT, \n\tfavorite_pairs TEXT, \n\trisk_profile TEXT, \n\trisk_profile_settings TEXT, \n\treal_trading_settings TEXT, \n\tai_strategy_configurations TEXT, \n\tai_analysis_confidence_thresholds TEXT, \n\tmcp_server_preferences TEXT, \n\tselected_theme VARCHAR, \n\tdashboard_layout_profiles TEXT, \n\tactive_dashboard_layout_profile_id VARCHAR, \n\tdashboard_layout_config TEXT, \n\tcloud_sync_preferences TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id), \n\tUNIQUE (user_id)\n)\n\n', ()) completed
2025-06-21 09:22:54,129 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A440>)
2025-06-21 09:22:54,130 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A440>) completed
2025-06-21 09:22:54,130 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,131 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,131 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241BF40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:54,134 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241BF40>, '\nCREATE TABLE trades (\n\tid VARCHAR NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tstatus VARCHAR NOT NULL, \n\tposition_status VARCHAR NOT NULL, \n\tmode VARCHAR NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tclosed_at DATETIME, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:54,134 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241BF40>)
2025-06-21 09:22:54,134 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241BF40>) completed
2025-06-21 09:22:54,135 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,136 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,137 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A540>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:54,140 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A540>, '\nCREATE TABLE portfolio_snapshots (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tdata TEXT NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:54,140 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A540>)
2025-06-21 09:22:54,141 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A540>) completed
2025-06-21 09:22:54,142 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,142 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,143 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A3C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:54,145 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A3C0>, '\nCREATE TABLE opportunities (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tdetected_at DATETIME NOT NULL, \n\tsource_type VARCHAR NOT NULL, \n\tsource_name VARCHAR NOT NULL, \n\tsource_data TEXT, \n\tinitial_signal TEXT, \n\tsystem_calculated_priority_score FLOAT, \n\tlast_priority_calculation_at DATETIME, \n\tstatus VARCHAR NOT NULL, \n\tstatus_reason_code VARCHAR, \n\tstatus_reason_text TEXT, \n\tai_analysis TEXT, \n\tinvestigation_details TEXT, \n\tuser_feedback TEXT, \n\tlinked_trade_ids TEXT, \n\texpires_at DATETIME, \n\texpiration_logic TEXT, \n\tpost_trade_feedback TEXT, \n\tpost_facto_simulation_results TEXT, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tstrategy_id TEXT, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:54,145 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A3C0>)
2025-06-21 09:22:54,146 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A3C0>) completed
2025-06-21 09:22:54,146 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,147 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,147 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A0C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:54,149 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241A0C0>, '\nCREATE TABLE strategy_configurations (\n\tid TEXT NOT NULL, \n\tuser_id TEXT NOT NULL, \n\tdata TEXT NOT NULL, \n\tconfig_name VARCHAR NOT NULL, \n\tbase_strategy_type VARCHAR NOT NULL, \n\tis_active_paper_mode BOOLEAN NOT NULL, \n\tis_active_real_mode BOOLEAN NOT NULL, \n\tcreated_at DATETIME NOT NULL, \n\tupdated_at DATETIME NOT NULL, \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:54,150 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A0C0>)
2025-06-21 09:22:54,151 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241A0C0>) completed
2025-06-21 09:22:54,151 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,152 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,152 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419DC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ())
2025-06-21 09:22:54,156 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962419DC0>, '\nCREATE TABLE market_data (\n\tid INTEGER NOT NULL, \n\tsymbol VARCHAR NOT NULL, \n\tprice NUMERIC(18, 8) NOT NULL, \n\tvolume NUMERIC(18, 8) NOT NULL, \n\ttimestamp DATETIME NOT NULL, \n\tsource VARCHAR NOT NULL, \n\thigh_24h NUMERIC(18, 8), \n\tlow_24h NUMERIC(18, 8), \n\tchange_24h NUMERIC(18, 8), \n\tPRIMARY KEY (id)\n)\n\n', ()) completed
2025-06-21 09:22:54,156 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419DC0>)
2025-06-21 09:22:54,157 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962419DC0>) completed
2025-06-21 09:22:54,158 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,159 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,159 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241BC40>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ())
2025-06-21 09:22:54,162 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241BC40>, 'CREATE INDEX ix_market_data_symbol ON market_data (symbol)', ()) completed
2025-06-21 09:22:54,162 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241BC40>)
2025-06-21 09:22:54,163 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241BC40>) completed
2025-06-21 09:22:54,163 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,164 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,164 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241BCC0>, "SELECT name FROM sqlite_master WHERE type='table';", ())
2025-06-21 09:22:54,165 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196241BCC0>, "SELECT name FROM sqlite_master WHERE type='table';", ()) completed
2025-06-21 09:22:54,165 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241BCC0>)
2025-06-21 09:22:54,166 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196241BCC0>) completed
2025-06-21 09:22:54,166 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241BCC0>)
2025-06-21 09:22:54,167 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196241BCC0>) completed
2025-06-21 09:22:54,167 - tests.conftest - INFO - [MainThread] - conftest.py:133 - Tablas creadas en la base de datos: ['api_credentials', 'user_configurations', 'trades', 'portfolio_snapshots', 'opportunities', 'strategy_configurations', 'market_data']
2025-06-21 09:22:54,168 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,168 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,168 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,169 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,169 - aiosqlite - DEBUG - [Thread-1] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000219624098A0>)
2025-06-21 09:22:54,170 - aiosqlite - DEBUG - [Thread-1] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000219624098A0>) completed
2025-06-21 09:22:54,171 - asyncio - DEBUG - [MainThread] - selector_events.py:54 - Using selector: SelectSelector
2025-06-21 09:22:54,172 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing <function connect.<locals>.connector at 0x000002196242D800>
2025-06-21 09:22:54,173 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation <function connect.<locals>.connector at 0x000002196242D800> completed
2025-06-21 09:22:54,174 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624334C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021962411EE0>, deterministic=True)
2025-06-21 09:22:54,174 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624334C0>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021962411EE0>, deterministic=True) completed
2025-06-21 09:22:54,175 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624334C0>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:54,175 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624334C0>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:54,177 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,177 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,178 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B01C0>, 'DELETE FROM user_configurations', ())
2025-06-21 09:22:54,179 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B01C0>, 'DELETE FROM user_configurations', ()) completed
2025-06-21 09:22:54,179 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B01C0>)
2025-06-21 09:22:54,180 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B01C0>) completed
2025-06-21 09:22:54,180 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,181 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,181 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B03C0>, 'DELETE FROM trades', ())
2025-06-21 09:22:54,182 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B03C0>, 'DELETE FROM trades', ()) completed
2025-06-21 09:22:54,182 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B03C0>)
2025-06-21 09:22:54,182 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B03C0>) completed
2025-06-21 09:22:54,183 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,183 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,184 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962483EC0>, 'DELETE FROM strategy_configurations', ())
2025-06-21 09:22:54,184 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962483EC0>, 'DELETE FROM strategy_configurations', ()) completed
2025-06-21 09:22:54,184 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962483EC0>)
2025-06-21 09:22:54,185 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962483EC0>) completed
2025-06-21 09:22:54,185 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,185 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,186 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962482FC0>, 'DELETE FROM portfolio_snapshots', ())
2025-06-21 09:22:54,186 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021962482FC0>, 'DELETE FROM portfolio_snapshots', ()) completed
2025-06-21 09:22:54,186 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962482FC0>)
2025-06-21 09:22:54,187 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021962482FC0>) completed
2025-06-21 09:22:54,188 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,189 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,189 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219623BFD40>, 'DELETE FROM opportunities', ())
2025-06-21 09:22:54,189 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219623BFD40>, 'DELETE FROM opportunities', ()) completed
2025-06-21 09:22:54,190 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219623BFD40>)
2025-06-21 09:22:54,190 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219623BFD40>) completed
2025-06-21 09:22:54,191 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,191 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,192 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219623A4640>, 'DELETE FROM market_data', ())
2025-06-21 09:22:54,192 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219623A4640>, 'DELETE FROM market_data', ()) completed
2025-06-21 09:22:54,192 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219623A4640>)
2025-06-21 09:22:54,193 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219623A4640>) completed
2025-06-21 09:22:54,194 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,194 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,195 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B08C0>, 'DELETE FROM api_credentials', ())
2025-06-21 09:22:54,195 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B08C0>, 'DELETE FROM api_credentials', ()) completed
2025-06-21 09:22:54,196 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B08C0>)
2025-06-21 09:22:54,198 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B08C0>) completed
2025-06-21 09:22:54,199 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,201 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,201 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,202 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,202 - aiosqlite - DEBUG - [Thread-2] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x00000219624334C0>)
2025-06-21 09:22:54,202 - aiosqlite - DEBUG - [Thread-2] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x00000219624334C0>) completed
2025-06-21 09:22:54,205 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing <function connect.<locals>.connector at 0x000002196242F880>
2025-06-21 09:22:54,207 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation <function connect.<locals>.connector at 0x000002196242F880> completed
2025-06-21 09:22:54,207 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021962433880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021962411EE0>, deterministic=True)
2025-06-21 09:22:54,207 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021962433880>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x0000021962411EE0>, deterministic=True) completed
2025-06-21 09:22:54,208 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021962433880>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:54,208 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x0000021962433880>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:54,209 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021962433880>)
2025-06-21 09:22:54,209 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021962433880>) completed
2025-06-21 09:22:54,210 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B10C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00'))
2025-06-21 09:22:54,211 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B10C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-1', UUID('00000000-0000-0000-0000-000000000001'), 'BTCUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 150.0, "side": "buy"}', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00')) completed
2025-06-21 09:22:54,212 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B10C0>)
2025-06-21 09:22:54,212 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B10C0>) completed
2025-06-21 09:22:54,213 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021962433880>)
2025-06-21 09:22:54,213 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021962433880>) completed
2025-06-21 09:22:54,213 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B21C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00'))
2025-06-21 09:22:54,214 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B21C0>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-2', UUID('00000000-0000-0000-0000-000000000001'), 'ETHUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": -75.0, "side": "sell"}', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00')) completed
2025-06-21 09:22:54,214 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B21C0>)
2025-06-21 09:22:54,214 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B21C0>) completed
2025-06-21 09:22:54,215 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021962433880>)
2025-06-21 09:22:54,215 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x0000021962433880>) completed
2025-06-21 09:22:54,215 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B2140>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00'))
2025-06-21 09:22:54,215 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x00000219624B2140>, '\n            INSERT INTO trades (id, user_id, symbol, mode, status, position_status, data, created_at, updated_at, closed_at)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n            ', ('test-trade-3', UUID('00000000-0000-0000-0000-000000000001'), 'ADAUSDT', 'paper', 'closed', 'closed', '{"pnl_usd": 25.0, "side": "buy"}', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00', '2025-06-21T13:22:54.204079+00:00')) completed
2025-06-21 09:22:54,217 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B2140>)
2025-06-21 09:22:54,217 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x00000219624B2140>) completed
2025-06-21 09:22:54,218 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021962433880>)
2025-06-21 09:22:54,220 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x0000021962433880>) completed
2025-06-21 09:22:54,221 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021962433880>)
2025-06-21 09:22:54,221 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x0000021962433880>) completed
2025-06-21 09:22:54,222 - aiosqlite - DEBUG - [Thread-3] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021962433880>)
2025-06-21 09:22:54,222 - aiosqlite - DEBUG - [Thread-3] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Connection object at 0x0000021962433880>) completed
2025-06-21 09:22:54,238 - ultibot_backend - INFO - [MainThread] - main.py:110 - Middleware: Solicitud entrante: GET /api/v1/trades/history/paper
2025-06-21 09:22:54,239 - ultibot_backend.dependencies - WARNING - [MainThread] - dependencies.py:216 - DependencyContainer no encontrado en app.state. Inicializando contenedor global para tests.
2025-06-21 09:22:54,240 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:120 - Initializing dependency container...
2025-06-21 09:22:54,240 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:57 - Corrected SQLite URL to use aiosqlite: sqlite+aiosqlite:///C:/Users/zamor/AppData/Local/Temp/tmpa6l7fdtr/test_db.sqlite
2025-06-21 09:22:54,241 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing <function connect.<locals>.connector at 0x000002196269B4C0>
2025-06-21 09:22:54,242 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation <function connect.<locals>.connector at 0x000002196269B4C0> completed
2025-06-21 09:22:54,243 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624C6D40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000002196269ACA0>, deterministic=True)
2025-06-21 09:22:54,244 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624C6D40>, 'regexp', 2, <function SQLiteDialect_pysqlite.on_connect.<locals>.regexp at 0x000002196269ACA0>, deterministic=True) completed
2025-06-21 09:22:54,244 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624C6D40>, 'floor', 1, <built-in function floor>, deterministic=True)
2025-06-21 09:22:54,245 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method create_function of sqlite3.Connection object at 0x00000219624C6D40>, 'floor', 1, <built-in function floor>, deterministic=True) completed
2025-06-21 09:22:54,245 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,245 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,246 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B540>, 'PRAGMA read_uncommitted', [])
2025-06-21 09:22:54,246 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B540>, 'PRAGMA read_uncommitted', []) completed
2025-06-21 09:22:54,247 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B540>)
2025-06-21 09:22:54,247 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B540>) completed
2025-06-21 09:22:54,247 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B540>)
2025-06-21 09:22:54,248 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B540>) completed
2025-06-21 09:22:54,249 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,250 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,251 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,252 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,253 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B640>, 'PRAGMA main.table_info("api_credentials")', ())
2025-06-21 09:22:54,254 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B640>, 'PRAGMA main.table_info("api_credentials")', ()) completed
2025-06-21 09:22:54,255 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B640>)
2025-06-21 09:22:54,257 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B640>) completed
2025-06-21 09:22:54,258 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B640>)
2025-06-21 09:22:54,258 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B640>) completed
2025-06-21 09:22:54,259 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,260 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,261 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B3C0>, 'PRAGMA main.table_info("user_configurations")', ())
2025-06-21 09:22:54,261 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B3C0>, 'PRAGMA main.table_info("user_configurations")', ()) completed
2025-06-21 09:22:54,262 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B3C0>)
2025-06-21 09:22:54,263 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B3C0>) completed
2025-06-21 09:22:54,263 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B3C0>)
2025-06-21 09:22:54,263 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B3C0>) completed
2025-06-21 09:22:54,264 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,264 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,265 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B6C0>, 'PRAGMA main.table_info("trades")', ())
2025-06-21 09:22:54,265 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B6C0>, 'PRAGMA main.table_info("trades")', ()) completed
2025-06-21 09:22:54,267 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B6C0>)
2025-06-21 09:22:54,268 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B6C0>) completed
2025-06-21 09:22:54,268 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B6C0>)
2025-06-21 09:22:54,269 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B6C0>) completed
2025-06-21 09:22:54,270 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,271 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,271 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B7C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ())
2025-06-21 09:22:54,272 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B7C0>, 'PRAGMA main.table_info("portfolio_snapshots")', ()) completed
2025-06-21 09:22:54,273 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B7C0>)
2025-06-21 09:22:54,274 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B7C0>) completed
2025-06-21 09:22:54,275 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B7C0>)
2025-06-21 09:22:54,275 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B7C0>) completed
2025-06-21 09:22:54,278 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,278 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,279 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B940>, 'PRAGMA main.table_info("opportunities")', ())
2025-06-21 09:22:54,280 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268B940>, 'PRAGMA main.table_info("opportunities")', ()) completed
2025-06-21 09:22:54,281 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B940>)
2025-06-21 09:22:54,282 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268B940>) completed
2025-06-21 09:22:54,282 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B940>)
2025-06-21 09:22:54,283 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268B940>) completed
2025-06-21 09:22:54,284 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,284 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,285 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268BA40>, 'PRAGMA main.table_info("strategy_configurations")', ())
2025-06-21 09:22:54,286 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268BA40>, 'PRAGMA main.table_info("strategy_configurations")', ()) completed
2025-06-21 09:22:54,287 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268BA40>)
2025-06-21 09:22:54,288 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268BA40>) completed
2025-06-21 09:22:54,288 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268BA40>)
2025-06-21 09:22:54,289 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268BA40>) completed
2025-06-21 09:22:54,290 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,290 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,291 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268BB40>, 'PRAGMA main.table_info("market_data")', ())
2025-06-21 09:22:54,292 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x000002196268BB40>, 'PRAGMA main.table_info("market_data")', ()) completed
2025-06-21 09:22:54,292 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268BB40>)
2025-06-21 09:22:54,293 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x000002196268BB40>) completed
2025-06-21 09:22:54,293 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268BB40>)
2025-06-21 09:22:54,293 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x000002196268BB40>) completed
2025-06-21 09:22:54,294 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,294 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method commit of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,295 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,295 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,297 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:77 - Database tables created and session factory initialized successfully
2025-06-21 09:22:54,298 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:22:54,299 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:22:54,530 - httpx - DEBUG - [MainThread] - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-21 09:22:54,531 - httpx - DEBUG - [MainThread] - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\UltiBotInversiones\\.venv\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-21 09:22:54,740 - ultibot_backend.services.order_execution_service - INFO - [MainThread] - order_execution_service.py:205 - Paper Trading Service inicializado con capital virtual: 10000.0 USDT
2025-06-21 09:22:54,741 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:29 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-21 09:22:54,741 - ultibot_backend.services.credential_service - INFO - [MainThread] - credential_service.py:35 - Pasando la siguiente clave (str) a Fernet: 9anwY... (truncada por seguridad)
2025-06-21 09:22:54,741 - ultibot_backend.services.unified_order_execution_service - INFO - [MainThread] - unified_order_execution_service.py:28 - UnifiedOrderExecutionService initialized with both real and paper execution services
2025-06-21 09:22:54,758 - ultibot_backend.services.ai_orchestrator_service - INFO - [MainThread] - ai_orchestrator_service.py:143 - AIOrchestrator initialized with gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-21 09:22:54,758 - ultibot_backend.services.performance_service - INFO - [MainThread] - performance_service.py:29 - PerformanceService initialized. PersistenceService instance: <ultibot_backend.adapters.persistence_service.SupabasePersistenceService object at 0x0000021962425710>
2025-06-21 09:22:54,759 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:197 - Dependency container initialized successfully.
2025-06-21 09:22:54,759 - ultibot_backend.dependencies - INFO - [MainThread] - dependencies.py:219 - Contenedor global de contingencia inicializado y servicios cargados.
2025-06-21 09:22:54,759 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:440 - get_closed_trades - user_id: 00000000-0000-0000-0000-000000000001, mode: paper, symbol: None, start_date: None, end_date: None
2025-06-21 09:22:54,767 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,767 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method cursor of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,768 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021963877AC0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper'))
2025-06-21 09:22:54,768 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method execute of sqlite3.Cursor object at 0x0000021963877AC0>, 'SELECT trades.id, trades.user_id, trades.data, trades.status, trades.position_status, trades.mode, trades.symbol, trades.created_at, trades.updated_at, trades.closed_at \nFROM trades \nWHERE trades.user_id = ? AND trades.position_status = ? AND trades.mode = ?', ('00000000-0000-0000-0000-000000000001', 'closed', 'paper')) completed
2025-06-21 09:22:54,769 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021963877AC0>)
2025-06-21 09:22:54,769 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method fetchall of sqlite3.Cursor object at 0x0000021963877AC0>) completed
2025-06-21 09:22:54,770 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021963877AC0>)
2025-06-21 09:22:54,771 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method close of sqlite3.Cursor object at 0x0000021963877AC0>) completed
2025-06-21 09:22:54,773 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-1', 'u...': 150.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:22:54,773 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-2', 'u...: -75.0, 'side': 'sell'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:22:54,773 - ultibot_backend.adapters.persistence_service - ERROR - [MainThread] - persistence_service.py:479 - Error al validar Trade Pydantic desde ORM: 1 validation error for Trade
entryOrder
  Field required [type=missing, input_value={'id': 'test-trade-3', 'u...d': 25.0, 'side': 'buy'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/missing
2025-06-21 09:22:54,774 - ultibot_backend.adapters.persistence_service - DEBUG - [MainThread] - persistence_service.py:480 - get_closed_trades - Trades recuperados: 0
2025-06-21 09:22:54,774 - ultibot_backend.services.trading_report_service - INFO - [MainThread] - trading_report_service.py:75 - Obtenidos 0 trades cerrados para usuario 00000000-0000-0000-0000-000000000001 en modo paper
2025-06-21 09:22:54,774 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,775 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,775 - aiosqlite - DEBUG - [Thread-4] - core.py:104 - executing functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>)
2025-06-21 09:22:54,775 - aiosqlite - DEBUG - [Thread-4] - core.py:106 - operation functools.partial(<built-in method rollback of sqlite3.Connection object at 0x00000219624C6D40>) completed
2025-06-21 09:22:54,777 - ultibot_backend - INFO - [MainThread] - main.py:112 - Middleware: Solicitud procesada: GET /api/v1/trades/history/paper - Status: 200
2025-06-21 09:22:54,777 - httpx - INFO - [MainThread] - _client.py:1786 - HTTP Request: GET http://test/api/v1/trades/history/paper?user_id=00000000-0000-0000-0000-000000000001 "HTTP/1.1 200 OK"
2025-06-21 09:22:55,015 - tests.conftest - INFO - [MainThread] - conftest.py:140 - Motor de base de datos dispuesto.
2025-06-21 09:22:55,016 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 1/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpa6l7fdtr. Reintentando en 0.2s...
2025-06-21 09:22:55,217 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 2/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpa6l7fdtr. Reintentando en 0.2s...
2025-06-21 09:22:55,419 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 3/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpa6l7fdtr. Reintentando en 0.2s...
2025-06-21 09:22:55,621 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 4/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpa6l7fdtr. Reintentando en 0.2s...
2025-06-21 09:22:55,822 - tests.conftest - WARNING - [MainThread] - conftest.py:149 - Intento 5/5: No se pudo eliminar C:\Users\zamor\AppData\Local\Temp\tmpa6l7fdtr. Reintentando en 0.2s...
2025-06-21 09:22:56,023 - tests.conftest - ERROR - [MainThread] - conftest.py:152 - No se pudo eliminar el directorio temporal C:\Users\zamor\AppData\Local\Temp\tmpa6l7fdtr después de 5 intentos.
