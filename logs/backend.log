INFO:     Will watch for changes in these directories: ['C:\\Users\\zamor\\UltiBotInversiones']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [29448] using WatchFiles
2025-06-10 17:58:11,516 - src.ultibot_backend.services.simulated_portfolio_service - INFO - SimulatedPortfolioService initialized with initial balance: 100000.0
2025-06-10 17:58:11,566 - ultibot_backend - INFO - [5bb38ce27162] - MainThread - main.py:78 - Logging configurado exitosamente usando dictConfig.
2025-06-10 17:58:11,566 - ultibot_backend - INFO - [4dd0229da586] - MainThread - main.py:150 - Registrando routers de la API...
2025-06-10 17:58:11,584 - ultibot_backend - INFO - [6d4af2a157e4] - MainThread - main.py:163 - Todos los routers han sido registrados.
2025-06-10 17:58:11,593 - ultibot_backend - INFO - [68345392e377] - MainThread - main.py:87 - Iniciando UltiBot Backend...
2025-06-10 17:58:11,593 - ultibot_backend - INFO - [d34b5d05b2b2] - MainThread - main.py:91 - LIFESPAN: Inicializando contenedor de dependencias...
2025-06-10 17:58:11,593 - src.ultibot_backend.dependencies - INFO - [01addd3b1108] - MainThread - dependencies.py:58 - Initializing dependency container...
2025-06-10 17:58:11,593 - httpx - DEBUG - [b7814be25ac1] - MainThread - _config.py:82 - load_ssl_context verify=True cert=None trust_env=True http2=False
2025-06-10 17:58:11,593 - httpx - DEBUG - [cca64a41f57a] - MainThread - _config.py:148 - load_verify_locations cafile='C:\\Users\\zamor\\AppData\\Local\\pypoetry\\Cache\\virtualenvs\\ultibotinversiones-UOQi1NQu-py3.11\\Lib\\site-packages\\certifi\\cacert.pem'
2025-06-10 17:58:11,774 - src.ultibot_backend.adapters.persistence_service - INFO - [2811b220ee5a] - MainThread - persistence_service.py:68 - Pool de conexiones a Supabase (psycopg_pool) establecido exitosamente. Min: 2, Max: 10
2025-06-10 17:58:11,788 - src.ultibot_backend.services.ai_orchestrator_service - INFO - [128fa978181b] - MainThread - ai_orchestrator_service.py:84 - AIOrchestrator initialized with models/gemini-1.5-pro-latest and PydanticOutputParser.
2025-06-10 17:58:11,788 - src.ultibot_backend.services.simulated_order_execution_service - INFO - [f0b279773ec4] - MainThread - simulated_order_execution_service.py:23 - SimulatedOrderExecutionService initialized.
2025-06-10 17:58:11,788 - src.ultibot_backend.services.credential_service - INFO - [8285986cff42] - MainThread - credential_service.py:28 - CredentialService __init__ intentando obtener encryption_key de ENV: Presente
2025-06-10 17:58:11,788 - src.ultibot_backend.services.credential_service - INFO - [0512fd639967] - MainThread - credential_service.py:34 - Pasando la siguiente clave (str) a Fernet: m-28N... (truncada por seguridad)
2025-06-10 17:58:11,788 - src.ultibot_backend.dependencies - INFO - [96422e4a927c] - MainThread - dependencies.py:154 - Dependency container initialized successfully.
2025-06-10 17:58:11,788 - ultibot_backend - INFO - [6236f1d113f0] - MainThread - main.py:93 - LIFESPAN: Contenedor de dependencias inicializado.
2025-06-10 17:58:11,788 - ultibot_backend - INFO - [7a294c848fb9] - MainThread - main.py:100 - LIFESPAN: Aplicación iniciada correctamente, cediendo el control (yield).
2025-06-10 17:58:21,925 - ultibot_backend - INFO - [3c794cd86949] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/config
C:\Users\zamor\AppData\Local\pypoetry\Cache\virtualenvs\ultibotinversiones-UOQi1NQu-py3.11\Lib\site-packages\psycopg_pool\pool_async.py:142: RuntimeWarning: opening the async pool AsyncConnectionPool in the constructor is deprecated and will not be supported anymore in a future release. Please use `await pool.open()`, or use the pool as context manager using: `async with AsyncConnectionPool(...) as pool: `...
  warnings.warn(
2025-06-10 17:58:22,430 - ultibot_backend - INFO - [a32559d56b58] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/config - Status: 200
2025-06-10 17:58:22,430 - uvicorn.access - INFO - [6ce81dc7a9d4] - MainThread - httptools_impl.py:481 - 127.0.0.1:51564 - "GET /api/v1/config HTTP/1.1" 200
2025-06-10 17:58:22,446 - ultibot_backend - INFO - [d9f27ba668de] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/trading-mode
2025-06-10 17:58:22,446 - ultibot_backend - INFO - [12621322f3c5] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/trading-mode - Status: 200
2025-06-10 17:58:22,446 - uvicorn.access - INFO - [d15ed09bc760] - MainThread - httptools_impl.py:481 - 127.0.0.1:51564 - "GET /api/v1/trading-mode HTTP/1.1" 200
2025-06-10 17:58:23,221 - ultibot_backend - INFO - [e1c5b98c8921] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/market/klines
2025-06-10 17:58:23,230 - src.ultibot_backend.adapters.binance_adapter - INFO - [66c474d557ce45cc94d6dd2885e6c967] - MainThread - binance_adapter.py:44 - Binance AsyncClient and SocketManager initialized.
2025-06-10 17:58:23,481 - ultibot_backend - INFO - [62bf470db237] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/performance/metrics
2025-06-10 17:58:23,481 - src.ultibot_backend.services.performance_service - INFO - [68462562e74b4060936e6047c096f909] - MainThread - performance_service.py:39 - Fetching trade performance metrics for user 00000000-0000-0000-0000-000000000001, mode: paper
2025-06-10 17:58:23,481 - ultibot_backend - INFO - [29339ba64894] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/trading-mode
2025-06-10 17:58:23,481 - ultibot_backend - INFO - [1d94303a6a6f] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/strategies/strategies
2025-06-10 17:58:23,481 - src.ultibot_backend.api.v1.endpoints.strategies - INFO - [29869417cddb4c2bbf3fd5f262bc9309] - MainThread - strategies.py:76 - Listing strategies for user 00000000-0000-0000-0000-000000000001
2025-06-10 17:58:23,481 - ultibot_backend - INFO - [d465d232f623] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/trades
2025-06-10 17:58:23,481 - ultibot_backend - INFO - [daffb7a9cb15] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/trades
2025-06-10 17:58:23,481 - ultibot_backend - INFO - [5503052a0ca5] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/trading-mode - Status: 200
2025-06-10 17:58:23,481 - uvicorn.access - INFO - [4405716cd530] - MainThread - httptools_impl.py:481 - 127.0.0.1:51573 - "GET /api/v1/trading-mode HTTP/1.1" 200
2025-06-10 17:58:23,763 - src.ultibot_backend.api.v1.endpoints.strategies - INFO - [29869417cddb4c2bbf3fd5f262bc9309] - MainThread - strategies.py:88 - Retrieved 2 strategies
2025-06-10 17:58:23,763 - ultibot_backend - INFO - [c5c601c8c3da] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/strategies/strategies - Status: 200
2025-06-10 17:58:23,763 - uvicorn.access - INFO - [6bb74d43a515] - MainThread - httptools_impl.py:481 - 127.0.0.1:51574 - "GET /api/v1/strategies/strategies HTTP/1.1" 200
2025-06-10 17:58:23,846 - ultibot_backend - INFO - [87c7b833eb65] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/trades - Status: 200
2025-06-10 17:58:23,846 - uvicorn.access - INFO - [ee932b218a2d] - MainThread - httptools_impl.py:481 - 127.0.0.1:51575 - "GET /api/v1/trades?trading_mode=both HTTP/1.1" 200
2025-06-10 17:58:23,846 - ultibot_backend - INFO - [2a0247d30943] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/portfolio/snapshot
2025-06-10 17:58:23,846 - ultibot_backend - INFO - [97e8bae84307] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/trades
2025-06-10 17:58:23,914 - ultibot_backend - INFO - [8a3d2bdb25f0] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/trades - Status: 200
2025-06-10 17:58:23,914 - uvicorn.access - INFO - [7c5534c63268] - MainThread - httptools_impl.py:481 - 127.0.0.1:51576 - "GET /api/v1/trades?trading_mode=paper&date_from=2025-05-11&date_to=2025-06-10&limit=500&offset=0 HTTP/1.1" 200
2025-06-10 17:58:23,980 - ultibot_backend - INFO - [5baedb113c65] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/performance/metrics - Status: 200
2025-06-10 17:58:23,980 - uvicorn.access - INFO - [906d18fd9d82] - MainThread - httptools_impl.py:481 - 127.0.0.1:51572 - "GET /api/v1/performance/metrics?trading_mode=paper&date_from=2025-05-11&date_to=2025-06-10 HTTP/1.1" 200
2025-06-10 17:58:24,131 - src.ultibot_backend.services.portfolio_service - INFO - [36dec4dd61454d71a1e2e448ad60e2e2] - MainThread - portfolio_service.py:97 - Portafolio de paper trading inicializado para 00000000-0000-0000-0000-000000000001 con capital: 10000.0
2025-06-10 17:58:24,131 - ultibot_backend - INFO - [ee954a939649] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/portfolio/snapshot - Status: 200
2025-06-10 17:58:24,131 - uvicorn.access - INFO - [da3a844be360] - MainThread - httptools_impl.py:481 - 127.0.0.1:51575 - "GET /api/v1/portfolio/snapshot?user_id=33e296fc-59a0-4a90-bad0-9dcb5ea2ad46&trading_mode=paper HTTP/1.1" 200
2025-06-10 17:58:24,165 - ultibot_backend - INFO - [510ddaa04707] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/trades - Status: 200
2025-06-10 17:58:24,165 - uvicorn.access - INFO - [c5dfb4dc409c] - MainThread - httptools_impl.py:481 - 127.0.0.1:51574 - "GET /api/v1/trades?trading_mode=paper&status=open HTTP/1.1" 200
2025-06-10 17:58:24,181 - src.ultibot_backend.adapters.persistence_service - INFO - [66c474d557ce45cc94d6dd2885e6c967] - MainThread - persistence_service.py:114 - Se guardaron 100 registros de datos de mercado.
2025-06-10 17:58:24,181 - src.ultibot_backend.services.market_data_service - INFO - [66c474d557ce45cc94d6dd2885e6c967] - MainThread - market_data_service.py:285 - 100 registros de velas para BTCUSDT-1h guardados en la base de datos.
2025-06-10 17:58:24,181 - src.ultibot_backend.services.market_data_service - INFO - [66c474d557ce45cc94d6dd2885e6c967] - MainThread - market_data_service.py:287 - Datos de velas para BTCUSDT-1h obtenidos y procesados.
2025-06-10 17:58:24,181 - ultibot_backend - INFO - [3edc7dd33cb6] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/market/klines - Status: 200
2025-06-10 17:58:24,181 - uvicorn.access - INFO - [320655283863] - MainThread - httptools_impl.py:481 - 127.0.0.1:51564 - "GET /api/v1/market/klines?symbol=BTCUSDT&interval=1h&limit=100 HTTP/1.1" 200
2025-06-10 17:58:27,714 - ultibot_backend - INFO - [6d26cedd20f3] - MainThread - main.py:127 - Middleware: Solicitud entrante: GET /api/v1/notifications/history
2025-06-10 17:58:28,245 - src.ultibot_backend.services.notification_service - INFO - [da80afb6fe844e698877f5e503b5607e] - MainThread - notification_service.py:58 - Historial de notificaciones recuperado.
2025-06-10 17:58:28,245 - ultibot_backend - INFO - [ff8315da0100] - MainThread - main.py:129 - Middleware: Solicitud procesada: GET /api/v1/notifications/history - Status: 200
2025-06-10 17:58:28,245 - uvicorn.access - INFO - [572133fde58a] - MainThread - httptools_impl.py:481 - 127.0.0.1:51564 - "GET /api/v1/notifications/history?limit=20 HTTP/1.1" 200
^C^C